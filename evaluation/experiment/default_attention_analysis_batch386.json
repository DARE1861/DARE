{
  "detector": {
    "detected_exceeded": false,
    "actual_err": 5.026906728744507e-05,
    "predicted_bound": 0.00011710945764207282,
    "elapsed_sec": 3.0951087474823
  },
  "analyzer_report": {
    "component_estimates": {
      "input_storage_error": 4.275888204574585e-05,
      "matmul1_accumulation_error": 4.275888204574585e-05,
      "scaling_error": 4.275888204574585e-05,
      "softmax_numerical_error": 4.275888204574585e-05,
      "matmul2_accumulation_error": 4.275888204574585e-05,
      "output_demote_error": 7.94827938079834e-05
    },
    "component_ratios": {
      "input_storage_error": 0.14579681426720525,
      "matmul1_accumulation_error": 0.14579681426720525,
      "scaling_error": 0.14579681426720525,
      "softmax_numerical_error": 0.14579681426720525,
      "matmul2_accumulation_error": 0.14579681426720525,
      "output_demote_error": 0.2710159286639738
    },
    "primary_source": "storage_error",
    "suggestion": "\u4e3b\u8981\u8bef\u5dee\u6765\u6e90\u4e3a\u8f93\u5165\u5b58\u50a8\u7cbe\u5ea6\u3002\u5efa\u8bae\uff1a\u63d0\u5347Q/K/V\u7684\u5b58\u50a8\u7cbe\u5ea6\uff1b\u8fdb\u884c\u8f93\u5165\u5f52\u4e00\u5316\uff1b\u68c0\u67e5embedding\u5c42\u7684\u8f93\u51fa\u8303\u56f4\u3002 \u68c0\u6d4b\u5230\u5927\u91cf\u5c16\u9510\u7684attention\u6a21\u5f0f\uff08\u4f4e\u71b5\uff09\uff0c\u8fd9\u4f1a\u653e\u5927softmax\u7684\u6570\u503c\u8bef\u5dee\u3002\u8003\u8651\u4f7f\u7528attention dropout\u6216\u6e29\u5ea6\u7f29\u653e\u3002",
    "attention_pattern_stats": {
      "global_avg_entropy": 3.878161907196045,
      "global_sparsity": 0.69488525390625,
      "max_attention_weight": 1.0,
      "min_attention_weight": 0.0
    },
    "attention_behavior_stats": {
      "high_entropy_tokens": 0,
      "low_entropy_tokens": 8,
      "total_analyzed": 8
    },
    "top_tokens_summary": [
      {
        "batch_idx": 0,
        "head_idx": 7,
        "token_idx": 0,
        "token_error": 9.955365385394543e-06,
        "entropy_ref": -0.0,
        "max_attention_weight_ref": 1.0,
        "attention_weight_error": 0.0,
        "stage_errors": {
          "storage_error": 2.1236736756691243e-05,
          "matmul1_error": 1.1573361517496207e-09,
          "softmax_error": 7.193302735686302e-07,
          "matmul2_error": 6.932998530828627e-07,
          "demote_error": 7.193302735686302e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 6,
        "token_idx": 0,
        "token_error": 9.708455763757229e-06,
        "entropy_ref": -0.0,
        "max_attention_weight_ref": 1.0,
        "attention_weight_error": 0.0,
        "stage_errors": {
          "storage_error": 2.2659761725662975e-05,
          "matmul1_error": 1.3705375075085768e-09,
          "softmax_error": 8.452079782728106e-07,
          "matmul2_error": 7.041425305942539e-07,
          "demote_error": 8.452079782728106e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 4,
        "token_idx": 1,
        "token_error": 9.411349310539663e-06,
        "entropy_ref": 0.6930837631225586,
        "max_attention_weight_ref": 0.5056325793266296,
        "attention_weight_error": 1.8477439880371094e-06,
        "stage_errors": {
          "storage_error": 2.2321507913147798e-05,
          "matmul1_error": 1.278680126732238e-09,
          "softmax_error": 8.021292160265148e-07,
          "matmul2_error": 7.255189757415792e-07,
          "demote_error": 8.021292160265148e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 4,
        "token_idx": 0,
        "token_error": 9.048264473676682e-06,
        "entropy_ref": -0.0,
        "max_attention_weight_ref": 1.0,
        "attention_weight_error": 0.0,
        "stage_errors": {
          "storage_error": 1.8605610875965795e-05,
          "matmul1_error": 6.863262267004045e-10,
          "softmax_error": 4.3053951230831445e-07,
          "matmul2_error": 7.255189757415792e-07,
          "demote_error": 4.3053951230831444e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 5,
        "token_idx": 1,
        "token_error": 8.511789928888902e-06,
        "entropy_ref": 0.6931244134902954,
        "max_attention_weight_ref": 0.5033714771270752,
        "attention_weight_error": 1.4901161193847656e-06,
        "stage_errors": {
          "storage_error": 2.2794882170273922e-05,
          "matmul1_error": 1.405108250953735e-09,
          "softmax_error": 9.002396836876869e-07,
          "matmul2_error": 6.894589205330704e-07,
          "demote_error": 9.00239683687687e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 6,
        "token_idx": 1,
        "token_error": 8.118160621961579e-06,
        "entropy_ref": 0.6931217908859253,
        "max_attention_weight_ref": 0.503563404083252,
        "attention_weight_error": 1.1026859283447266e-06,
        "stage_errors": {
          "storage_error": 2.2283150883595226e-05,
          "matmul1_error": 1.3094685992567863e-09,
          "softmax_error": 8.075468940660358e-07,
          "matmul2_error": 7.041425305942539e-07,
          "demote_error": 8.075468940660358e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 5,
        "token_idx": 0,
        "token_error": 7.739967259112746e-06,
        "entropy_ref": -0.0,
        "max_attention_weight_ref": 1.0,
        "attention_weight_error": 0.0,
        "stage_errors": {
          "storage_error": 1.8664790331968106e-05,
          "matmul1_error": 7.604770239200411e-10,
          "softmax_error": 4.872304998571053e-07,
          "matmul2_error": 6.894589205330704e-07,
          "demote_error": 4.872304998571053e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 3,
        "token_idx": 0,
        "token_error": 7.586020728922449e-06,
        "entropy_ref": -0.0,
        "max_attention_weight_ref": 1.0,
        "attention_weight_error": 0.0,
        "stage_errors": {
          "storage_error": 2.0745416804857086e-05,
          "matmul1_error": 1.0578978506162899e-09,
          "softmax_error": 6.658810889348388e-07,
          "matmul2_error": 7.065394129313063e-07,
          "demote_error": 6.658810889348389e-08
        }
      }
    ],
    "head_analysis": [
      {
        "head_idx": 0,
        "avg_error": 1.9016620171896648e-06,
        "avg_entropy": 3.8781611919403076,
        "avg_max_weight": 0.04287612810730934,
        "sparsity": 0.69488525390625
      },
      {
        "head_idx": 1,
        "avg_error": 1.8951872107209056e-06,
        "avg_entropy": 3.8781614303588867,
        "avg_max_weight": 0.04288974031805992,
        "sparsity": 0.69476318359375
      },
      {
        "head_idx": 2,
        "avg_error": 1.7731604202708695e-06,
        "avg_entropy": 3.878162145614624,
        "avg_max_weight": 0.04285585135221481,
        "sparsity": 0.69488525390625
      },
      {
        "head_idx": 3,
        "avg_error": 1.8349547872276162e-06,
        "avg_entropy": 3.878162384033203,
        "avg_max_weight": 0.04284704849123955,
        "sparsity": 0.6947021484375
      },
      {
        "head_idx": 4,
        "avg_error": 1.8438022379996255e-06,
        "avg_entropy": 3.878162145614624,
        "avg_max_weight": 0.04286004602909088,
        "sparsity": 0.69488525390625
      },
      {
        "head_idx": 5,
        "avg_error": 1.9012279608432436e-06,
        "avg_entropy": 3.8781609535217285,
        "avg_max_weight": 0.0428859107196331,
        "sparsity": 0.69500732421875
      },
      {
        "head_idx": 6,
        "avg_error": 1.9899171093129553e-06,
        "avg_entropy": 3.878161668777466,
        "avg_max_weight": 0.042871344834566116,
        "sparsity": 0.695068359375
      },
      {
        "head_idx": 7,
        "avg_error": 1.8660541627468774e-06,
        "avg_entropy": 3.8781614303588867,
        "avg_max_weight": 0.042870767414569855,
        "sparsity": 0.69488525390625
      }
    ]
  }
}
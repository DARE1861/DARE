{
  "detector": {
    "detected_exceeded": false,
    "actual_err": 3.889203071594238e-05,
    "predicted_bound": 0.0001194795418996364,
    "elapsed_sec": 2.966308116912842
  },
  "analyzer_report": {
    "component_estimates": {
      "input_storage_error": 3.267824649810791e-05,
      "matmul1_accumulation_error": 3.267824649810791e-05,
      "scaling_error": 3.267824649810791e-05,
      "softmax_numerical_error": 3.267824649810791e-05,
      "matmul2_accumulation_error": 3.267824649810791e-05,
      "output_demote_error": 7.314980030059814e-05
    },
    "component_ratios": {
      "input_storage_error": 0.13815043467305027,
      "matmul1_accumulation_error": 0.13815043467305027,
      "scaling_error": 0.13815043467305027,
      "softmax_numerical_error": 0.13815043467305027,
      "matmul2_accumulation_error": 0.13815043467305027,
      "output_demote_error": 0.30924782663474865
    },
    "primary_source": "storage_error",
    "suggestion": "\u4e3b\u8981\u8bef\u5dee\u6765\u6e90\u4e3a\u8f93\u5165\u5b58\u50a8\u7cbe\u5ea6\u3002\u5efa\u8bae\uff1a\u63d0\u5347Q/K/V\u7684\u5b58\u50a8\u7cbe\u5ea6\uff1b\u8fdb\u884c\u8f93\u5165\u5f52\u4e00\u5316\uff1b\u68c0\u67e5embedding\u5c42\u7684\u8f93\u51fa\u8303\u56f4\u3002 \u68c0\u6d4b\u5230\u5927\u91cf\u5c16\u9510\u7684attention\u6a21\u5f0f\uff08\u4f4e\u71b5\uff09\uff0c\u8fd9\u4f1a\u653e\u5927softmax\u7684\u6570\u503c\u8bef\u5dee\u3002\u8003\u8651\u4f7f\u7528attention dropout\u6216\u6e29\u5ea6\u7f29\u653e\u3002",
    "attention_pattern_stats": {
      "global_avg_entropy": 3.878161668777466,
      "global_sparsity": 0.6949691772460938,
      "max_attention_weight": 1.0,
      "min_attention_weight": 0.0
    },
    "attention_behavior_stats": {
      "high_entropy_tokens": 0,
      "low_entropy_tokens": 6,
      "total_analyzed": 8
    },
    "top_tokens_summary": [
      {
        "batch_idx": 0,
        "head_idx": 7,
        "token_idx": 1,
        "token_error": 8.199585863621905e-06,
        "entropy_ref": 0.6931306719779968,
        "max_attention_weight_ref": 0.5028733611106873,
        "attention_weight_error": 2.086162567138672e-07,
        "stage_errors": {
          "storage_error": 1.9704502847162075e-05,
          "matmul1_error": 9.085616968547534e-10,
          "softmax_error": 5.667017831001431e-07,
          "matmul2_error": 6.952077001187718e-07,
          "demote_error": 5.667017831001431e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 6,
        "token_idx": 1,
        "token_error": 7.636866939719766e-06,
        "entropy_ref": 0.6931439638137817,
        "max_attention_weight_ref": 0.5012806057929993,
        "attention_weight_error": 2.682209014892578e-07,
        "stage_errors": {
          "storage_error": 1.848436795626185e-05,
          "matmul1_error": 7.131902068528516e-10,
          "softmax_error": 4.525529220700264e-07,
          "matmul2_error": 6.994161140028155e-07,
          "demote_error": 4.525529220700264e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 3,
        "token_idx": 0,
        "token_error": 7.227477908600122e-06,
        "entropy_ref": -0.0,
        "max_attention_weight_ref": 1.0,
        "attention_weight_error": 0.0,
        "stage_errors": {
          "storage_error": 2.058058908005478e-05,
          "matmul1_error": 1.0252622265679094e-09,
          "softmax_error": 6.258822395466268e-07,
          "matmul2_error": 7.082287083903794e-07,
          "demote_error": 6.258822395466268e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 1,
        "token_idx": 1,
        "token_error": 7.206894224509597e-06,
        "entropy_ref": 0.693134069442749,
        "max_attention_weight_ref": 0.5025627613067627,
        "attention_weight_error": 3.5762786865234375e-07,
        "stage_errors": {
          "storage_error": 1.870757614597096e-05,
          "matmul1_error": 6.996359516267193e-10,
          "softmax_error": 4.4468506530392917e-07,
          "matmul2_error": 7.307527539524017e-07,
          "demote_error": 4.4468506530392914e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 5,
        "token_idx": 0,
        "token_error": 7.193815690698102e-06,
        "entropy_ref": -0.0,
        "max_attention_weight_ref": 1.0,
        "attention_weight_error": 0.0,
        "stage_errors": {
          "storage_error": 2.1381883925641887e-05,
          "matmul1_error": 1.1978074488272372e-09,
          "softmax_error": 7.763192115817219e-07,
          "matmul2_error": 6.79983304507914e-07,
          "demote_error": 7.763192115817219e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 6,
        "token_idx": 2,
        "token_error": 7.133639883249998e-06,
        "entropy_ref": 1.0985666513442993,
        "max_attention_weight_ref": 0.33783888816833496,
        "attention_weight_error": 8.046627044677734e-07,
        "stage_errors": {
          "storage_error": 2.2519388494401937e-05,
          "matmul1_error": 1.3490798436026377e-09,
          "softmax_error": 8.560549758840353e-07,
          "matmul2_error": 6.994161140028155e-07,
          "demote_error": 8.560549758840353e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 5,
        "token_idx": 2,
        "token_error": 7.072826974763302e-06,
        "entropy_ref": 1.0985835790634155,
        "max_attention_weight_ref": 0.3368784189224243,
        "attention_weight_error": 4.76837158203125e-07,
        "stage_errors": {
          "storage_error": 2.2178079234436154e-05,
          "matmul1_error": 1.3206549395716657e-09,
          "softmax_error": 8.559387424611487e-07,
          "matmul2_error": 6.79983304507914e-07,
          "demote_error": 8.559387424611487e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 3,
        "token_idx": 1,
        "token_error": 6.987214874243364e-06,
        "entropy_ref": 0.6931159496307373,
        "max_attention_weight_ref": 0.5039527416229248,
        "attention_weight_error": 7.450580596923828e-07,
        "stage_errors": {
          "storage_error": 2.122544447047403e-05,
          "matmul1_error": 1.1308964548013992e-09,
          "softmax_error": 6.90367778588552e-07,
          "matmul2_error": 7.082287083903794e-07,
          "demote_error": 6.903677785885521e-08
        }
      }
    ],
    "head_analysis": [
      {
        "head_idx": 0,
        "avg_error": 1.759029373715748e-06,
        "avg_entropy": 3.878161907196045,
        "avg_max_weight": 0.04287983104586601,
        "sparsity": 0.6949462890625
      },
      {
        "head_idx": 1,
        "avg_error": 1.8402672594675096e-06,
        "avg_entropy": 3.878162145614624,
        "avg_max_weight": 0.04285409674048424,
        "sparsity": 0.6949462890625
      },
      {
        "head_idx": 2,
        "avg_error": 1.7329111869912595e-06,
        "avg_entropy": 3.8781609535217285,
        "avg_max_weight": 0.042883917689323425,
        "sparsity": 0.695068359375
      },
      {
        "head_idx": 3,
        "avg_error": 1.7562686025485164e-06,
        "avg_entropy": 3.8781611919403076,
        "avg_max_weight": 0.04288720339536667,
        "sparsity": 0.69525146484375
      },
      {
        "head_idx": 4,
        "avg_error": 1.6177183397303452e-06,
        "avg_entropy": 3.878161668777466,
        "avg_max_weight": 0.042847633361816406,
        "sparsity": 0.6949462890625
      },
      {
        "head_idx": 5,
        "avg_error": 1.80795427695557e-06,
        "avg_entropy": 3.878161668777466,
        "avg_max_weight": 0.04287036135792732,
        "sparsity": 0.69482421875
      },
      {
        "head_idx": 6,
        "avg_error": 1.7897298221214442e-06,
        "avg_entropy": 3.8781611919403076,
        "avg_max_weight": 0.04287991300225258,
        "sparsity": 0.69488525390625
      },
      {
        "head_idx": 7,
        "avg_error": 1.7820293578552082e-06,
        "avg_entropy": 3.878162145614624,
        "avg_max_weight": 0.042860787361860275,
        "sparsity": 0.69488525390625
      }
    ]
  }
}
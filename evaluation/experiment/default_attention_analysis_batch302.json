{
  "detector": {
    "detected_exceeded": false,
    "actual_err": 4.231184720993042e-05,
    "predicted_bound": 0.00011375546455383302,
    "elapsed_sec": 2.985260486602783
  },
  "analyzer_report": {
    "component_estimates": {
      "input_storage_error": 5.2459537982940674e-05,
      "matmul1_accumulation_error": 5.2459537982940674e-05,
      "scaling_error": 5.2459537982940674e-05,
      "softmax_numerical_error": 5.2459537982940674e-05,
      "matmul2_accumulation_error": 5.2459537982940674e-05,
      "output_demote_error": 7.700175046920776e-05
    },
    "component_ratios": {
      "input_storage_error": 0.15461133069828722,
      "matmul1_accumulation_error": 0.15461133069828722,
      "scaling_error": 0.15461133069828722,
      "softmax_numerical_error": 0.15461133069828722,
      "matmul2_accumulation_error": 0.15461133069828722,
      "output_demote_error": 0.2269433465085639
    },
    "primary_source": "storage_error",
    "suggestion": "\u4e3b\u8981\u8bef\u5dee\u6765\u6e90\u4e3a\u8f93\u5165\u5b58\u50a8\u7cbe\u5ea6\u3002\u5efa\u8bae\uff1a\u63d0\u5347Q/K/V\u7684\u5b58\u50a8\u7cbe\u5ea6\uff1b\u8fdb\u884c\u8f93\u5165\u5f52\u4e00\u5316\uff1b\u68c0\u67e5embedding\u5c42\u7684\u8f93\u51fa\u8303\u56f4\u3002 \u68c0\u6d4b\u5230\u5927\u91cf\u5c16\u9510\u7684attention\u6a21\u5f0f\uff08\u4f4e\u71b5\uff09\uff0c\u8fd9\u4f1a\u653e\u5927softmax\u7684\u6570\u503c\u8bef\u5dee\u3002\u8003\u8651\u4f7f\u7528attention dropout\u6216\u6e29\u5ea6\u7f29\u653e\u3002",
    "attention_pattern_stats": {
      "global_avg_entropy": 3.878161668777466,
      "global_sparsity": 0.6948089599609375,
      "max_attention_weight": 1.0,
      "min_attention_weight": 0.0
    },
    "attention_behavior_stats": {
      "high_entropy_tokens": 0,
      "low_entropy_tokens": 6,
      "total_analyzed": 8
    },
    "top_tokens_summary": [
      {
        "batch_idx": 0,
        "head_idx": 7,
        "token_idx": 0,
        "token_error": 8.305563824251294e-06,
        "entropy_ref": -0.0,
        "max_attention_weight_ref": 1.0,
        "attention_weight_error": 0.0,
        "stage_errors": {
          "storage_error": 1.9771192910411628e-05,
          "matmul1_error": 9.149985369932772e-10,
          "softmax_error": 5.904163117520512e-07,
          "matmul2_error": 7.018031283223537e-07,
          "demote_error": 5.904163117520511e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 6,
        "token_idx": 0,
        "token_error": 8.219731171266176e-06,
        "entropy_ref": -0.0,
        "max_attention_weight_ref": 1.0,
        "attention_weight_error": 0.0,
        "stage_errors": {
          "storage_error": 2.3101831175154075e-05,
          "matmul1_error": 1.4566033381412696e-09,
          "softmax_error": 9.072668035514653e-07,
          "matmul2_error": 6.933854365342996e-07,
          "demote_error": 9.072668035514653e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 4,
        "token_idx": 2,
        "token_error": 7.79660331318155e-06,
        "entropy_ref": 1.0985782146453857,
        "max_attention_weight_ref": 0.3372262716293335,
        "attention_weight_error": 6.854534149169922e-07,
        "stage_errors": {
          "storage_error": 2.2394141524273437e-05,
          "matmul1_error": 1.345675476132137e-09,
          "softmax_error": 8.176830306183547e-07,
          "matmul2_error": 6.944197593838909e-07,
          "demote_error": 8.176830306183547e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 5,
        "token_idx": 1,
        "token_error": 7.585673301946372e-06,
        "entropy_ref": 0.6931342482566833,
        "max_attention_weight_ref": 0.5025440454483032,
        "attention_weight_error": 3.8743019104003906e-07,
        "stage_errors": {
          "storage_error": 2.0093928014830453e-05,
          "matmul1_error": 9.517811693289159e-10,
          "softmax_error": 6.024245521984995e-07,
          "matmul2_error": 7.087367066560546e-07,
          "demote_error": 6.024245521984994e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 6,
        "token_idx": 1,
        "token_error": 7.4382987804710865e-06,
        "entropy_ref": 0.6931294798851013,
        "max_attention_weight_ref": 0.5029752850532532,
        "attention_weight_error": 2.9802322387695312e-08,
        "stage_errors": {
          "storage_error": 2.1227326215012e-05,
          "matmul1_error": 1.155654359117986e-09,
          "softmax_error": 7.198163075372577e-07,
          "matmul2_error": 6.933854365342996e-07,
          "demote_error": 7.198163075372577e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 2,
        "token_idx": 2,
        "token_error": 7.220789484563284e-06,
        "entropy_ref": 1.0985852479934692,
        "max_attention_weight_ref": 0.33680254220962524,
        "attention_weight_error": 3.5762786865234375e-07,
        "stage_errors": {
          "storage_error": 2.286034350618138e-05,
          "matmul1_error": 1.418918586006207e-09,
          "softmax_error": 8.814706234261394e-07,
          "matmul2_error": 6.931624284334248e-07,
          "demote_error": 8.814706234261394e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 0,
        "token_idx": 1,
        "token_error": 7.201833795988932e-06,
        "entropy_ref": 0.6931023001670837,
        "max_attention_weight_ref": 0.5047363638877869,
        "attention_weight_error": 1.1920928955078125e-07,
        "stage_errors": {
          "storage_error": 2.1242642560537206e-05,
          "matmul1_error": 1.16567223372696e-09,
          "softmax_error": 7.582952093798667e-07,
          "matmul2_error": 6.866040621389402e-07,
          "demote_error": 7.582952093798667e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 5,
        "token_idx": 0,
        "token_error": 7.0476762630278245e-06,
        "entropy_ref": -0.0,
        "max_attention_weight_ref": 1.0,
        "attention_weight_error": 0.0,
        "stage_errors": {
          "storage_error": 2.0489932921918808e-05,
          "matmul1_error": 1.014346682662169e-09,
          "softmax_error": 6.420250429073349e-07,
          "matmul2_error": 7.087367066560546e-07,
          "demote_error": 6.42025042907335e-08
        }
      }
    ],
    "head_analysis": [
      {
        "head_idx": 0,
        "avg_error": 1.8237808490084717e-06,
        "avg_entropy": 3.878161907196045,
        "avg_max_weight": 0.04285905510187149,
        "sparsity": 0.69482421875
      },
      {
        "head_idx": 1,
        "avg_error": 2.0198292531858897e-06,
        "avg_entropy": 3.878161668777466,
        "avg_max_weight": 0.0428624227643013,
        "sparsity": 0.6949462890625
      },
      {
        "head_idx": 2,
        "avg_error": 1.6530957509530708e-06,
        "avg_entropy": 3.878161668777466,
        "avg_max_weight": 0.042864806950092316,
        "sparsity": 0.6951904296875
      },
      {
        "head_idx": 3,
        "avg_error": 1.8137619690605788e-06,
        "avg_entropy": 3.8781614303588867,
        "avg_max_weight": 0.04286715015769005,
        "sparsity": 0.6947021484375
      },
      {
        "head_idx": 4,
        "avg_error": 1.7992028915614355e-06,
        "avg_entropy": 3.878161668777466,
        "avg_max_weight": 0.04286288470029831,
        "sparsity": 0.69476318359375
      },
      {
        "head_idx": 5,
        "avg_error": 1.748059048622963e-06,
        "avg_entropy": 3.878162384033203,
        "avg_max_weight": 0.04283133149147034,
        "sparsity": 0.69482421875
      },
      {
        "head_idx": 6,
        "avg_error": 1.6400930462623364e-06,
        "avg_entropy": 3.8781611919403076,
        "avg_max_weight": 0.042882855981588364,
        "sparsity": 0.69451904296875
      },
      {
        "head_idx": 7,
        "avg_error": 1.7769559690350434e-06,
        "avg_entropy": 3.878161907196045,
        "avg_max_weight": 0.042856764048337936,
        "sparsity": 0.6947021484375
      }
    ]
  }
}
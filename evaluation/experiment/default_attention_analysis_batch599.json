{
  "detector": {
    "detected_exceeded": false,
    "actual_err": 4.8860907554626465e-05,
    "predicted_bound": 0.00011612024245550857,
    "elapsed_sec": 2.9043829441070557
  },
  "analyzer_report": {
    "component_estimates": {
      "input_storage_error": 4.2788684368133545e-05,
      "matmul1_accumulation_error": 4.2788684368133545e-05,
      "scaling_error": 4.2788684368133545e-05,
      "softmax_numerical_error": 4.2788684368133545e-05,
      "matmul2_accumulation_error": 4.2788684368133545e-05,
      "output_demote_error": 7.335096597671509e-05
    },
    "component_ratios": {
      "input_storage_error": 0.14893672199170124,
      "matmul1_accumulation_error": 0.14893672199170124,
      "scaling_error": 0.14893672199170124,
      "softmax_numerical_error": 0.14893672199170124,
      "matmul2_accumulation_error": 0.14893672199170124,
      "output_demote_error": 0.25531639004149376
    },
    "primary_source": "storage_error",
    "suggestion": "\u4e3b\u8981\u8bef\u5dee\u6765\u6e90\u4e3a\u8f93\u5165\u5b58\u50a8\u7cbe\u5ea6\u3002\u5efa\u8bae\uff1a\u63d0\u5347Q/K/V\u7684\u5b58\u50a8\u7cbe\u5ea6\uff1b\u8fdb\u884c\u8f93\u5165\u5f52\u4e00\u5316\uff1b\u68c0\u67e5embedding\u5c42\u7684\u8f93\u51fa\u8303\u56f4\u3002",
    "attention_pattern_stats": {
      "global_avg_entropy": 3.878162145614624,
      "global_sparsity": 0.6949462890625,
      "max_attention_weight": 1.0,
      "min_attention_weight": 0.0
    },
    "attention_behavior_stats": {
      "high_entropy_tokens": 0,
      "low_entropy_tokens": 4,
      "total_analyzed": 8
    },
    "top_tokens_summary": [
      {
        "batch_idx": 0,
        "head_idx": 4,
        "token_idx": 0,
        "token_error": 9.571383998263627e-06,
        "entropy_ref": -0.0,
        "max_attention_weight_ref": 1.0,
        "attention_weight_error": 0.0,
        "stage_errors": {
          "storage_error": 1.999161622734391e-05,
          "matmul1_error": 9.258132428653956e-10,
          "softmax_error": 5.839436198584736e-07,
          "matmul2_error": 7.145416020648554e-07,
          "demote_error": 5.839436198584735e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 4,
        "token_idx": 2,
        "token_error": 8.679971870151348e-06,
        "entropy_ref": 1.098599910736084,
        "max_attention_weight_ref": 0.33567965030670166,
        "attention_weight_error": 9.834766387939453e-07,
        "stage_errors": {
          "storage_error": 2.274808002766804e-05,
          "matmul1_error": 1.3628367161996288e-09,
          "softmax_error": 8.595899998908863e-07,
          "matmul2_error": 7.145416020648554e-07,
          "demote_error": 8.595899998908862e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 7,
        "token_idx": 0,
        "token_error": 8.640581654617563e-06,
        "entropy_ref": -0.0,
        "max_attention_weight_ref": 1.0,
        "attention_weight_error": 0.0,
        "stage_errors": {
          "storage_error": 2.3920742023619823e-05,
          "matmul1_error": 1.6017256577355667e-09,
          "softmax_error": 9.84763028100133e-07,
          "matmul2_error": 6.884890808578348e-07,
          "demote_error": 9.847630281001329e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 1,
        "token_idx": 2,
        "token_error": 8.487120794598013e-06,
        "entropy_ref": 1.098596215248108,
        "max_attention_weight_ref": 0.3360038697719574,
        "attention_weight_error": 1.1026859283447266e-06,
        "stage_errors": {
          "storage_error": 2.0386604774103034e-05,
          "matmul1_error": 9.840848387965052e-10,
          "softmax_error": 6.036207196302712e-07,
          "matmul2_error": 7.145406925701537e-07,
          "demote_error": 6.036207196302712e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 4,
        "token_idx": 1,
        "token_error": 8.437281394435558e-06,
        "entropy_ref": 0.6931084394454956,
        "max_attention_weight_ref": 0.5043997764587402,
        "attention_weight_error": 7.450580596923828e-07,
        "stage_errors": {
          "storage_error": 2.3835446427256102e-05,
          "matmul1_error": 1.5352331905081385e-09,
          "softmax_error": 9.683266398496927e-07,
          "matmul2_error": 7.145416020648554e-07,
          "demote_error": 9.683266398496926e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 7,
        "token_idx": 1,
        "token_error": 7.776710845064372e-06,
        "entropy_ref": 0.6931328773498535,
        "max_attention_weight_ref": 0.5026755332946777,
        "attention_weight_error": 2.086162567138672e-07,
        "stage_errors": {
          "storage_error": 2.0873585526715033e-05,
          "matmul1_error": 1.1061029947235117e-09,
          "softmax_error": 6.800473784096539e-07,
          "matmul2_error": 6.884890808578348e-07,
          "demote_error": 6.800473784096539e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 2,
        "token_idx": 2,
        "token_error": 7.581115823995788e-06,
        "entropy_ref": 1.0985909700393677,
        "max_attention_weight_ref": 0.3363984525203705,
        "attention_weight_error": 2.384185791015625e-07,
        "stage_errors": {
          "storage_error": 2.0483852495090105e-05,
          "matmul1_error": 1.009241869548946e-09,
          "softmax_error": 6.371577910613269e-07,
          "matmul2_error": 7.112028924893822e-07,
          "demote_error": 6.371577910613269e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 0,
        "token_idx": 2,
        "token_error": 7.486367394449189e-06,
        "entropy_ref": 1.0985767841339111,
        "max_attention_weight_ref": 0.3372655212879181,
        "attention_weight_error": 7.152557373046875e-07,
        "stage_errors": {
          "storage_error": 2.280157468703692e-05,
          "matmul1_error": 1.3900541630028554e-09,
          "softmax_error": 8.805232937447728e-07,
          "matmul2_error": 7.019547865638743e-07,
          "demote_error": 8.805232937447727e-08
        }
      }
    ],
    "head_analysis": [
      {
        "head_idx": 0,
        "avg_error": 1.939106823556358e-06,
        "avg_entropy": 3.8781614303588867,
        "avg_max_weight": 0.04287903755903244,
        "sparsity": 0.69482421875
      },
      {
        "head_idx": 1,
        "avg_error": 1.9923445506719872e-06,
        "avg_entropy": 3.8781609535217285,
        "avg_max_weight": 0.042892418801784515,
        "sparsity": 0.695068359375
      },
      {
        "head_idx": 2,
        "avg_error": 1.8078592347592348e-06,
        "avg_entropy": 3.878162145614624,
        "avg_max_weight": 0.042846694588661194,
        "sparsity": 0.69482421875
      },
      {
        "head_idx": 3,
        "avg_error": 1.7922975530382246e-06,
        "avg_entropy": 3.878162145614624,
        "avg_max_weight": 0.04284250736236572,
        "sparsity": 0.69476318359375
      },
      {
        "head_idx": 4,
        "avg_error": 1.8798239125317195e-06,
        "avg_entropy": 3.878162145614624,
        "avg_max_weight": 0.04285410791635513,
        "sparsity": 0.6949462890625
      },
      {
        "head_idx": 5,
        "avg_error": 1.8674988950806437e-06,
        "avg_entropy": 3.878162145614624,
        "avg_max_weight": 0.04285351559519768,
        "sparsity": 0.6949462890625
      },
      {
        "head_idx": 6,
        "avg_error": 1.7570347381479223e-06,
        "avg_entropy": 3.8781614303588867,
        "avg_max_weight": 0.04287990927696228,
        "sparsity": 0.69500732421875
      },
      {
        "head_idx": 7,
        "avg_error": 1.554480149934534e-06,
        "avg_entropy": 3.8781611919403076,
        "avg_max_weight": 0.042876504361629486,
        "sparsity": 0.6951904296875
      }
    ]
  }
}
{
  "detector": {
    "detected_exceeded": false,
    "actual_err": 5.4016709327697754e-05,
    "predicted_bound": 0.00012711435556411743,
    "elapsed_sec": 3.0667288303375244
  },
  "analyzer_report": {
    "component_estimates": {
      "input_storage_error": 5.4016709327697754e-05,
      "matmul1_accumulation_error": 5.4016709327697754e-05,
      "scaling_error": 5.4016709327697754e-05,
      "softmax_numerical_error": 5.4016709327697754e-05,
      "matmul2_accumulation_error": 5.4016709327697754e-05,
      "output_demote_error": 8.849799633026123e-05
    },
    "component_ratios": {
      "input_storage_error": 0.15063996010638298,
      "matmul1_accumulation_error": 0.15063996010638298,
      "scaling_error": 0.15063996010638298,
      "softmax_numerical_error": 0.15063996010638298,
      "matmul2_accumulation_error": 0.15063996010638298,
      "output_demote_error": 0.2468001994680851
    },
    "primary_source": "storage_error",
    "suggestion": "\u4e3b\u8981\u8bef\u5dee\u6765\u6e90\u4e3a\u8f93\u5165\u5b58\u50a8\u7cbe\u5ea6\u3002\u5efa\u8bae\uff1a\u63d0\u5347Q/K/V\u7684\u5b58\u50a8\u7cbe\u5ea6\uff1b\u8fdb\u884c\u8f93\u5165\u5f52\u4e00\u5316\uff1b\u68c0\u67e5embedding\u5c42\u7684\u8f93\u51fa\u8303\u56f4\u3002 \u68c0\u6d4b\u5230\u5927\u91cf\u5c16\u9510\u7684attention\u6a21\u5f0f\uff08\u4f4e\u71b5\uff09\uff0c\u8fd9\u4f1a\u653e\u5927softmax\u7684\u6570\u503c\u8bef\u5dee\u3002\u8003\u8651\u4f7f\u7528attention dropout\u6216\u6e29\u5ea6\u7f29\u653e\u3002",
    "attention_pattern_stats": {
      "global_avg_entropy": 3.8781611919403076,
      "global_sparsity": 0.6949005126953125,
      "max_attention_weight": 1.0,
      "min_attention_weight": 0.0
    },
    "attention_behavior_stats": {
      "high_entropy_tokens": 0,
      "low_entropy_tokens": 8,
      "total_analyzed": 8
    },
    "top_tokens_summary": [
      {
        "batch_idx": 0,
        "head_idx": 5,
        "token_idx": 1,
        "token_error": 1.087548298528418e-05,
        "entropy_ref": 0.6930888891220093,
        "max_attention_weight_ref": 0.5053974986076355,
        "attention_weight_error": 2.9802322387695312e-08,
        "stage_errors": {
          "storage_error": 2.170668540202314e-05,
          "matmul1_error": 1.2145296168267514e-09,
          "softmax_error": 7.347756763920188e-07,
          "matmul2_error": 7.053959961922374e-07,
          "demote_error": 7.347756763920188e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 6,
        "token_idx": 0,
        "token_error": 9.829396731220186e-06,
        "entropy_ref": -0.0,
        "max_attention_weight_ref": 1.0,
        "attention_weight_error": 0.0,
        "stage_errors": {
          "storage_error": 1.867794026111369e-05,
          "matmul1_error": 7.700486972141106e-10,
          "softmax_error": 4.825051291845739e-07,
          "matmul2_error": 6.799768925702665e-07,
          "demote_error": 4.825051291845739e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 6,
        "token_idx": 1,
        "token_error": 8.235696441261098e-06,
        "entropy_ref": 0.6931079626083374,
        "max_attention_weight_ref": 0.5044289827346802,
        "attention_weight_error": 7.152557373046875e-07,
        "stage_errors": {
          "storage_error": 1.9602998236223357e-05,
          "matmul1_error": 9.176822964225925e-10,
          "softmax_error": 5.750109266955406e-07,
          "matmul2_error": 6.799768925702665e-07,
          "demote_error": 5.750109266955406e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 4,
        "token_idx": 1,
        "token_error": 8.204580808524042e-06,
        "entropy_ref": 0.6931367516517639,
        "max_attention_weight_ref": 0.502282977104187,
        "attention_weight_error": 5.960464477539063e-08,
        "stage_errors": {
          "storage_error": 1.9421058823354542e-05,
          "matmul1_error": 8.687651615316497e-10,
          "softmax_error": 5.364618118619546e-07,
          "matmul2_error": 6.899480467836838e-07,
          "demote_error": 5.364618118619546e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 7,
        "token_idx": 1,
        "token_error": 7.836444638087414e-06,
        "entropy_ref": 0.6931272149085999,
        "max_attention_weight_ref": 0.5031582713127136,
        "attention_weight_error": 5.066394805908203e-07,
        "stage_errors": {
          "storage_error": 2.1587680294032907e-05,
          "matmul1_error": 1.2019287607355493e-09,
          "softmax_error": 7.270602509379388e-07,
          "matmul2_error": 7.011184152361239e-07,
          "demote_error": 7.270602509379386e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 1,
        "token_idx": 1,
        "token_error": 7.639398972969502e-06,
        "entropy_ref": 0.6930679082870483,
        "max_attention_weight_ref": 0.5062955617904663,
        "attention_weight_error": 1.430511474609375e-06,
        "stage_errors": {
          "storage_error": 2.366086937399814e-05,
          "matmul1_error": 1.5341421346060707e-09,
          "softmax_error": 9.56945586949587e-07,
          "matmul2_error": 7.006356099736877e-07,
          "demote_error": 9.569455869495869e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 5,
        "token_idx": 0,
        "token_error": 7.540260412497446e-06,
        "entropy_ref": -0.0,
        "max_attention_weight_ref": 1.0,
        "attention_weight_error": 0.0,
        "stage_errors": {
          "storage_error": 1.9888292627001647e-05,
          "matmul1_error": 9.139627974225242e-10,
          "softmax_error": 5.529363988898695e-07,
          "matmul2_error": 7.053959961922374e-07,
          "demote_error": 5.5293639888986945e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 3,
        "token_idx": 0,
        "token_error": 7.037087925709784e-06,
        "entropy_ref": -0.0,
        "max_attention_weight_ref": 1.0,
        "attention_weight_error": 0.0,
        "stage_errors": {
          "storage_error": 2.071978406092967e-05,
          "matmul1_error": 1.0382607986472505e-09,
          "softmax_error": 6.506852514576167e-07,
          "matmul2_error": 7.161122994148173e-07,
          "demote_error": 6.506852514576167e-08
        }
      }
    ],
    "head_analysis": [
      {
        "head_idx": 0,
        "avg_error": 1.6757517187215853e-06,
        "avg_entropy": 3.8781611919403076,
        "avg_max_weight": 0.04288730025291443,
        "sparsity": 0.69512939453125
      },
      {
        "head_idx": 1,
        "avg_error": 1.8415397562421276e-06,
        "avg_entropy": 3.878161907196045,
        "avg_max_weight": 0.04284968972206116,
        "sparsity": 0.69476318359375
      },
      {
        "head_idx": 2,
        "avg_error": 1.8442931377649074e-06,
        "avg_entropy": 3.878162145614624,
        "avg_max_weight": 0.04286797717213631,
        "sparsity": 0.69500732421875
      },
      {
        "head_idx": 3,
        "avg_error": 1.7517070318717742e-06,
        "avg_entropy": 3.878161907196045,
        "avg_max_weight": 0.0428728386759758,
        "sparsity": 0.69464111328125
      },
      {
        "head_idx": 4,
        "avg_error": 1.8013035969488556e-06,
        "avg_entropy": 3.878161668777466,
        "avg_max_weight": 0.042875032871961594,
        "sparsity": 0.69500732421875
      },
      {
        "head_idx": 5,
        "avg_error": 2.003752342716325e-06,
        "avg_entropy": 3.8781611919403076,
        "avg_max_weight": 0.04289265722036362,
        "sparsity": 0.6947021484375
      },
      {
        "head_idx": 6,
        "avg_error": 1.8951393485622248e-06,
        "avg_entropy": 3.8781609535217285,
        "avg_max_weight": 0.042902469635009766,
        "sparsity": 0.69488525390625
      },
      {
        "head_idx": 7,
        "avg_error": 1.8174221168010263e-06,
        "avg_entropy": 3.878161668777466,
        "avg_max_weight": 0.0428670234978199,
        "sparsity": 0.695068359375
      }
    ]
  }
}
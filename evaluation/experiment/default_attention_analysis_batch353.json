{
  "detector": {
    "detected_exceeded": false,
    "actual_err": 3.8601458072662354e-05,
    "predicted_bound": 9.162306232610718e-05,
    "elapsed_sec": 2.979832410812378
  },
  "analyzer_report": {
    "component_estimates": {
      "input_storage_error": 3.107637166976929e-05,
      "matmul1_accumulation_error": 3.107637166976929e-05,
      "scaling_error": 3.107637166976929e-05,
      "softmax_numerical_error": 3.107637166976929e-05,
      "matmul2_accumulation_error": 3.107637166976929e-05,
      "output_demote_error": 6.521493196487427e-05
    },
    "component_ratios": {
      "input_storage_error": 0.14087408808430155,
      "matmul1_accumulation_error": 0.14087408808430155,
      "scaling_error": 0.14087408808430155,
      "softmax_numerical_error": 0.14087408808430155,
      "matmul2_accumulation_error": 0.14087408808430155,
      "output_demote_error": 0.2956295595784923
    },
    "primary_source": "storage_error",
    "suggestion": "\u4e3b\u8981\u8bef\u5dee\u6765\u6e90\u4e3a\u8f93\u5165\u5b58\u50a8\u7cbe\u5ea6\u3002\u5efa\u8bae\uff1a\u63d0\u5347Q/K/V\u7684\u5b58\u50a8\u7cbe\u5ea6\uff1b\u8fdb\u884c\u8f93\u5165\u5f52\u4e00\u5316\uff1b\u68c0\u67e5embedding\u5c42\u7684\u8f93\u51fa\u8303\u56f4\u3002 \u68c0\u6d4b\u5230\u5927\u91cf\u5c16\u9510\u7684attention\u6a21\u5f0f\uff08\u4f4e\u71b5\uff09\uff0c\u8fd9\u4f1a\u653e\u5927softmax\u7684\u6570\u503c\u8bef\u5dee\u3002\u8003\u8651\u4f7f\u7528attention dropout\u6216\u6e29\u5ea6\u7f29\u653e\u3002",
    "attention_pattern_stats": {
      "global_avg_entropy": 3.878161668777466,
      "global_sparsity": 0.6949844360351562,
      "max_attention_weight": 1.0,
      "min_attention_weight": 0.0
    },
    "attention_behavior_stats": {
      "high_entropy_tokens": 0,
      "low_entropy_tokens": 8,
      "total_analyzed": 8
    },
    "top_tokens_summary": [
      {
        "batch_idx": 0,
        "head_idx": 0,
        "token_idx": 0,
        "token_error": 9.170886187348515e-06,
        "entropy_ref": -0.0,
        "max_attention_weight_ref": 1.0,
        "attention_weight_error": 0.0,
        "stage_errors": {
          "storage_error": 2.0488686004682677e-05,
          "matmul1_error": 1.0217883281198648e-09,
          "softmax_error": 6.417139957193285e-07,
          "matmul2_error": 7.034596364974278e-07,
          "demote_error": 6.417139957193285e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 3,
        "token_idx": 1,
        "token_error": 7.59598333388567e-06,
        "entropy_ref": 0.693117618560791,
        "max_attention_weight_ref": 0.5038427114486694,
        "attention_weight_error": 4.172325134277344e-07,
        "stage_errors": {
          "storage_error": 2.1007439499953762e-05,
          "matmul1_error": 1.117425799850909e-09,
          "softmax_error": 6.965434295125306e-07,
          "matmul2_error": 6.952180228836369e-07,
          "demote_error": 6.965434295125305e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 3,
        "token_idx": 0,
        "token_error": 7.377348083537072e-06,
        "entropy_ref": -0.0,
        "max_attention_weight_ref": 1.0,
        "attention_weight_error": 0.0,
        "stage_errors": {
          "storage_error": 2.0337332898634486e-05,
          "matmul1_error": 1.009924332858592e-09,
          "softmax_error": 6.295327693806031e-07,
          "matmul2_error": 6.952180228836369e-07,
          "demote_error": 6.29532769380603e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 0,
        "token_idx": 1,
        "token_error": 7.082238880684599e-06,
        "entropy_ref": 0.6931419372558594,
        "max_attention_weight_ref": 0.5016234517097473,
        "attention_weight_error": 2.086162567138672e-07,
        "stage_errors": {
          "storage_error": 2.0408941509231227e-05,
          "matmul1_error": 1.009090772008008e-09,
          "softmax_error": 6.337395461741835e-07,
          "matmul2_error": 7.034596364974278e-07,
          "demote_error": 6.337395461741834e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 6,
        "token_idx": 1,
        "token_error": 6.8490444391500205e-06,
        "entropy_ref": 0.6931281089782715,
        "max_attention_weight_ref": 0.5030840039253235,
        "attention_weight_error": 1.0728836059570312e-06,
        "stage_errors": {
          "storage_error": 1.9442601569608087e-05,
          "matmul1_error": 8.83984214454354e-10,
          "softmax_error": 5.529378540813923e-07,
          "matmul2_error": 6.847880740679103e-07,
          "demote_error": 5.529378540813923e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 5,
        "token_idx": 1,
        "token_error": 6.836201464466285e-06,
        "entropy_ref": 0.69312584400177,
        "max_attention_weight_ref": 0.5032684206962585,
        "attention_weight_error": 3.2782554626464844e-07,
        "stage_errors": {
          "storage_error": 1.930381813508575e-05,
          "matmul1_error": 7.86823433424871e-10,
          "softmax_error": 4.945715772919357e-07,
          "matmul2_error": 7.3271662586194e-07,
          "demote_error": 4.945715772919357e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 1,
        "token_idx": 1,
        "token_error": 6.620139174629003e-06,
        "entropy_ref": 0.6931054592132568,
        "max_attention_weight_ref": 0.5045687556266785,
        "attention_weight_error": 2.086162567138672e-07,
        "stage_errors": {
          "storage_error": 2.0989937638660194e-05,
          "matmul1_error": 1.1094116755197899e-09,
          "softmax_error": 6.978254532441497e-07,
          "matmul2_error": 6.98563781043049e-07,
          "demote_error": 6.978254532441497e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 2,
        "token_idx": 1,
        "token_error": 6.4808073148014955e-06,
        "entropy_ref": 0.6931090354919434,
        "max_attention_weight_ref": 0.5043683052062988,
        "attention_weight_error": 1.9371509552001953e-06,
        "stage_errors": {
          "storage_error": 2.2979168534220662e-05,
          "matmul1_error": 1.4700288377340528e-09,
          "softmax_error": 8.985756721813232e-07,
          "matmul2_error": 6.76344643579796e-07,
          "demote_error": 8.985756721813232e-08
        }
      }
    ],
    "head_analysis": [
      {
        "head_idx": 0,
        "avg_error": 1.9307703951199073e-06,
        "avg_entropy": 3.878161907196045,
        "avg_max_weight": 0.0428435355424881,
        "sparsity": 0.69488525390625
      },
      {
        "head_idx": 1,
        "avg_error": 1.8740369114311761e-06,
        "avg_entropy": 3.878161907196045,
        "avg_max_weight": 0.04286785423755646,
        "sparsity": 0.69500732421875
      },
      {
        "head_idx": 2,
        "avg_error": 1.6879035911188112e-06,
        "avg_entropy": 3.878160238265991,
        "avg_max_weight": 0.0429127961397171,
        "sparsity": 0.695068359375
      },
      {
        "head_idx": 3,
        "avg_error": 1.951347258000169e-06,
        "avg_entropy": 3.8781614303588867,
        "avg_max_weight": 0.042867228388786316,
        "sparsity": 0.6951904296875
      },
      {
        "head_idx": 4,
        "avg_error": 1.684794256107125e-06,
        "avg_entropy": 3.878161668777466,
        "avg_max_weight": 0.042875513434410095,
        "sparsity": 0.6951904296875
      },
      {
        "head_idx": 5,
        "avg_error": 1.8082779433825635e-06,
        "avg_entropy": 3.8781614303588867,
        "avg_max_weight": 0.04287530481815338,
        "sparsity": 0.69500732421875
      },
      {
        "head_idx": 6,
        "avg_error": 1.6937179907472455e-06,
        "avg_entropy": 3.878161907196045,
        "avg_max_weight": 0.04285730421543121,
        "sparsity": 0.69488525390625
      },
      {
        "head_idx": 7,
        "avg_error": 1.5191716329354676e-06,
        "avg_entropy": 3.878161668777466,
        "avg_max_weight": 0.04287981986999512,
        "sparsity": 0.69464111328125
      }
    ]
  }
}
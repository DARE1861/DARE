{
  "detector": {
    "detected_exceeded": false,
    "actual_err": 4.8808753490448e-05,
    "predicted_bound": 0.00011234926423639991,
    "elapsed_sec": 2.9258766174316406
  },
  "analyzer_report": {
    "component_estimates": {
      "input_storage_error": 3.881007432937622e-05,
      "matmul1_accumulation_error": 3.881007432937622e-05,
      "scaling_error": 3.881007432937622e-05,
      "softmax_numerical_error": 3.881007432937622e-05,
      "matmul2_accumulation_error": 3.881007432937622e-05,
      "output_demote_error": 7.283687591552734e-05
    },
    "component_ratios": {
      "input_storage_error": 0.14541749253231345,
      "matmul1_accumulation_error": 0.14541749253231345,
      "scaling_error": 0.14541749253231345,
      "softmax_numerical_error": 0.14541749253231345,
      "matmul2_accumulation_error": 0.14541749253231345,
      "output_demote_error": 0.27291253733843274
    },
    "primary_source": "storage_error",
    "suggestion": "\u4e3b\u8981\u8bef\u5dee\u6765\u6e90\u4e3a\u8f93\u5165\u5b58\u50a8\u7cbe\u5ea6\u3002\u5efa\u8bae\uff1a\u63d0\u5347Q/K/V\u7684\u5b58\u50a8\u7cbe\u5ea6\uff1b\u8fdb\u884c\u8f93\u5165\u5f52\u4e00\u5316\uff1b\u68c0\u67e5embedding\u5c42\u7684\u8f93\u51fa\u8303\u56f4\u3002 \u68c0\u6d4b\u5230\u5927\u91cf\u5c16\u9510\u7684attention\u6a21\u5f0f\uff08\u4f4e\u71b5\uff09\uff0c\u8fd9\u4f1a\u653e\u5927softmax\u7684\u6570\u503c\u8bef\u5dee\u3002\u8003\u8651\u4f7f\u7528attention dropout\u6216\u6e29\u5ea6\u7f29\u653e\u3002",
    "attention_pattern_stats": {
      "global_avg_entropy": 3.878161668777466,
      "global_sparsity": 0.6949462890625,
      "max_attention_weight": 1.0,
      "min_attention_weight": 0.0
    },
    "attention_behavior_stats": {
      "high_entropy_tokens": 0,
      "low_entropy_tokens": 6,
      "total_analyzed": 8
    },
    "top_tokens_summary": [
      {
        "batch_idx": 0,
        "head_idx": 2,
        "token_idx": 0,
        "token_error": 9.305378625867888e-06,
        "entropy_ref": -0.0,
        "max_attention_weight_ref": 1.0,
        "attention_weight_error": 0.0,
        "stage_errors": {
          "storage_error": 2.0976013729523402e-05,
          "matmul1_error": 1.08252686158642e-09,
          "softmax_error": 6.70771987643093e-07,
          "matmul2_error": 7.136007297958713e-07,
          "demote_error": 6.707719876430929e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 7,
        "token_idx": 1,
        "token_error": 8.359704224858433e-06,
        "entropy_ref": 0.6931031942367554,
        "max_attention_weight_ref": 0.5046880841255188,
        "attention_weight_error": 2.682209014892578e-07,
        "stage_errors": {
          "storage_error": 2.1544022729358403e-05,
          "matmul1_error": 1.1977509752421919e-09,
          "softmax_error": 7.651680789422244e-07,
          "matmul2_error": 6.974435109441401e-07,
          "demote_error": 7.651680789422243e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 6,
        "token_idx": 2,
        "token_error": 8.203116522054188e-06,
        "entropy_ref": 1.0986043214797974,
        "max_attention_weight_ref": 0.3351985812187195,
        "attention_weight_error": 3.8743019104003906e-07,
        "stage_errors": {
          "storage_error": 2.1429376829473767e-05,
          "matmul1_error": 1.1955335061873428e-09,
          "softmax_error": 7.412469130940736e-07,
          "matmul2_error": 6.888970347063151e-07,
          "demote_error": 7.412469130940736e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 0,
        "token_idx": 1,
        "token_error": 7.936272595543414e-06,
        "entropy_ref": 0.6931321620941162,
        "max_attention_weight_ref": 0.5027352571487427,
        "attention_weight_error": 5.960464477539063e-08,
        "stage_errors": {
          "storage_error": 1.9449750197964022e-05,
          "matmul1_error": 8.69915745578826e-10,
          "softmax_error": 5.591486115008593e-07,
          "matmul2_error": 6.982595095905709e-07,
          "demote_error": 5.591486115008593e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 5,
        "token_idx": 0,
        "token_error": 7.681876013521105e-06,
        "entropy_ref": -0.0,
        "max_attention_weight_ref": 1.0,
        "attention_weight_error": 0.0,
        "stage_errors": {
          "storage_error": 2.166795457014814e-05,
          "matmul1_error": 1.2038491877668225e-09,
          "softmax_error": 7.359816663665697e-07,
          "matmul2_error": 7.079273018462118e-07,
          "demote_error": 7.359816663665698e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 0,
        "token_idx": 2,
        "token_error": 7.592798283440061e-06,
        "entropy_ref": 1.0985946655273438,
        "max_attention_weight_ref": 0.3359622657299042,
        "attention_weight_error": 1.1920928955078125e-07,
        "stage_errors": {
          "storage_error": 1.946886777659529e-05,
          "matmul1_error": 8.728900322580043e-10,
          "softmax_error": 5.61060369363986e-07,
          "matmul2_error": 6.982595095905709e-07,
          "demote_error": 5.6106036936398594e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 6,
        "token_idx": 0,
        "token_error": 7.358903530985117e-06,
        "entropy_ref": -0.0,
        "max_attention_weight_ref": 1.0,
        "attention_weight_error": 0.0,
        "stage_errors": {
          "storage_error": 1.9647669432742987e-05,
          "matmul1_error": 9.081676024128284e-10,
          "softmax_error": 5.630761734209955e-07,
          "matmul2_error": 6.888970347063151e-07,
          "demote_error": 5.630761734209955e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 6,
        "token_idx": 1,
        "token_error": 7.31085310690105e-06,
        "entropy_ref": 0.6931360960006714,
        "max_attention_weight_ref": 0.5023569464683533,
        "attention_weight_error": 3.5762786865234375e-07,
        "stage_errors": {
          "storage_error": 2.075055908790091e-05,
          "matmul1_error": 1.086049157543347e-09,
          "softmax_error": 6.733651389367879e-07,
          "matmul2_error": 6.888970347063151e-07,
          "demote_error": 6.733651389367878e-08
        }
      }
    ],
    "head_analysis": [
      {
        "head_idx": 0,
        "avg_error": 1.7894877828439348e-06,
        "avg_entropy": 3.878161907196045,
        "avg_max_weight": 0.042850881814956665,
        "sparsity": 0.6951904296875
      },
      {
        "head_idx": 1,
        "avg_error": 1.669744165155862e-06,
        "avg_entropy": 3.8781614303588867,
        "avg_max_weight": 0.042872387915849686,
        "sparsity": 0.695068359375
      },
      {
        "head_idx": 2,
        "avg_error": 1.8373332295595901e-06,
        "avg_entropy": 3.8781611919403076,
        "avg_max_weight": 0.0428985171020031,
        "sparsity": 0.69512939453125
      },
      {
        "head_idx": 3,
        "avg_error": 1.6474037920488627e-06,
        "avg_entropy": 3.878161907196045,
        "avg_max_weight": 0.04284970462322235,
        "sparsity": 0.69464111328125
      },
      {
        "head_idx": 4,
        "avg_error": 1.654021048125287e-06,
        "avg_entropy": 3.878161668777466,
        "avg_max_weight": 0.04286566749215126,
        "sparsity": 0.69482421875
      },
      {
        "head_idx": 5,
        "avg_error": 1.9125479866488604e-06,
        "avg_entropy": 3.878161668777466,
        "avg_max_weight": 0.042892441153526306,
        "sparsity": 0.695068359375
      },
      {
        "head_idx": 6,
        "avg_error": 1.9613237327575916e-06,
        "avg_entropy": 3.8781614303588867,
        "avg_max_weight": 0.042864374816417694,
        "sparsity": 0.69482421875
      },
      {
        "head_idx": 7,
        "avg_error": 1.7419706637156196e-06,
        "avg_entropy": 3.878161668777466,
        "avg_max_weight": 0.04287489131093025,
        "sparsity": 0.69482421875
      }
    ]
  }
}
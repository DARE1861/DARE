{
  "detector": {
    "detected_exceeded": false,
    "actual_err": 5.607306957244873e-05,
    "predicted_bound": 0.0001420727887307294,
    "elapsed_sec": 2.983687162399292
  },
  "analyzer_report": {
    "component_estimates": {
      "input_storage_error": 5.607306957244873e-05,
      "matmul1_accumulation_error": 5.607306957244873e-05,
      "scaling_error": 5.607306957244873e-05,
      "softmax_numerical_error": 5.607306957244873e-05,
      "matmul2_accumulation_error": 5.607306957244873e-05,
      "output_demote_error": 8.00788402557373e-05
    },
    "component_ratios": {
      "input_storage_error": 0.1555665798503452,
      "matmul1_accumulation_error": 0.1555665798503452,
      "scaling_error": 0.1555665798503452,
      "softmax_numerical_error": 0.1555665798503452,
      "matmul2_accumulation_error": 0.1555665798503452,
      "output_demote_error": 0.222167100748274
    },
    "primary_source": "storage_error",
    "suggestion": "\u4e3b\u8981\u8bef\u5dee\u6765\u6e90\u4e3a\u8f93\u5165\u5b58\u50a8\u7cbe\u5ea6\u3002\u5efa\u8bae\uff1a\u63d0\u5347Q/K/V\u7684\u5b58\u50a8\u7cbe\u5ea6\uff1b\u8fdb\u884c\u8f93\u5165\u5f52\u4e00\u5316\uff1b\u68c0\u67e5embedding\u5c42\u7684\u8f93\u51fa\u8303\u56f4\u3002 \u68c0\u6d4b\u5230\u5927\u91cf\u5c16\u9510\u7684attention\u6a21\u5f0f\uff08\u4f4e\u71b5\uff09\uff0c\u8fd9\u4f1a\u653e\u5927softmax\u7684\u6570\u503c\u8bef\u5dee\u3002\u8003\u8651\u4f7f\u7528attention dropout\u6216\u6e29\u5ea6\u7f29\u653e\u3002",
    "attention_pattern_stats": {
      "global_avg_entropy": 3.878161668777466,
      "global_sparsity": 0.69488525390625,
      "max_attention_weight": 1.0,
      "min_attention_weight": 0.0
    },
    "attention_behavior_stats": {
      "high_entropy_tokens": 0,
      "low_entropy_tokens": 6,
      "total_analyzed": 8
    },
    "top_tokens_summary": [
      {
        "batch_idx": 0,
        "head_idx": 4,
        "token_idx": 1,
        "token_error": 9.710127415019087e-06,
        "entropy_ref": 0.693126380443573,
        "max_attention_weight_ref": 0.5032235980033875,
        "attention_weight_error": 9.834766387939453e-07,
        "stage_errors": {
          "storage_error": 2.2581488337891642e-05,
          "matmul1_error": 1.3527315477462708e-09,
          "softmax_error": 8.371876901946963e-07,
          "matmul2_error": 7.068697414069902e-07,
          "demote_error": 8.371876901946961e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 7,
        "token_idx": 0,
        "token_error": 9.059916919795796e-06,
        "entropy_ref": -0.0,
        "max_attention_weight_ref": 1.0,
        "attention_weight_error": 0.0,
        "stage_errors": {
          "storage_error": 1.9712642824742943e-05,
          "matmul1_error": 9.051530860510224e-10,
          "softmax_error": 5.610323569271713e-07,
          "matmul2_error": 6.972161372686969e-07,
          "demote_error": 5.610323569271714e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 4,
        "token_idx": 2,
        "token_error": 8.682796760695055e-06,
        "entropy_ref": 1.0985661745071411,
        "max_attention_weight_ref": 0.3378611207008362,
        "attention_weight_error": 7.450580596923828e-07,
        "stage_errors": {
          "storage_error": 2.3311019504035357e-05,
          "matmul1_error": 1.4706095140691184e-09,
          "softmax_error": 9.101408068090677e-07,
          "matmul2_error": 7.068697414069902e-07,
          "demote_error": 9.101408068090678e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 2,
        "token_idx": 2,
        "token_error": 8.6395230027847e-06,
        "entropy_ref": 1.098585844039917,
        "max_attention_weight_ref": 0.3367135524749756,
        "attention_weight_error": 2.384185791015625e-07,
        "stage_errors": {
          "storage_error": 2.0023791421408532e-05,
          "matmul1_error": 9.744806472422608e-10,
          "softmax_error": 6.045931513654069e-07,
          "matmul2_error": 6.854661933175521e-07,
          "demote_error": 6.045931513654068e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 4,
        "token_idx": 0,
        "token_error": 8.276307198684663e-06,
        "entropy_ref": -0.0,
        "max_attention_weight_ref": 1.0,
        "attention_weight_error": 0.0,
        "stage_errors": {
          "storage_error": 2.00369840968051e-05,
          "matmul1_error": 9.41589434620901e-10,
          "softmax_error": 5.82737266086042e-07,
          "matmul2_error": 7.068697414069902e-07,
          "demote_error": 5.827372660860419e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 1,
        "token_idx": 1,
        "token_error": 8.263719792012125e-06,
        "entropy_ref": 0.6931068897247314,
        "max_attention_weight_ref": 0.5044904351234436,
        "attention_weight_error": 4.76837158203125e-07,
        "stage_errors": {
          "storage_error": 2.2078750134824077e-05,
          "matmul1_error": 1.3043530742228358e-09,
          "softmax_error": 8.343546141986736e-07,
          "matmul2_error": 6.826294338679872e-07,
          "demote_error": 8.343546141986735e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 5,
        "token_idx": 1,
        "token_error": 8.218290531658567e-06,
        "entropy_ref": 0.6931257247924805,
        "max_attention_weight_ref": 0.5032766461372375,
        "attention_weight_error": 4.76837158203125e-07,
        "stage_errors": {
          "storage_error": 2.280719854752533e-05,
          "matmul1_error": 1.405079471370514e-09,
          "softmax_error": 8.844275726005435e-07,
          "matmul2_error": 6.941847459529527e-07,
          "demote_error": 8.844275726005435e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 7,
        "token_idx": 1,
        "token_error": 8.015125786187127e-06,
        "entropy_ref": 0.6931109428405762,
        "max_attention_weight_ref": 0.5042583346366882,
        "attention_weight_error": 1.817941665649414e-06,
        "stage_errors": {
          "storage_error": 2.1213108993833885e-05,
          "matmul1_error": 1.14723387991228e-09,
          "softmax_error": 7.110789738362656e-07,
          "matmul2_error": 6.972161372686969e-07,
          "demote_error": 7.110789738362656e-08
        }
      }
    ],
    "head_analysis": [
      {
        "head_idx": 0,
        "avg_error": 1.7709400026433286e-06,
        "avg_entropy": 3.8781626224517822,
        "avg_max_weight": 0.04282638430595398,
        "sparsity": 0.69500732421875
      },
      {
        "head_idx": 1,
        "avg_error": 1.7284475006817956e-06,
        "avg_entropy": 3.878161907196045,
        "avg_max_weight": 0.04286148026585579,
        "sparsity": 0.6949462890625
      },
      {
        "head_idx": 2,
        "avg_error": 1.892737941489031e-06,
        "avg_entropy": 3.8781611919403076,
        "avg_max_weight": 0.04290199279785156,
        "sparsity": 0.69500732421875
      },
      {
        "head_idx": 3,
        "avg_error": 1.7153988665086217e-06,
        "avg_entropy": 3.878161907196045,
        "avg_max_weight": 0.04286682978272438,
        "sparsity": 0.69500732421875
      },
      {
        "head_idx": 4,
        "avg_error": 1.8897532072514878e-06,
        "avg_entropy": 3.8781614303588867,
        "avg_max_weight": 0.042893555015325546,
        "sparsity": 0.69488525390625
      },
      {
        "head_idx": 5,
        "avg_error": 1.9017063550563762e-06,
        "avg_entropy": 3.878161907196045,
        "avg_max_weight": 0.0428575798869133,
        "sparsity": 0.694580078125
      },
      {
        "head_idx": 6,
        "avg_error": 1.7957887621378177e-06,
        "avg_entropy": 3.878161668777466,
        "avg_max_weight": 0.042862825095653534,
        "sparsity": 0.69488525390625
      },
      {
        "head_idx": 7,
        "avg_error": 2.0630382095987443e-06,
        "avg_entropy": 3.878161907196045,
        "avg_max_weight": 0.04285857826471329,
        "sparsity": 0.69476318359375
      }
    ]
  }
}
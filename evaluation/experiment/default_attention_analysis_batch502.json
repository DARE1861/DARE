{
  "detector": {
    "detected_exceeded": false,
    "actual_err": 6.131082773208618e-05,
    "predicted_bound": 0.00011967623722739518,
    "elapsed_sec": 2.916290521621704
  },
  "analyzer_report": {
    "component_estimates": {
      "input_storage_error": 3.4943222999572754e-05,
      "matmul1_accumulation_error": 3.4943222999572754e-05,
      "scaling_error": 3.4943222999572754e-05,
      "softmax_numerical_error": 3.4943222999572754e-05,
      "matmul2_accumulation_error": 3.4943222999572754e-05,
      "output_demote_error": 7.887929677963257e-05
    },
    "component_ratios": {
      "input_storage_error": 0.13779122719393602,
      "matmul1_accumulation_error": 0.13779122719393602,
      "scaling_error": 0.13779122719393602,
      "softmax_numerical_error": 0.13779122719393602,
      "matmul2_accumulation_error": 0.13779122719393602,
      "output_demote_error": 0.31104386403031997
    },
    "primary_source": "storage_error",
    "suggestion": "\u4e3b\u8981\u8bef\u5dee\u6765\u6e90\u4e3a\u8f93\u5165\u5b58\u50a8\u7cbe\u5ea6\u3002\u5efa\u8bae\uff1a\u63d0\u5347Q/K/V\u7684\u5b58\u50a8\u7cbe\u5ea6\uff1b\u8fdb\u884c\u8f93\u5165\u5f52\u4e00\u5316\uff1b\u68c0\u67e5embedding\u5c42\u7684\u8f93\u51fa\u8303\u56f4\u3002 \u68c0\u6d4b\u5230\u5927\u91cf\u5c16\u9510\u7684attention\u6a21\u5f0f\uff08\u4f4e\u71b5\uff09\uff0c\u8fd9\u4f1a\u653e\u5927softmax\u7684\u6570\u503c\u8bef\u5dee\u3002\u8003\u8651\u4f7f\u7528attention dropout\u6216\u6e29\u5ea6\u7f29\u653e\u3002",
    "attention_pattern_stats": {
      "global_avg_entropy": 3.878161668777466,
      "global_sparsity": 0.69482421875,
      "max_attention_weight": 1.0,
      "min_attention_weight": 0.0
    },
    "attention_behavior_stats": {
      "high_entropy_tokens": 0,
      "low_entropy_tokens": 7,
      "total_analyzed": 8
    },
    "top_tokens_summary": [
      {
        "batch_idx": 0,
        "head_idx": 5,
        "token_idx": 1,
        "token_error": 1.032820000546053e-05,
        "entropy_ref": 0.6931390762329102,
        "max_attention_weight_ref": 0.5020164847373962,
        "attention_weight_error": 6.556510925292969e-07,
        "stage_errors": {
          "storage_error": 1.9373972918401705e-05,
          "matmul1_error": 8.429816053171343e-10,
          "softmax_error": 5.286856321617961e-07,
          "matmul2_error": 7.040419404802379e-07,
          "demote_error": 5.286856321617961e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 5,
        "token_idx": 0,
        "token_error": 9.234339813701808e-06,
        "entropy_ref": -0.0,
        "max_attention_weight_ref": 1.0,
        "attention_weight_error": 0.0,
        "stage_errors": {
          "storage_error": 1.9462703221506672e-05,
          "matmul1_error": 8.571295240048148e-10,
          "softmax_error": 5.375586624722928e-07,
          "matmul2_error": 7.040419404802379e-07,
          "demote_error": 5.375586624722928e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 4,
        "token_idx": 0,
        "token_error": 8.08065669843927e-06,
        "entropy_ref": -0.0,
        "max_attention_weight_ref": 1.0,
        "attention_weight_error": 0.0,
        "stage_errors": {
          "storage_error": 2.031162421189947e-05,
          "matmul1_error": 1.0014481156967273e-09,
          "softmax_error": 6.348192982841284e-07,
          "matmul2_error": 6.991656391619472e-07,
          "demote_error": 6.348192982841283e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 0,
        "token_idx": 1,
        "token_error": 7.690767233725637e-06,
        "entropy_ref": 0.6931341886520386,
        "max_attention_weight_ref": 0.5025506615638733,
        "attention_weight_error": 8.940696716308594e-08,
        "stage_errors": {
          "storage_error": 2.2064433323976118e-05,
          "matmul1_error": 1.2714058590788132e-09,
          "softmax_error": 7.936057954793796e-07,
          "matmul2_error": 7.048193765513134e-07,
          "demote_error": 7.936057954793796e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 2,
        "token_idx": 1,
        "token_error": 7.6234168773225974e-06,
        "entropy_ref": 0.6931241154670715,
        "max_attention_weight_ref": 0.5033963322639465,
        "attention_weight_error": 5.364418029785156e-07,
        "stage_errors": {
          "storage_error": 1.977095280381036e-05,
          "matmul1_error": 8.945915764779968e-10,
          "softmax_error": 5.619425792247057e-07,
          "matmul2_error": 7.115979769878322e-07,
          "demote_error": 5.619425792247057e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 1,
        "token_idx": 2,
        "token_error": 7.578370514238486e-06,
        "entropy_ref": 1.0985970497131348,
        "max_attention_weight_ref": 0.3359334170818329,
        "attention_weight_error": 5.662441253662109e-07,
        "stage_errors": {
          "storage_error": 2.140654942195397e-05,
          "matmul1_error": 1.1847102110414874e-09,
          "softmax_error": 7.284601451829076e-07,
          "matmul2_error": 6.934555585758063e-07,
          "demote_error": 7.284601451829077e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 3,
        "token_idx": 0,
        "token_error": 7.286798791028559e-06,
        "entropy_ref": -0.0,
        "max_attention_weight_ref": 1.0,
        "attention_weight_error": 0.0,
        "stage_errors": {
          "storage_error": 2.214796995758661e-05,
          "matmul1_error": 1.2893567792550692e-09,
          "softmax_error": 8.110786438919604e-07,
          "matmul2_error": 7.011717116256478e-07,
          "demote_error": 8.110786438919605e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 7,
        "token_idx": 1,
        "token_error": 6.938845217518974e-06,
        "entropy_ref": 0.6931363344192505,
        "max_attention_weight_ref": 0.502331554889679,
        "attention_weight_error": 2.9802322387695312e-08,
        "stage_errors": {
          "storage_error": 2.0012646473333007e-05,
          "matmul1_error": 9.7555628678485e-10,
          "softmax_error": 6.131020199973137e-07,
          "matmul2_error": 6.849533292552224e-07,
          "demote_error": 6.131020199973136e-08
        }
      }
    ],
    "head_analysis": [
      {
        "head_idx": 0,
        "avg_error": 1.822424906094966e-06,
        "avg_entropy": 3.878162145614624,
        "avg_max_weight": 0.04283597320318222,
        "sparsity": 0.69512939453125
      },
      {
        "head_idx": 1,
        "avg_error": 1.7985466911341064e-06,
        "avg_entropy": 3.8781614303588867,
        "avg_max_weight": 0.042878713458776474,
        "sparsity": 0.69476318359375
      },
      {
        "head_idx": 2,
        "avg_error": 1.723174364087754e-06,
        "avg_entropy": 3.8781614303588867,
        "avg_max_weight": 0.04287903755903244,
        "sparsity": 0.69464111328125
      },
      {
        "head_idx": 3,
        "avg_error": 1.8491393802833045e-06,
        "avg_entropy": 3.8781614303588867,
        "avg_max_weight": 0.04287970811128616,
        "sparsity": 0.6947021484375
      },
      {
        "head_idx": 4,
        "avg_error": 1.7256329556403216e-06,
        "avg_entropy": 3.878161907196045,
        "avg_max_weight": 0.04285705089569092,
        "sparsity": 0.6947021484375
      },
      {
        "head_idx": 5,
        "avg_error": 1.7712744693199056e-06,
        "avg_entropy": 3.878161668777466,
        "avg_max_weight": 0.04285956174135208,
        "sparsity": 0.69476318359375
      },
      {
        "head_idx": 6,
        "avg_error": 1.7158628224933636e-06,
        "avg_entropy": 3.8781611919403076,
        "avg_max_weight": 0.04289036616683006,
        "sparsity": 0.69500732421875
      },
      {
        "head_idx": 7,
        "avg_error": 1.8121405673809932e-06,
        "avg_entropy": 3.878162384033203,
        "avg_max_weight": 0.04284948110580444,
        "sparsity": 0.69488525390625
      }
    ]
  }
}
{
  "detector": {
    "detected_exceeded": false,
    "actual_err": 4.4479966163635254e-05,
    "predicted_bound": 0.00013081747165415438,
    "elapsed_sec": 2.9142343997955322
  },
  "analyzer_report": {
    "component_estimates": {
      "input_storage_error": 4.4479966163635254e-05,
      "matmul1_accumulation_error": 4.4479966163635254e-05,
      "scaling_error": 4.4479966163635254e-05,
      "softmax_numerical_error": 4.4479966163635254e-05,
      "matmul2_accumulation_error": 4.4479966163635254e-05,
      "output_demote_error": 8.051097393035889e-05
    },
    "component_ratios": {
      "input_storage_error": 0.1468417945690673,
      "matmul1_accumulation_error": 0.1468417945690673,
      "scaling_error": 0.1468417945690673,
      "softmax_numerical_error": 0.1468417945690673,
      "matmul2_accumulation_error": 0.1468417945690673,
      "output_demote_error": 0.2657910271546635
    },
    "primary_source": "storage_error",
    "suggestion": "\u4e3b\u8981\u8bef\u5dee\u6765\u6e90\u4e3a\u8f93\u5165\u5b58\u50a8\u7cbe\u5ea6\u3002\u5efa\u8bae\uff1a\u63d0\u5347Q/K/V\u7684\u5b58\u50a8\u7cbe\u5ea6\uff1b\u8fdb\u884c\u8f93\u5165\u5f52\u4e00\u5316\uff1b\u68c0\u67e5embedding\u5c42\u7684\u8f93\u51fa\u8303\u56f4\u3002 \u68c0\u6d4b\u5230\u5927\u91cf\u5c16\u9510\u7684attention\u6a21\u5f0f\uff08\u4f4e\u71b5\uff09\uff0c\u8fd9\u4f1a\u653e\u5927softmax\u7684\u6570\u503c\u8bef\u5dee\u3002\u8003\u8651\u4f7f\u7528attention dropout\u6216\u6e29\u5ea6\u7f29\u653e\u3002",
    "attention_pattern_stats": {
      "global_avg_entropy": 3.8781614303588867,
      "global_sparsity": 0.6949081420898438,
      "max_attention_weight": 1.0,
      "min_attention_weight": 0.0
    },
    "attention_behavior_stats": {
      "high_entropy_tokens": 0,
      "low_entropy_tokens": 7,
      "total_analyzed": 8
    },
    "top_tokens_summary": [
      {
        "batch_idx": 0,
        "head_idx": 7,
        "token_idx": 1,
        "token_error": 7.988288416527212e-06,
        "entropy_ref": 0.693116307258606,
        "max_attention_weight_ref": 0.5039306282997131,
        "attention_weight_error": 0.0,
        "stage_errors": {
          "storage_error": 1.9052081825066125e-05,
          "matmul1_error": 8.210462725082098e-10,
          "softmax_error": 5.080382834421471e-07,
          "matmul2_error": 6.829429821664235e-07,
          "demote_error": 5.080382834421471e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 5,
        "token_idx": 0,
        "token_error": 7.5457655839272775e-06,
        "entropy_ref": -0.0,
        "max_attention_weight_ref": 1.0,
        "attention_weight_error": 0.0,
        "stage_errors": {
          "storage_error": 2.12842946893943e-05,
          "matmul1_error": 1.1917868199795029e-09,
          "softmax_error": 7.51035986468196e-07,
          "matmul2_error": 6.760950782336295e-07,
          "demote_error": 7.510359864681959e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 6,
        "token_idx": 0,
        "token_error": 7.4027193477377295e-06,
        "entropy_ref": -0.0,
        "max_attention_weight_ref": 1.0,
        "attention_weight_error": 0.0,
        "stage_errors": {
          "storage_error": 2.080709464280517e-05,
          "matmul1_error": 1.0871999122478027e-09,
          "softmax_error": 6.828551704529673e-07,
          "matmul2_error": 6.942218988115201e-07,
          "demote_error": 6.828551704529673e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 7,
        "token_idx": 0,
        "token_error": 6.735957867931575e-06,
        "entropy_ref": -0.0,
        "max_attention_weight_ref": 1.0,
        "attention_weight_error": 0.0,
        "stage_errors": {
          "storage_error": 1.9266282379248878e-05,
          "matmul1_error": 8.556634602896832e-10,
          "softmax_error": 5.294583388604224e-07,
          "matmul2_error": 6.829429821664235e-07,
          "demote_error": 5.2945833886042235e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 1,
        "token_idx": 1,
        "token_error": 6.657428457401693e-06,
        "entropy_ref": 0.6931074857711792,
        "max_attention_weight_ref": 0.5044566988945007,
        "attention_weight_error": 2.384185791015625e-07,
        "stage_errors": {
          "storage_error": 2.078000488836551e-05,
          "matmul1_error": 1.0760924046899508e-09,
          "softmax_error": 6.640329957008362e-07,
          "matmul2_error": 6.977829798415769e-07,
          "demote_error": 6.640329957008362e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 3,
        "token_idx": 1,
        "token_error": 6.550482794409618e-06,
        "entropy_ref": 0.6931209564208984,
        "max_attention_weight_ref": 0.5036223530769348,
        "attention_weight_error": 7.152557373046875e-07,
        "stage_errors": {
          "storage_error": 2.0675972791650565e-05,
          "matmul1_error": 1.0477914516328994e-09,
          "softmax_error": 6.612204742850737e-07,
          "matmul2_error": 7.060615644149948e-07,
          "demote_error": 6.612204742850736e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 3,
        "token_idx": 2,
        "token_error": 6.550282705575228e-06,
        "entropy_ref": 1.0985990762710571,
        "max_attention_weight_ref": 0.33572205901145935,
        "attention_weight_error": 7.450580596923828e-07,
        "stage_errors": {
          "storage_error": 2.1475549601746025e-05,
          "matmul1_error": 1.1744949913936368e-09,
          "softmax_error": 7.411781552946195e-07,
          "matmul2_error": 7.060615644149948e-07,
          "demote_error": 7.411781552946196e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 6,
        "token_idx": 1,
        "token_error": 6.5297444962197915e-06,
        "entropy_ref": 0.6931289434432983,
        "max_attention_weight_ref": 0.5030207633972168,
        "attention_weight_error": 5.364418029785156e-07,
        "stage_errors": {
          "storage_error": 2.2584505586564774e-05,
          "matmul1_error": 1.3701883270242304e-09,
          "softmax_error": 8.605962648289279e-07,
          "matmul2_error": 6.942218988115201e-07,
          "demote_error": 8.605962648289278e-08
        }
      }
    ],
    "head_analysis": [
      {
        "head_idx": 0,
        "avg_error": 1.697119614618714e-06,
        "avg_entropy": 3.878161907196045,
        "avg_max_weight": 0.042860906571149826,
        "sparsity": 0.695068359375
      },
      {
        "head_idx": 1,
        "avg_error": 1.7877408708955045e-06,
        "avg_entropy": 3.8781607151031494,
        "avg_max_weight": 0.042895566672086716,
        "sparsity": 0.6949462890625
      },
      {
        "head_idx": 2,
        "avg_error": 1.6138825458256179e-06,
        "avg_entropy": 3.8781611919403076,
        "avg_max_weight": 0.04288845136761665,
        "sparsity": 0.6944580078125
      },
      {
        "head_idx": 3,
        "avg_error": 1.8523536482462077e-06,
        "avg_entropy": 3.8781614303588867,
        "avg_max_weight": 0.042872123420238495,
        "sparsity": 0.69500732421875
      },
      {
        "head_idx": 4,
        "avg_error": 1.807809780984826e-06,
        "avg_entropy": 3.8781609535217285,
        "avg_max_weight": 0.04290080443024635,
        "sparsity": 0.69500732421875
      },
      {
        "head_idx": 5,
        "avg_error": 1.7783002022042638e-06,
        "avg_entropy": 3.878161907196045,
        "avg_max_weight": 0.04285399615764618,
        "sparsity": 0.6947021484375
      },
      {
        "head_idx": 6,
        "avg_error": 1.8772220755636226e-06,
        "avg_entropy": 3.878161907196045,
        "avg_max_weight": 0.04285478591918945,
        "sparsity": 0.6949462890625
      },
      {
        "head_idx": 7,
        "avg_error": 1.7692659639578778e-06,
        "avg_entropy": 3.878162145614624,
        "avg_max_weight": 0.04285139590501785,
        "sparsity": 0.69512939453125
      }
    ]
  }
}
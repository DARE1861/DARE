{
  "detector": {
    "detected_exceeded": false,
    "actual_err": 5.778670310974121e-05,
    "predicted_bound": 0.00013315561373019593,
    "elapsed_sec": 2.96610951423645
  },
  "analyzer_report": {
    "component_estimates": {
      "input_storage_error": 5.778670310974121e-05,
      "matmul1_accumulation_error": 5.778670310974121e-05,
      "scaling_error": 5.778670310974121e-05,
      "softmax_numerical_error": 5.778670310974121e-05,
      "matmul2_accumulation_error": 5.778670310974121e-05,
      "output_demote_error": 7.448345422744751e-05
    },
    "component_ratios": {
      "input_storage_error": 0.15900936916989564,
      "matmul1_accumulation_error": 0.15900936916989564,
      "scaling_error": 0.15900936916989564,
      "softmax_numerical_error": 0.15900936916989564,
      "matmul2_accumulation_error": 0.15900936916989564,
      "output_demote_error": 0.20495315415052176
    },
    "primary_source": "storage_error",
    "suggestion": "\u4e3b\u8981\u8bef\u5dee\u6765\u6e90\u4e3a\u8f93\u5165\u5b58\u50a8\u7cbe\u5ea6\u3002\u5efa\u8bae\uff1a\u63d0\u5347Q/K/V\u7684\u5b58\u50a8\u7cbe\u5ea6\uff1b\u8fdb\u884c\u8f93\u5165\u5f52\u4e00\u5316\uff1b\u68c0\u67e5embedding\u5c42\u7684\u8f93\u51fa\u8303\u56f4\u3002 \u68c0\u6d4b\u5230\u5927\u91cf\u5c16\u9510\u7684attention\u6a21\u5f0f\uff08\u4f4e\u71b5\uff09\uff0c\u8fd9\u4f1a\u653e\u5927softmax\u7684\u6570\u503c\u8bef\u5dee\u3002\u8003\u8651\u4f7f\u7528attention dropout\u6216\u6e29\u5ea6\u7f29\u653e\u3002",
    "attention_pattern_stats": {
      "global_avg_entropy": 3.878162145614624,
      "global_sparsity": 0.6948013305664062,
      "max_attention_weight": 1.0,
      "min_attention_weight": 0.0
    },
    "attention_behavior_stats": {
      "high_entropy_tokens": 0,
      "low_entropy_tokens": 8,
      "total_analyzed": 8
    },
    "top_tokens_summary": [
      {
        "batch_idx": 0,
        "head_idx": 1,
        "token_idx": 1,
        "token_error": 8.81237065186724e-06,
        "entropy_ref": 0.6931341886520386,
        "max_attention_weight_ref": 0.5025435090065002,
        "attention_weight_error": 1.7881393432617188e-07,
        "stage_errors": {
          "storage_error": 2.1375434243964264e-05,
          "matmul1_error": 1.131384173789434e-09,
          "softmax_error": 7.009039109107107e-07,
          "matmul2_error": 7.232665666379035e-07,
          "demote_error": 7.009039109107107e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 3,
        "token_idx": 1,
        "token_error": 8.563798473915085e-06,
        "entropy_ref": 0.6931242942810059,
        "max_attention_weight_ref": 0.5033843517303467,
        "attention_weight_error": 1.1920928955078125e-07,
        "stage_errors": {
          "storage_error": 2.2020555206836434e-05,
          "matmul1_error": 1.2305865071303075e-09,
          "softmax_error": 7.668139005545527e-07,
          "matmul2_error": 7.260114671225893e-07,
          "demote_error": 7.668139005545527e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 4,
        "token_idx": 1,
        "token_error": 8.530771083314903e-06,
        "entropy_ref": 0.6931338310241699,
        "max_attention_weight_ref": 0.5025807023048401,
        "attention_weight_error": 5.662441253662109e-07,
        "stage_errors": {
          "storage_error": 2.18870836761198e-05,
          "matmul1_error": 1.2943452654764669e-09,
          "softmax_error": 8.116316166706383e-07,
          "matmul2_error": 6.722924808855169e-07,
          "demote_error": 8.116316166706383e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 6,
        "token_idx": 1,
        "token_error": 8.124974556267262e-06,
        "entropy_ref": 0.6930902600288391,
        "max_attention_weight_ref": 0.5053356885910034,
        "attention_weight_error": 7.748603820800781e-07,
        "stage_errors": {
          "storage_error": 2.2300125237961765e-05,
          "matmul1_error": 1.3005755217023695e-09,
          "softmax_error": 7.937956979731099e-07,
          "matmul2_error": 7.121279850252904e-07,
          "demote_error": 7.937956979731097e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 2,
        "token_idx": 1,
        "token_error": 8.037131919991225e-06,
        "entropy_ref": 0.6931212544441223,
        "max_attention_weight_ref": 0.5035999417304993,
        "attention_weight_error": 2.682209014892578e-07,
        "stage_errors": {
          "storage_error": 2.0194476292090258e-05,
          "matmul1_error": 9.458395543452238e-10,
          "softmax_error": 5.90622948948294e-07,
          "matmul2_error": 7.210872354335152e-07,
          "demote_error": 5.906229489482939e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 7,
        "token_idx": 1,
        "token_error": 8.010727469809353e-06,
        "entropy_ref": 0.6931365728378296,
        "max_attention_weight_ref": 0.502299427986145,
        "attention_weight_error": 5.662441253662109e-07,
        "stage_errors": {
          "storage_error": 2.0756486719619716e-05,
          "matmul1_error": 1.0348604759625572e-09,
          "softmax_error": 6.691090675303713e-07,
          "matmul2_error": 7.230216851894511e-07,
          "demote_error": 6.691090675303713e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 0,
        "token_idx": 0,
        "token_error": 7.620928045071196e-06,
        "entropy_ref": -0.0,
        "max_attention_weight_ref": 1.0,
        "attention_weight_error": 0.0,
        "stage_errors": {
          "storage_error": 1.8659982742974535e-05,
          "matmul1_error": 7.580252379004286e-10,
          "softmax_error": 4.772053216584027e-07,
          "matmul2_error": 6.867827778478386e-07,
          "demote_error": 4.772053216584027e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 1,
        "token_idx": 0,
        "token_error": 7.501832442358136e-06,
        "entropy_ref": -0.0,
        "max_attention_weight_ref": 1.0,
        "attention_weight_error": 0.0,
        "stage_errors": {
          "storage_error": 1.9841800622089067e-05,
          "matmul1_error": 8.838282989867882e-10,
          "softmax_error": 5.475405487231911e-07,
          "matmul2_error": 7.232665666379035e-07,
          "demote_error": 5.4754054872319103e-08
        }
      }
    ],
    "head_analysis": [
      {
        "head_idx": 0,
        "avg_error": 1.854808715506806e-06,
        "avg_entropy": 3.878162145614624,
        "avg_max_weight": 0.04285990446805954,
        "sparsity": 0.69488525390625
      },
      {
        "head_idx": 1,
        "avg_error": 1.9459273516986286e-06,
        "avg_entropy": 3.878162145614624,
        "avg_max_weight": 0.0428600013256073,
        "sparsity": 0.6947021484375
      },
      {
        "head_idx": 2,
        "avg_error": 1.7445422599848825e-06,
        "avg_entropy": 3.878162384033203,
        "avg_max_weight": 0.04285213351249695,
        "sparsity": 0.69451904296875
      },
      {
        "head_idx": 3,
        "avg_error": 1.9951194190070964e-06,
        "avg_entropy": 3.8781614303588867,
        "avg_max_weight": 0.042889468371868134,
        "sparsity": 0.6947021484375
      },
      {
        "head_idx": 4,
        "avg_error": 2.082496393995825e-06,
        "avg_entropy": 3.878162384033203,
        "avg_max_weight": 0.0428444929420948,
        "sparsity": 0.69525146484375
      },
      {
        "head_idx": 5,
        "avg_error": 1.699566610113834e-06,
        "avg_entropy": 3.878161907196045,
        "avg_max_weight": 0.04287014529109001,
        "sparsity": 0.6949462890625
      },
      {
        "head_idx": 6,
        "avg_error": 1.7136347878476954e-06,
        "avg_entropy": 3.8781611919403076,
        "avg_max_weight": 0.04289047792553902,
        "sparsity": 0.69464111328125
      },
      {
        "head_idx": 7,
        "avg_error": 1.752368689267314e-06,
        "avg_entropy": 3.878162384033203,
        "avg_max_weight": 0.042836155742406845,
        "sparsity": 0.69476318359375
      }
    ]
  }
}
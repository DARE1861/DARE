{
  "detector": {
    "detected_exceeded": false,
    "actual_err": 4.84958291053772e-05,
    "predicted_bound": 9.025406252476387e-05,
    "elapsed_sec": 3.0057573318481445
  },
  "analyzer_report": {
    "component_estimates": {
      "input_storage_error": 3.382563591003418e-05,
      "matmul1_accumulation_error": 3.382563591003418e-05,
      "scaling_error": 3.382563591003418e-05,
      "softmax_numerical_error": 3.382563591003418e-05,
      "matmul2_accumulation_error": 3.382563591003418e-05,
      "output_demote_error": 7.030367851257324e-05
    },
    "component_ratios": {
      "input_storage_error": 0.14127458302215584,
      "matmul1_accumulation_error": 0.14127458302215584,
      "scaling_error": 0.14127458302215584,
      "softmax_numerical_error": 0.14127458302215584,
      "matmul2_accumulation_error": 0.14127458302215584,
      "output_demote_error": 0.2936270848892208
    },
    "primary_source": "storage_error",
    "suggestion": "\u4e3b\u8981\u8bef\u5dee\u6765\u6e90\u4e3a\u8f93\u5165\u5b58\u50a8\u7cbe\u5ea6\u3002\u5efa\u8bae\uff1a\u63d0\u5347Q/K/V\u7684\u5b58\u50a8\u7cbe\u5ea6\uff1b\u8fdb\u884c\u8f93\u5165\u5f52\u4e00\u5316\uff1b\u68c0\u67e5embedding\u5c42\u7684\u8f93\u51fa\u8303\u56f4\u3002 \u68c0\u6d4b\u5230\u5927\u91cf\u5c16\u9510\u7684attention\u6a21\u5f0f\uff08\u4f4e\u71b5\uff09\uff0c\u8fd9\u4f1a\u653e\u5927softmax\u7684\u6570\u503c\u8bef\u5dee\u3002\u8003\u8651\u4f7f\u7528attention dropout\u6216\u6e29\u5ea6\u7f29\u653e\u3002",
    "attention_pattern_stats": {
      "global_avg_entropy": 3.878162145614624,
      "global_sparsity": 0.694854736328125,
      "max_attention_weight": 1.0,
      "min_attention_weight": 0.0
    },
    "attention_behavior_stats": {
      "high_entropy_tokens": 0,
      "low_entropy_tokens": 8,
      "total_analyzed": 8
    },
    "top_tokens_summary": [
      {
        "batch_idx": 0,
        "head_idx": 6,
        "token_idx": 0,
        "token_error": 1.0323448805138469e-05,
        "entropy_ref": -0.0,
        "max_attention_weight_ref": 1.0,
        "attention_weight_error": 0.0,
        "stage_errors": {
          "storage_error": 2.0131567453063326e-05,
          "matmul1_error": 9.927648721757143e-10,
          "softmax_error": 6.264344847295433e-07,
          "matmul2_error": 6.863389899081086e-07,
          "demote_error": 6.264344847295433e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 7,
        "token_idx": 1,
        "token_error": 8.457356670987792e-06,
        "entropy_ref": 0.6931218504905701,
        "max_attention_weight_ref": 0.5035593509674072,
        "attention_weight_error": 4.76837158203125e-07,
        "stage_errors": {
          "storage_error": 2.088806559186196e-05,
          "matmul1_error": 1.0903350323668476e-09,
          "softmax_error": 6.88065483700484e-07,
          "matmul2_error": 7.004231974860887e-07,
          "demote_error": 6.880654837004841e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 4,
        "token_idx": 0,
        "token_error": 8.351882570423186e-06,
        "entropy_ref": -0.0,
        "max_attention_weight_ref": 1.0,
        "attention_weight_error": 0.0,
        "stage_errors": {
          "storage_error": 2.0915735149173997e-05,
          "matmul1_error": 1.0963068943871988e-09,
          "softmax_error": 6.943388143554331e-07,
          "matmul2_error": 6.994431259954582e-07,
          "demote_error": 6.94338814355433e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 6,
        "token_idx": 1,
        "token_error": 8.177658855856862e-06,
        "entropy_ref": 0.6931249499320984,
        "max_attention_weight_ref": 0.5033318996429443,
        "attention_weight_error": 5.662441253662109e-07,
        "stage_errors": {
          "storage_error": 2.0371201117086457e-05,
          "matmul1_error": 1.0307416901243035e-09,
          "softmax_error": 6.503978511318564e-07,
          "matmul2_error": 6.863389899081086e-07,
          "demote_error": 6.503978511318564e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 4,
        "token_idx": 1,
        "token_error": 7.767725037410855e-06,
        "entropy_ref": 0.6931096911430359,
        "max_attention_weight_ref": 0.5043286681175232,
        "attention_weight_error": 7.450580596923828e-07,
        "stage_errors": {
          "storage_error": 2.1164863937883638e-05,
          "matmul1_error": 1.1356423892502153e-09,
          "softmax_error": 7.192516932263971e-07,
          "matmul2_error": 6.994431259954582e-07,
          "demote_error": 7.19251693226397e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 1,
        "token_idx": 1,
        "token_error": 7.711143553024158e-06,
        "entropy_ref": 0.6931362152099609,
        "max_attention_weight_ref": 0.5023344159126282,
        "attention_weight_error": 1.7881393432617188e-07,
        "stage_errors": {
          "storage_error": 1.9445770703896414e-05,
          "matmul1_error": 8.549093791099325e-10,
          "softmax_error": 5.417165084509179e-07,
          "matmul2_error": 7.05410639056936e-07,
          "demote_error": 5.417165084509179e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 0,
        "token_idx": 0,
        "token_error": 7.616490620421246e-06,
        "entropy_ref": -0.0,
        "max_attention_weight_ref": 1.0,
        "attention_weight_error": 0.0,
        "stage_errors": {
          "storage_error": 2.0619268070731778e-05,
          "matmul1_error": 1.0492138166253217e-09,
          "softmax_error": 6.528774974867702e-07,
          "matmul2_error": 6.988220775383525e-07,
          "demote_error": 6.528774974867701e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 0,
        "token_idx": 1,
        "token_error": 7.483938134100754e-06,
        "entropy_ref": 0.6931213140487671,
        "max_attention_weight_ref": 0.5035922527313232,
        "attention_weight_error": 7.748603820800781e-07,
        "stage_errors": {
          "storage_error": 2.0508062334556598e-05,
          "matmul1_error": 1.0313423789770432e-09,
          "softmax_error": 6.417569238692523e-07,
          "matmul2_error": 6.988220775383525e-07,
          "demote_error": 6.417569238692522e-08
        }
      }
    ],
    "head_analysis": [
      {
        "head_idx": 0,
        "avg_error": 1.8274513422511518e-06,
        "avg_entropy": 3.878161668777466,
        "avg_max_weight": 0.042880523949861526,
        "sparsity": 0.6951904296875
      },
      {
        "head_idx": 1,
        "avg_error": 1.8942066617455566e-06,
        "avg_entropy": 3.878162384033203,
        "avg_max_weight": 0.04283705726265907,
        "sparsity": 0.69464111328125
      },
      {
        "head_idx": 2,
        "avg_error": 1.923624722621753e-06,
        "avg_entropy": 3.878161668777466,
        "avg_max_weight": 0.04287528619170189,
        "sparsity": 0.69476318359375
      },
      {
        "head_idx": 3,
        "avg_error": 1.6801078572825645e-06,
        "avg_entropy": 3.878161668777466,
        "avg_max_weight": 0.04287005960941315,
        "sparsity": 0.69482421875
      },
      {
        "head_idx": 4,
        "avg_error": 2.0136665170866763e-06,
        "avg_entropy": 3.8781614303588867,
        "avg_max_weight": 0.042876534163951874,
        "sparsity": 0.6947021484375
      },
      {
        "head_idx": 5,
        "avg_error": 1.764311832630483e-06,
        "avg_entropy": 3.878161668777466,
        "avg_max_weight": 0.04286567121744156,
        "sparsity": 0.69512939453125
      },
      {
        "head_idx": 6,
        "avg_error": 1.6972308003460057e-06,
        "avg_entropy": 3.878162145614624,
        "avg_max_weight": 0.042847730219364166,
        "sparsity": 0.69476318359375
      },
      {
        "head_idx": 7,
        "avg_error": 1.8611871155371773e-06,
        "avg_entropy": 3.878161907196045,
        "avg_max_weight": 0.042853500694036484,
        "sparsity": 0.69482421875
      }
    ]
  }
}
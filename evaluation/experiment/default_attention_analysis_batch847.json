{
  "detector": {
    "detected_exceeded": false,
    "actual_err": 4.850327968597412e-05,
    "predicted_bound": 0.00012355279832263478,
    "elapsed_sec": 2.812314748764038
  },
  "analyzer_report": {
    "component_estimates": {
      "input_storage_error": 4.894286394119263e-05,
      "matmul1_accumulation_error": 4.894286394119263e-05,
      "scaling_error": 4.894286394119263e-05,
      "softmax_numerical_error": 4.894286394119263e-05,
      "matmul2_accumulation_error": 4.894286394119263e-05,
      "output_demote_error": 8.145719766616821e-05
    },
    "component_ratios": {
      "input_storage_error": 0.15005253780437663,
      "matmul1_accumulation_error": 0.15005253780437663,
      "scaling_error": 0.15005253780437663,
      "softmax_numerical_error": 0.15005253780437663,
      "matmul2_accumulation_error": 0.15005253780437663,
      "output_demote_error": 0.24973731097811686
    },
    "primary_source": "storage_error",
    "suggestion": "\u4e3b\u8981\u8bef\u5dee\u6765\u6e90\u4e3a\u8f93\u5165\u5b58\u50a8\u7cbe\u5ea6\u3002\u5efa\u8bae\uff1a\u63d0\u5347Q/K/V\u7684\u5b58\u50a8\u7cbe\u5ea6\uff1b\u8fdb\u884c\u8f93\u5165\u5f52\u4e00\u5316\uff1b\u68c0\u67e5embedding\u5c42\u7684\u8f93\u51fa\u8303\u56f4\u3002 \u68c0\u6d4b\u5230\u5927\u91cf\u5c16\u9510\u7684attention\u6a21\u5f0f\uff08\u4f4e\u71b5\uff09\uff0c\u8fd9\u4f1a\u653e\u5927softmax\u7684\u6570\u503c\u8bef\u5dee\u3002\u8003\u8651\u4f7f\u7528attention dropout\u6216\u6e29\u5ea6\u7f29\u653e\u3002",
    "attention_pattern_stats": {
      "global_avg_entropy": 3.878161907196045,
      "global_sparsity": 0.6949310302734375,
      "max_attention_weight": 1.0,
      "min_attention_weight": 0.0
    },
    "attention_behavior_stats": {
      "high_entropy_tokens": 0,
      "low_entropy_tokens": 8,
      "total_analyzed": 8
    },
    "top_tokens_summary": [
      {
        "batch_idx": 0,
        "head_idx": 1,
        "token_idx": 0,
        "token_error": 8.12516373116523e-06,
        "entropy_ref": -0.0,
        "max_attention_weight_ref": 1.0,
        "attention_weight_error": 0.0,
        "stage_errors": {
          "storage_error": 2.0069490346941166e-05,
          "matmul1_error": 9.436697603072065e-10,
          "softmax_error": 5.834473995491863e-07,
          "matmul2_error": 7.087036010489101e-07,
          "demote_error": 5.8344739954918624e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 6,
        "token_idx": 0,
        "token_error": 7.77638706495054e-06,
        "entropy_ref": -0.0,
        "max_attention_weight_ref": 1.0,
        "attention_weight_error": 0.0,
        "stage_errors": {
          "storage_error": 2.059731787085184e-05,
          "matmul1_error": 1.018344071622757e-09,
          "softmax_error": 6.237714842427522e-07,
          "matmul2_error": 7.144641131162644e-07,
          "demote_error": 6.237714842427521e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 7,
        "token_idx": 1,
        "token_error": 7.630951586179435e-06,
        "entropy_ref": 0.6931127309799194,
        "max_attention_weight_ref": 0.5041505694389343,
        "attention_weight_error": 8.344650268554688e-07,
        "stage_errors": {
          "storage_error": 2.147565010091057e-05,
          "matmul1_error": 1.2166661681376792e-09,
          "softmax_error": 7.738279236946255e-07,
          "matmul2_error": 6.78885498928139e-07,
          "demote_error": 7.738279236946255e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 0,
        "token_idx": 0,
        "token_error": 7.535851182183251e-06,
        "entropy_ref": -0.0,
        "max_attention_weight_ref": 1.0,
        "attention_weight_error": 0.0,
        "stage_errors": {
          "storage_error": 2.0675309315265622e-05,
          "matmul1_error": 1.058249562416984e-09,
          "softmax_error": 6.614565791096539e-07,
          "matmul2_error": 6.990216661506566e-07,
          "demote_error": 6.614565791096538e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 1,
        "token_idx": 1,
        "token_error": 7.30461033526808e-06,
        "entropy_ref": 0.6930887699127197,
        "max_attention_weight_ref": 0.5054061412811279,
        "attention_weight_error": 3.5762786865234375e-07,
        "stage_errors": {
          "storage_error": 2.3211125153466128e-05,
          "matmul1_error": 1.451798816523226e-09,
          "softmax_error": 8.976108802016825e-07,
          "matmul2_error": 7.087036010489101e-07,
          "demote_error": 8.976108802016825e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 7,
        "token_idx": 0,
        "token_error": 7.248198016895913e-06,
        "entropy_ref": -0.0,
        "max_attention_weight_ref": 1.0,
        "attention_weight_error": 0.0,
        "stage_errors": {
          "storage_error": 2.074951316899387e-05,
          "matmul1_error": 1.1024978612768658e-09,
          "softmax_error": 7.012142305029557e-07,
          "matmul2_error": 6.78885498928139e-07,
          "demote_error": 7.012142305029557e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 4,
        "token_idx": 1,
        "token_error": 7.1985286922426894e-06,
        "entropy_ref": 0.6931354999542236,
        "max_attention_weight_ref": 0.5024175643920898,
        "attention_weight_error": 1.1920928955078125e-07,
        "stage_errors": {
          "storage_error": 2.0640376988012576e-05,
          "matmul1_error": 1.0543446469547209e-09,
          "softmax_error": 6.322909030131996e-07,
          "matmul2_error": 6.948092504899251e-07,
          "demote_error": 6.322909030131995e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 5,
        "token_idx": 1,
        "token_error": 7.191909389803186e-06,
        "entropy_ref": 0.6931350231170654,
        "max_attention_weight_ref": 0.502465009689331,
        "attention_weight_error": 8.940696716308594e-08,
        "stage_errors": {
          "storage_error": 1.9095015431958018e-05,
          "matmul1_error": 8.156189216892682e-10,
          "softmax_error": 5.202055035624653e-07,
          "matmul2_error": 6.963851774344222e-07,
          "demote_error": 5.2020550356246535e-08
        }
      }
    ],
    "head_analysis": [
      {
        "head_idx": 0,
        "avg_error": 1.84908321898547e-06,
        "avg_entropy": 3.878162384033203,
        "avg_max_weight": 0.0428352989256382,
        "sparsity": 0.69482421875
      },
      {
        "head_idx": 1,
        "avg_error": 1.9204430827812757e-06,
        "avg_entropy": 3.8781614303588867,
        "avg_max_weight": 0.04289219155907631,
        "sparsity": 0.69482421875
      },
      {
        "head_idx": 2,
        "avg_error": 1.669991206654231e-06,
        "avg_entropy": 3.8781609535217285,
        "avg_max_weight": 0.04288807138800621,
        "sparsity": 0.6947021484375
      },
      {
        "head_idx": 3,
        "avg_error": 1.7392742392985383e-06,
        "avg_entropy": 3.878161907196045,
        "avg_max_weight": 0.042856521904468536,
        "sparsity": 0.69512939453125
      },
      {
        "head_idx": 4,
        "avg_error": 1.6913339777602232e-06,
        "avg_entropy": 3.8781611919403076,
        "avg_max_weight": 0.04288255423307419,
        "sparsity": 0.69488525390625
      },
      {
        "head_idx": 5,
        "avg_error": 1.9062617866438814e-06,
        "avg_entropy": 3.878161907196045,
        "avg_max_weight": 0.04284829646348953,
        "sparsity": 0.69512939453125
      },
      {
        "head_idx": 6,
        "avg_error": 1.946340489666909e-06,
        "avg_entropy": 3.8781611919403076,
        "avg_max_weight": 0.042887717485427856,
        "sparsity": 0.69488525390625
      },
      {
        "head_idx": 7,
        "avg_error": 1.845825977397908e-06,
        "avg_entropy": 3.878162145614624,
        "avg_max_weight": 0.04286424070596695,
        "sparsity": 0.695068359375
      }
    ]
  }
}
{
  "detector": {
    "detected_exceeded": false,
    "actual_err": 6.118416786193848e-05,
    "predicted_bound": 0.00015527424984611572,
    "elapsed_sec": 2.8660919666290283
  },
  "analyzer_report": {
    "component_estimates": {
      "input_storage_error": 7.620453834533691e-05,
      "matmul1_accumulation_error": 7.620453834533691e-05,
      "scaling_error": 7.620453834533691e-05,
      "softmax_numerical_error": 7.620453834533691e-05,
      "matmul2_accumulation_error": 7.620453834533691e-05,
      "output_demote_error": 9.296834468841553e-05
    },
    "component_ratios": {
      "input_storage_error": 0.16077210852274512,
      "matmul1_accumulation_error": 0.16077210852274512,
      "scaling_error": 0.16077210852274512,
      "softmax_numerical_error": 0.16077210852274512,
      "matmul2_accumulation_error": 0.16077210852274512,
      "output_demote_error": 0.19613945738627434
    },
    "primary_source": "storage_error",
    "suggestion": "\u4e3b\u8981\u8bef\u5dee\u6765\u6e90\u4e3a\u8f93\u5165\u5b58\u50a8\u7cbe\u5ea6\u3002\u5efa\u8bae\uff1a\u63d0\u5347Q/K/V\u7684\u5b58\u50a8\u7cbe\u5ea6\uff1b\u8fdb\u884c\u8f93\u5165\u5f52\u4e00\u5316\uff1b\u68c0\u67e5embedding\u5c42\u7684\u8f93\u51fa\u8303\u56f4\u3002 \u68c0\u6d4b\u5230\u5927\u91cf\u5c16\u9510\u7684attention\u6a21\u5f0f\uff08\u4f4e\u71b5\uff09\uff0c\u8fd9\u4f1a\u653e\u5927softmax\u7684\u6570\u503c\u8bef\u5dee\u3002\u8003\u8651\u4f7f\u7528attention dropout\u6216\u6e29\u5ea6\u7f29\u653e\u3002",
    "attention_pattern_stats": {
      "global_avg_entropy": 3.878161907196045,
      "global_sparsity": 0.6948089599609375,
      "max_attention_weight": 1.0,
      "min_attention_weight": 0.0
    },
    "attention_behavior_stats": {
      "high_entropy_tokens": 0,
      "low_entropy_tokens": 7,
      "total_analyzed": 8
    },
    "top_tokens_summary": [
      {
        "batch_idx": 0,
        "head_idx": 1,
        "token_idx": 1,
        "token_error": 1.04248829302378e-05,
        "entropy_ref": 0.6931215524673462,
        "max_attention_weight_ref": 0.5035794973373413,
        "attention_weight_error": 5.662441253662109e-07,
        "stage_errors": {
          "storage_error": 2.3297225652640918e-05,
          "matmul1_error": 1.4573573737848262e-09,
          "softmax_error": 8.859147783368827e-07,
          "matmul2_error": 7.167998774093576e-07,
          "demote_error": 8.859147783368826e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 4,
        "token_idx": 1,
        "token_error": 9.192902325594332e-06,
        "entropy_ref": 0.6931324005126953,
        "max_attention_weight_ref": 0.5027145743370056,
        "attention_weight_error": 2.384185791015625e-07,
        "stage_errors": {
          "storage_error": 2.004570069402689e-05,
          "matmul1_error": 9.302133975297193e-10,
          "softmax_error": 6.012218364048749e-07,
          "matmul2_error": 7.195737907750299e-07,
          "demote_error": 6.01221836404875e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 6,
        "token_idx": 1,
        "token_error": 8.92567913979292e-06,
        "entropy_ref": 0.6931370496749878,
        "max_attention_weight_ref": 0.5022583603858948,
        "attention_weight_error": 7.152557373046875e-07,
        "stage_errors": {
          "storage_error": 1.9863461602653842e-05,
          "matmul1_error": 9.544755485934028e-10,
          "softmax_error": 5.955222150078044e-07,
          "matmul2_error": 6.825001037213952e-07,
          "demote_error": 5.9552221500780434e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 7,
        "token_idx": 1,
        "token_error": 8.375202014576644e-06,
        "entropy_ref": 0.6931108832359314,
        "max_attention_weight_ref": 0.5042593479156494,
        "attention_weight_error": 2.175569534301758e-06,
        "stage_errors": {
          "storage_error": 2.293029456268414e-05,
          "matmul1_error": 1.3974181294080876e-09,
          "softmax_error": 8.820119546726346e-07,
          "matmul2_error": 7.108258614607621e-07,
          "demote_error": 8.820119546726346e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 1,
        "token_idx": 2,
        "token_error": 8.28713018563576e-06,
        "entropy_ref": 1.0985946655273438,
        "max_attention_weight_ref": 0.3359661400318146,
        "attention_weight_error": 4.76837158203125e-07,
        "stage_errors": {
          "storage_error": 2.1012735032854835e-05,
          "matmul1_error": 1.0815515591061718e-09,
          "softmax_error": 6.574657163582743e-07,
          "matmul2_error": 7.167998774093576e-07,
          "demote_error": 6.574657163582742e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 0,
        "token_idx": 1,
        "token_error": 8.067559065239038e-06,
        "entropy_ref": 0.6931038498878479,
        "max_attention_weight_ref": 0.5046551823616028,
        "attention_weight_error": 3.2782554626464844e-07,
        "stage_errors": {
          "storage_error": 2.1691780148103135e-05,
          "matmul1_error": 1.2161241995146125e-09,
          "softmax_error": 7.483948138542474e-07,
          "matmul2_error": 7.026381354080514e-07,
          "demote_error": 7.483948138542474e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 7,
        "token_idx": 0,
        "token_error": 7.999497029231861e-06,
        "entropy_ref": -0.0,
        "max_attention_weight_ref": 1.0,
        "attention_weight_error": 0.0,
        "stage_errors": {
          "storage_error": 2.1240795376797905e-05,
          "matmul1_error": 1.1297418491184505e-09,
          "softmax_error": 7.130620360840112e-07,
          "matmul2_error": 7.108258614607621e-07,
          "demote_error": 7.130620360840112e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 1,
        "token_idx": 0,
        "token_error": 7.5174757512286305e-06,
        "entropy_ref": -0.0,
        "max_attention_weight_ref": 1.0,
        "attention_weight_error": 0.0,
        "stage_errors": {
          "storage_error": 2.1431470031529898e-05,
          "matmul1_error": 1.1504347691962541e-09,
          "softmax_error": 6.993392162257806e-07,
          "matmul2_error": 7.167998774093576e-07,
          "demote_error": 6.993392162257806e-08
        }
      }
    ],
    "head_analysis": [
      {
        "head_idx": 0,
        "avg_error": 1.953345872607315e-06,
        "avg_entropy": 3.878161907196045,
        "avg_max_weight": 0.04286642000079155,
        "sparsity": 0.69464111328125
      },
      {
        "head_idx": 1,
        "avg_error": 1.800838276722061e-06,
        "avg_entropy": 3.8781611919403076,
        "avg_max_weight": 0.04287894442677498,
        "sparsity": 0.69482421875
      },
      {
        "head_idx": 2,
        "avg_error": 1.7098809621529654e-06,
        "avg_entropy": 3.8781614303588867,
        "avg_max_weight": 0.04287426546216011,
        "sparsity": 0.69488525390625
      },
      {
        "head_idx": 3,
        "avg_error": 1.6442984360764967e-06,
        "avg_entropy": 3.8781609535217285,
        "avg_max_weight": 0.042896341532468796,
        "sparsity": 0.69500732421875
      },
      {
        "head_idx": 4,
        "avg_error": 1.654407014939352e-06,
        "avg_entropy": 3.878161907196045,
        "avg_max_weight": 0.042855944484472275,
        "sparsity": 0.69476318359375
      },
      {
        "head_idx": 5,
        "avg_error": 1.78983930254617e-06,
        "avg_entropy": 3.878162145614624,
        "avg_max_weight": 0.04282901808619499,
        "sparsity": 0.69488525390625
      },
      {
        "head_idx": 6,
        "avg_error": 1.914324684548774e-06,
        "avg_entropy": 3.878161907196045,
        "avg_max_weight": 0.04285530000925064,
        "sparsity": 0.6944580078125
      },
      {
        "head_idx": 7,
        "avg_error": 2.043619815594866e-06,
        "avg_entropy": 3.8781614303588867,
        "avg_max_weight": 0.042883433401584625,
        "sparsity": 0.69500732421875
      }
    ]
  }
}
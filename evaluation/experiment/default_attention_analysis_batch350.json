{
  "detector": {
    "detected_exceeded": false,
    "actual_err": 5.3554773330688477e-05,
    "predicted_bound": 0.00013052694266662003,
    "elapsed_sec": 2.898393392562866
  },
  "analyzer_report": {
    "component_estimates": {
      "input_storage_error": 5.3554773330688477e-05,
      "matmul1_accumulation_error": 5.3554773330688477e-05,
      "scaling_error": 5.3554773330688477e-05,
      "softmax_numerical_error": 5.3554773330688477e-05,
      "matmul2_accumulation_error": 5.3554773330688477e-05,
      "output_demote_error": 8.109211921691895e-05
    },
    "component_ratios": {
      "input_storage_error": 0.15351101998974884,
      "matmul1_accumulation_error": 0.15351101998974884,
      "scaling_error": 0.15351101998974884,
      "softmax_numerical_error": 0.15351101998974884,
      "matmul2_accumulation_error": 0.15351101998974884,
      "output_demote_error": 0.23244490005125576
    },
    "primary_source": "storage_error",
    "suggestion": "\u4e3b\u8981\u8bef\u5dee\u6765\u6e90\u4e3a\u8f93\u5165\u5b58\u50a8\u7cbe\u5ea6\u3002\u5efa\u8bae\uff1a\u63d0\u5347Q/K/V\u7684\u5b58\u50a8\u7cbe\u5ea6\uff1b\u8fdb\u884c\u8f93\u5165\u5f52\u4e00\u5316\uff1b\u68c0\u67e5embedding\u5c42\u7684\u8f93\u51fa\u8303\u56f4\u3002 \u68c0\u6d4b\u5230\u5927\u91cf\u5c16\u9510\u7684attention\u6a21\u5f0f\uff08\u4f4e\u71b5\uff09\uff0c\u8fd9\u4f1a\u653e\u5927softmax\u7684\u6570\u503c\u8bef\u5dee\u3002\u8003\u8651\u4f7f\u7528attention dropout\u6216\u6e29\u5ea6\u7f29\u653e\u3002",
    "attention_pattern_stats": {
      "global_avg_entropy": 3.878161668777466,
      "global_sparsity": 0.69482421875,
      "max_attention_weight": 1.0,
      "min_attention_weight": 0.0
    },
    "attention_behavior_stats": {
      "high_entropy_tokens": 0,
      "low_entropy_tokens": 7,
      "total_analyzed": 8
    },
    "top_tokens_summary": [
      {
        "batch_idx": 0,
        "head_idx": 0,
        "token_idx": 1,
        "token_error": 1.0542920790612698e-05,
        "entropy_ref": 0.6931314468383789,
        "max_attention_weight_ref": 0.5028052926063538,
        "attention_weight_error": 8.940696716308594e-08,
        "stage_errors": {
          "storage_error": 2.3544167561340146e-05,
          "matmul1_error": 1.5029682606008044e-09,
          "softmax_error": 9.414048690814526e-07,
          "matmul2_error": 7.07444678482716e-07,
          "demote_error": 9.414048690814525e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 5,
        "token_idx": 1,
        "token_error": 9.909988875733688e-06,
        "entropy_ref": 0.6931202411651611,
        "max_attention_weight_ref": 0.5036737322807312,
        "attention_weight_error": 4.76837158203125e-07,
        "stage_errors": {
          "storage_error": 2.1466942598635796e-05,
          "matmul1_error": 1.1793405719320677e-09,
          "softmax_error": 7.344144250964747e-07,
          "matmul2_error": 7.025990271358751e-07,
          "demote_error": 7.344144250964746e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 4,
        "token_idx": 1,
        "token_error": 8.019735105335712e-06,
        "entropy_ref": 0.693131685256958,
        "max_attention_weight_ref": 0.5027793645858765,
        "attention_weight_error": 8.940696716308594e-08,
        "stage_errors": {
          "storage_error": 1.9552693174773594e-05,
          "matmul1_error": 8.793073760893349e-10,
          "softmax_error": 5.646368663292379e-07,
          "matmul2_error": 7.02397846907843e-07,
          "demote_error": 5.6463686632923785e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 7,
        "token_idx": 1,
        "token_error": 7.665265002287924e-06,
        "entropy_ref": 0.6931108236312866,
        "max_attention_weight_ref": 0.5042648315429688,
        "attention_weight_error": 9.834766387939453e-07,
        "stage_errors": {
          "storage_error": 2.0824963939958252e-05,
          "matmul1_error": 1.1110609474475632e-09,
          "softmax_error": 6.769711035303772e-07,
          "matmul2_error": 6.802000825700816e-07,
          "demote_error": 6.769711035303771e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 1,
        "token_idx": 0,
        "token_error": 7.5485731940716505e-06,
        "entropy_ref": -0.0,
        "max_attention_weight_ref": 1.0,
        "attention_weight_error": 0.0,
        "stage_errors": {
          "storage_error": 1.955661036845413e-05,
          "matmul1_error": 8.602053298510223e-10,
          "softmax_error": 5.370187864173204e-07,
          "matmul2_error": 7.107328656275059e-07,
          "demote_error": 5.370187864173204e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 5,
        "token_idx": 2,
        "token_error": 7.506223482778296e-06,
        "entropy_ref": 1.0985887050628662,
        "max_attention_weight_ref": 0.33624565601348877,
        "attention_weight_error": 5.066394805908203e-07,
        "stage_errors": {
          "storage_error": 2.3354969926003832e-05,
          "matmul1_error": 1.4825245988238457e-09,
          "softmax_error": 9.232171578332782e-07,
          "matmul2_error": 7.025990271358751e-07,
          "demote_error": 9.232171578332782e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 7,
        "token_idx": 0,
        "token_error": 7.319831638596952e-06,
        "entropy_ref": -0.0,
        "max_attention_weight_ref": 1.0,
        "attention_weight_error": 0.0,
        "stage_errors": {
          "storage_error": 2.3473456167266704e-05,
          "matmul1_error": 1.5457377405979806e-09,
          "softmax_error": 9.418203262612224e-07,
          "matmul2_error": 6.802000825700816e-07,
          "demote_error": 9.418203262612224e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 3,
        "token_idx": 1,
        "token_error": 7.27370752429124e-06,
        "entropy_ref": 0.6930975317955017,
        "max_attention_weight_ref": 0.5049830079078674,
        "attention_weight_error": 2.384185791015625e-07,
        "stage_errors": {
          "storage_error": 2.01367361114535e-05,
          "matmul1_error": 9.44967525742499e-10,
          "softmax_error": 5.840927769895643e-07,
          "matmul2_error": 7.14590669304016e-07,
          "demote_error": 5.840927769895643e-08
        }
      }
    ],
    "head_analysis": [
      {
        "head_idx": 0,
        "avg_error": 1.811973220355867e-06,
        "avg_entropy": 3.878161907196045,
        "avg_max_weight": 0.04285797104239464,
        "sparsity": 0.6949462890625
      },
      {
        "head_idx": 1,
        "avg_error": 1.8984677581102005e-06,
        "avg_entropy": 3.878161668777466,
        "avg_max_weight": 0.042888712137937546,
        "sparsity": 0.6951904296875
      },
      {
        "head_idx": 2,
        "avg_error": 1.6660968640280771e-06,
        "avg_entropy": 3.878162145614624,
        "avg_max_weight": 0.04285600781440735,
        "sparsity": 0.69488525390625
      },
      {
        "head_idx": 3,
        "avg_error": 1.7250844166483148e-06,
        "avg_entropy": 3.8781614303588867,
        "avg_max_weight": 0.04288998991250992,
        "sparsity": 0.69464111328125
      },
      {
        "head_idx": 4,
        "avg_error": 1.7274935544264736e-06,
        "avg_entropy": 3.878162145614624,
        "avg_max_weight": 0.04284868389368057,
        "sparsity": 0.6947021484375
      },
      {
        "head_idx": 5,
        "avg_error": 1.922275714605348e-06,
        "avg_entropy": 3.878161907196045,
        "avg_max_weight": 0.042850978672504425,
        "sparsity": 0.694580078125
      },
      {
        "head_idx": 6,
        "avg_error": 1.6458895970572485e-06,
        "avg_entropy": 3.878161668777466,
        "avg_max_weight": 0.04287484288215637,
        "sparsity": 0.69488525390625
      },
      {
        "head_idx": 7,
        "avg_error": 1.8135036725652753e-06,
        "avg_entropy": 3.8781611919403076,
        "avg_max_weight": 0.042883265763521194,
        "sparsity": 0.69476318359375
      }
    ]
  }
}
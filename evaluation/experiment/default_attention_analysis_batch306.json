{
  "detector": {
    "detected_exceeded": false,
    "actual_err": 5.7891011238098145e-05,
    "predicted_bound": 0.00013059217963018455,
    "elapsed_sec": 3.047219753265381
  },
  "analyzer_report": {
    "component_estimates": {
      "input_storage_error": 5.7891011238098145e-05,
      "matmul1_accumulation_error": 5.7891011238098145e-05,
      "scaling_error": 5.7891011238098145e-05,
      "softmax_numerical_error": 5.7891011238098145e-05,
      "matmul2_accumulation_error": 5.7891011238098145e-05,
      "output_demote_error": 8.846074342727661e-05
    },
    "component_ratios": {
      "input_storage_error": 0.15318494568538926,
      "matmul1_accumulation_error": 0.15318494568538926,
      "scaling_error": 0.15318494568538926,
      "softmax_numerical_error": 0.15318494568538926,
      "matmul2_accumulation_error": 0.15318494568538926,
      "output_demote_error": 0.23407527157305363
    },
    "primary_source": "storage_error",
    "suggestion": "\u4e3b\u8981\u8bef\u5dee\u6765\u6e90\u4e3a\u8f93\u5165\u5b58\u50a8\u7cbe\u5ea6\u3002\u5efa\u8bae\uff1a\u63d0\u5347Q/K/V\u7684\u5b58\u50a8\u7cbe\u5ea6\uff1b\u8fdb\u884c\u8f93\u5165\u5f52\u4e00\u5316\uff1b\u68c0\u67e5embedding\u5c42\u7684\u8f93\u51fa\u8303\u56f4\u3002 \u68c0\u6d4b\u5230\u5927\u91cf\u5c16\u9510\u7684attention\u6a21\u5f0f\uff08\u4f4e\u71b5\uff09\uff0c\u8fd9\u4f1a\u653e\u5927softmax\u7684\u6570\u503c\u8bef\u5dee\u3002\u8003\u8651\u4f7f\u7528attention dropout\u6216\u6e29\u5ea6\u7f29\u653e\u3002",
    "attention_pattern_stats": {
      "global_avg_entropy": 3.878161668777466,
      "global_sparsity": 0.694854736328125,
      "max_attention_weight": 1.0,
      "min_attention_weight": 0.0
    },
    "attention_behavior_stats": {
      "high_entropy_tokens": 0,
      "low_entropy_tokens": 8,
      "total_analyzed": 8
    },
    "top_tokens_summary": [
      {
        "batch_idx": 0,
        "head_idx": 4,
        "token_idx": 0,
        "token_error": 1.0569383448455483e-05,
        "entropy_ref": -0.0,
        "max_attention_weight_ref": 1.0,
        "attention_weight_error": 0.0,
        "stage_errors": {
          "storage_error": 1.940906849995372e-05,
          "matmul1_error": 8.571078121210522e-10,
          "softmax_error": 5.345005774870515e-07,
          "matmul2_error": 6.977228167670547e-07,
          "demote_error": 5.345005774870515e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 5,
        "token_idx": 1,
        "token_error": 9.361894626636058e-06,
        "entropy_ref": 0.6931238174438477,
        "max_attention_weight_ref": 0.5034193992614746,
        "attention_weight_error": 5.960464477539062e-07,
        "stage_errors": {
          "storage_error": 2.2514182091981638e-05,
          "matmul1_error": 1.3059383544797877e-09,
          "softmax_error": 8.232862455770374e-07,
          "matmul2_error": 7.271015874721343e-07,
          "demote_error": 8.232862455770373e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 7,
        "token_idx": 1,
        "token_error": 9.347073500975966e-06,
        "entropy_ref": 0.693122148513794,
        "max_attention_weight_ref": 0.5035355091094971,
        "attention_weight_error": 1.1324882507324219e-06,
        "stage_errors": {
          "storage_error": 2.0180942101433175e-05,
          "matmul1_error": 9.802941778216692e-10,
          "softmax_error": 6.149013643153012e-07,
          "matmul2_error": 6.986360858718399e-07,
          "demote_error": 6.149013643153011e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 0,
        "token_idx": 1,
        "token_error": 9.284667612519115e-06,
        "entropy_ref": 0.6931392550468445,
        "max_attention_weight_ref": 0.5019940137863159,
        "attention_weight_error": 2.9802322387695312e-08,
        "stage_errors": {
          "storage_error": 1.8579617062641773e-05,
          "matmul1_error": 7.426330505727568e-10,
          "softmax_error": 4.692788934335113e-07,
          "matmul2_error": 6.893107638461516e-07,
          "demote_error": 4.692788934335113e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 6,
        "token_idx": 0,
        "token_error": 8.884424460120499e-06,
        "entropy_ref": -0.0,
        "max_attention_weight_ref": 1.0,
        "attention_weight_error": 0.0,
        "stage_errors": {
          "storage_error": 2.1413196009234525e-05,
          "matmul1_error": 1.174415785524611e-09,
          "softmax_error": 7.365299097727985e-07,
          "matmul2_error": 7.001022822805681e-07,
          "demote_error": 7.365299097727985e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 1,
        "token_idx": 1,
        "token_error": 8.720268851902802e-06,
        "entropy_ref": 0.6931066513061523,
        "max_attention_weight_ref": 0.5045026540756226,
        "attention_weight_error": 3.2782554626464844e-07,
        "stage_errors": {
          "storage_error": 2.3022410459816456e-05,
          "matmul1_error": 1.4079494712128414e-09,
          "softmax_error": 8.736718882573769e-07,
          "matmul2_error": 7.163662758102874e-07,
          "demote_error": 8.736718882573769e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 6,
        "token_idx": 1,
        "token_error": 8.449984306935221e-06,
        "entropy_ref": 0.6931420564651489,
        "max_attention_weight_ref": 0.5015966296195984,
        "attention_weight_error": 2.384185791015625e-07,
        "stage_errors": {
          "storage_error": 1.950308978848625e-05,
          "matmul1_error": 8.69844461548437e-10,
          "softmax_error": 5.455192876979709e-07,
          "matmul2_error": 7.001022822805681e-07,
          "demote_error": 5.455192876979709e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 7,
        "token_idx": 0,
        "token_error": 8.264436473837122e-06,
        "entropy_ref": -0.0,
        "max_attention_weight_ref": 1.0,
        "attention_weight_error": 0.0,
        "stage_errors": {
          "storage_error": 2.0844873233727412e-05,
          "matmul1_error": 1.0861400681112956e-09,
          "softmax_error": 6.81294477544725e-07,
          "matmul2_error": 6.986360858718399e-07,
          "demote_error": 6.812944775447249e-08
        }
      }
    ],
    "head_analysis": [
      {
        "head_idx": 0,
        "avg_error": 1.7461520656070206e-06,
        "avg_entropy": 3.8781609535217285,
        "avg_max_weight": 0.04289018362760544,
        "sparsity": 0.6947021484375
      },
      {
        "head_idx": 1,
        "avg_error": 1.817855149965908e-06,
        "avg_entropy": 3.8781609535217285,
        "avg_max_weight": 0.04288826137781143,
        "sparsity": 0.695068359375
      },
      {
        "head_idx": 2,
        "avg_error": 1.972959580598399e-06,
        "avg_entropy": 3.8781609535217285,
        "avg_max_weight": 0.042890120297670364,
        "sparsity": 0.69500732421875
      },
      {
        "head_idx": 3,
        "avg_error": 1.8678445030673174e-06,
        "avg_entropy": 3.878161907196045,
        "avg_max_weight": 0.04286607354879379,
        "sparsity": 0.695068359375
      },
      {
        "head_idx": 4,
        "avg_error": 1.8709521327764378e-06,
        "avg_entropy": 3.878162145614624,
        "avg_max_weight": 0.042851030826568604,
        "sparsity": 0.6947021484375
      },
      {
        "head_idx": 5,
        "avg_error": 1.828550239224569e-06,
        "avg_entropy": 3.8781611919403076,
        "avg_max_weight": 0.04287988692522049,
        "sparsity": 0.69476318359375
      },
      {
        "head_idx": 6,
        "avg_error": 1.924350726767443e-06,
        "avg_entropy": 3.878161907196045,
        "avg_max_weight": 0.042846906930208206,
        "sparsity": 0.69482421875
      },
      {
        "head_idx": 7,
        "avg_error": 1.9451056232355768e-06,
        "avg_entropy": 3.8781614303588867,
        "avg_max_weight": 0.04287141561508179,
        "sparsity": 0.6947021484375
      }
    ]
  }
}
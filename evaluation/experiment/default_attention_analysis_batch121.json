{
  "detector": {
    "detected_exceeded": false,
    "actual_err": 4.03672456741333e-05,
    "predicted_bound": 0.00011154903695569374,
    "elapsed_sec": 2.924642324447632
  },
  "analyzer_report": {
    "component_estimates": {
      "input_storage_error": 4.459172487258911e-05,
      "matmul1_accumulation_error": 4.459172487258911e-05,
      "scaling_error": 4.459172487258911e-05,
      "softmax_numerical_error": 4.459172487258911e-05,
      "matmul2_accumulation_error": 4.459172487258911e-05,
      "output_demote_error": 7.250159978866577e-05
    },
    "component_ratios": {
      "input_storage_error": 0.1509229372604398,
      "matmul1_accumulation_error": 0.1509229372604398,
      "scaling_error": 0.1509229372604398,
      "softmax_numerical_error": 0.1509229372604398,
      "matmul2_accumulation_error": 0.1509229372604398,
      "output_demote_error": 0.2453853136978011
    },
    "primary_source": "storage_error",
    "suggestion": "\u4e3b\u8981\u8bef\u5dee\u6765\u6e90\u4e3a\u8f93\u5165\u5b58\u50a8\u7cbe\u5ea6\u3002\u5efa\u8bae\uff1a\u63d0\u5347Q/K/V\u7684\u5b58\u50a8\u7cbe\u5ea6\uff1b\u8fdb\u884c\u8f93\u5165\u5f52\u4e00\u5316\uff1b\u68c0\u67e5embedding\u5c42\u7684\u8f93\u51fa\u8303\u56f4\u3002 \u68c0\u6d4b\u5230\u5927\u91cf\u5c16\u9510\u7684attention\u6a21\u5f0f\uff08\u4f4e\u71b5\uff09\uff0c\u8fd9\u4f1a\u653e\u5927softmax\u7684\u6570\u503c\u8bef\u5dee\u3002\u8003\u8651\u4f7f\u7528attention dropout\u6216\u6e29\u5ea6\u7f29\u653e\u3002",
    "attention_pattern_stats": {
      "global_avg_entropy": 3.878161907196045,
      "global_sparsity": 0.694793701171875,
      "max_attention_weight": 1.0,
      "min_attention_weight": 0.0
    },
    "attention_behavior_stats": {
      "high_entropy_tokens": 0,
      "low_entropy_tokens": 8,
      "total_analyzed": 8
    },
    "top_tokens_summary": [
      {
        "batch_idx": 0,
        "head_idx": 1,
        "token_idx": 1,
        "token_error": 8.670867828186601e-06,
        "entropy_ref": 0.6930665969848633,
        "max_attention_weight_ref": 0.5063502788543701,
        "attention_weight_error": 7.748603820800781e-07,
        "stage_errors": {
          "storage_error": 2.4229546852438943e-05,
          "matmul1_error": 1.6240983900435652e-09,
          "softmax_error": 1.0167161235585808e-06,
          "matmul2_error": 7.002825441304595e-07,
          "demote_error": 1.0167161235585808e-07
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 7,
        "token_idx": 1,
        "token_error": 8.661634637974203e-06,
        "entropy_ref": 0.6930971741676331,
        "max_attention_weight_ref": 0.5050011277198792,
        "attention_weight_error": 8.344650268554688e-07,
        "stage_errors": {
          "storage_error": 2.0975136976630893e-05,
          "matmul1_error": 1.1427125377547957e-09,
          "softmax_error": 7.294096576515585e-07,
          "matmul2_error": 6.757463779649697e-07,
          "demote_error": 7.294096576515585e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 4,
        "token_idx": 1,
        "token_error": 8.165072358679026e-06,
        "entropy_ref": 0.6931328773498535,
        "max_attention_weight_ref": 0.5026715397834778,
        "attention_weight_error": 1.1622905731201172e-06,
        "stage_errors": {
          "storage_error": 2.0276236682548188e-05,
          "matmul1_error": 9.677029965647127e-10,
          "softmax_error": 5.999434506520629e-07,
          "matmul2_error": 7.148324584704825e-07,
          "demote_error": 5.999434506520629e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 0,
        "token_idx": 1,
        "token_error": 7.91563797974959e-06,
        "entropy_ref": 0.6931099891662598,
        "max_attention_weight_ref": 0.5043162703514099,
        "attention_weight_error": 8.642673492431641e-07,
        "stage_errors": {
          "storage_error": 2.2622950837103417e-05,
          "matmul1_error": 1.4021396241224924e-09,
          "softmax_error": 8.751419954933227e-07,
          "matmul2_error": 6.790805400669343e-07,
          "demote_error": 8.751419954933227e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 2,
        "token_idx": 0,
        "token_error": 7.912083674455062e-06,
        "entropy_ref": -0.0,
        "max_attention_weight_ref": 1.0,
        "attention_weight_error": 0.0,
        "stage_errors": {
          "storage_error": 2.136270040864474e-05,
          "matmul1_error": 1.2061054543597339e-09,
          "softmax_error": 7.57843372412026e-07,
          "matmul2_error": 6.750777174602263e-07,
          "demote_error": 7.578433724120259e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 3,
        "token_idx": 0,
        "token_error": 7.725266186753288e-06,
        "entropy_ref": -0.0,
        "max_attention_weight_ref": 1.0,
        "attention_weight_error": 0.0,
        "stage_errors": {
          "storage_error": 2.082351693388773e-05,
          "matmul1_error": 1.0681813426960677e-09,
          "softmax_error": 6.800197297707201e-07,
          "matmul2_error": 7.081257535901386e-07,
          "demote_error": 6.8001972977072e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 6,
        "token_idx": 1,
        "token_error": 7.691312930546701e-06,
        "entropy_ref": 0.6931158304214478,
        "max_attention_weight_ref": 0.5039563179016113,
        "attention_weight_error": 1.5497207641601562e-06,
        "stage_errors": {
          "storage_error": 2.2405298295780085e-05,
          "matmul1_error": 1.3374485599688467e-09,
          "softmax_error": 8.517563401255757e-07,
          "matmul2_error": 6.948258032934973e-07,
          "demote_error": 8.517563401255757e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 5,
        "token_idx": 1,
        "token_error": 7.5316424954507966e-06,
        "entropy_ref": 0.6931049823760986,
        "max_attention_weight_ref": 0.504594087600708,
        "attention_weight_error": 1.8775463104248047e-06,
        "stage_errors": {
          "storage_error": 1.9465085642877966e-05,
          "matmul1_error": 8.886360691810159e-10,
          "softmax_error": 5.698988388758153e-07,
          "matmul2_error": 6.874955488456181e-07,
          "demote_error": 5.698988388758153e-08
        }
      }
    ],
    "head_analysis": [
      {
        "head_idx": 0,
        "avg_error": 1.7602226307644742e-06,
        "avg_entropy": 3.8781614303588867,
        "avg_max_weight": 0.04287587106227875,
        "sparsity": 0.69488525390625
      },
      {
        "head_idx": 1,
        "avg_error": 1.7899556041811593e-06,
        "avg_entropy": 3.878161668777466,
        "avg_max_weight": 0.04286624491214752,
        "sparsity": 0.6947021484375
      },
      {
        "head_idx": 2,
        "avg_error": 1.7805273273552302e-06,
        "avg_entropy": 3.878162145614624,
        "avg_max_weight": 0.042836565524339676,
        "sparsity": 0.69488525390625
      },
      {
        "head_idx": 3,
        "avg_error": 1.854515517152322e-06,
        "avg_entropy": 3.878161668777466,
        "avg_max_weight": 0.04285350814461708,
        "sparsity": 0.69476318359375
      },
      {
        "head_idx": 4,
        "avg_error": 1.6367071111744735e-06,
        "avg_entropy": 3.8781609535217285,
        "avg_max_weight": 0.04288738965988159,
        "sparsity": 0.6949462890625
      },
      {
        "head_idx": 5,
        "avg_error": 1.6541878267162247e-06,
        "avg_entropy": 3.878161907196045,
        "avg_max_weight": 0.0428616888821125,
        "sparsity": 0.694580078125
      },
      {
        "head_idx": 6,
        "avg_error": 1.8807787682817434e-06,
        "avg_entropy": 3.878161668777466,
        "avg_max_weight": 0.042863279581069946,
        "sparsity": 0.69482421875
      },
      {
        "head_idx": 7,
        "avg_error": 1.7771059219739982e-06,
        "avg_entropy": 3.8781614303588867,
        "avg_max_weight": 0.04287642613053322,
        "sparsity": 0.69476318359375
      }
    ]
  }
}
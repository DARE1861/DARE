{
  "detector": {
    "detected_exceeded": false,
    "actual_err": 5.463510751724243e-05,
    "predicted_bound": 0.00013909409026382493,
    "elapsed_sec": 2.888219118118286
  },
  "analyzer_report": {
    "component_estimates": {
      "input_storage_error": 5.201995372772217e-05,
      "matmul1_accumulation_error": 5.201995372772217e-05,
      "scaling_error": 5.201995372772217e-05,
      "softmax_numerical_error": 5.201995372772217e-05,
      "matmul2_accumulation_error": 5.201995372772217e-05,
      "output_demote_error": 8.171796798706055e-05
    },
    "component_ratios": {
      "input_storage_error": 0.15218623305287937,
      "matmul1_accumulation_error": 0.15218623305287937,
      "scaling_error": 0.15218623305287937,
      "softmax_numerical_error": 0.15218623305287937,
      "matmul2_accumulation_error": 0.15218623305287937,
      "output_demote_error": 0.23906883473560311
    },
    "primary_source": "storage_error",
    "suggestion": "\u4e3b\u8981\u8bef\u5dee\u6765\u6e90\u4e3a\u8f93\u5165\u5b58\u50a8\u7cbe\u5ea6\u3002\u5efa\u8bae\uff1a\u63d0\u5347Q/K/V\u7684\u5b58\u50a8\u7cbe\u5ea6\uff1b\u8fdb\u884c\u8f93\u5165\u5f52\u4e00\u5316\uff1b\u68c0\u67e5embedding\u5c42\u7684\u8f93\u51fa\u8303\u56f4\u3002 \u68c0\u6d4b\u5230\u5927\u91cf\u5c16\u9510\u7684attention\u6a21\u5f0f\uff08\u4f4e\u71b5\uff09\uff0c\u8fd9\u4f1a\u653e\u5927softmax\u7684\u6570\u503c\u8bef\u5dee\u3002\u8003\u8651\u4f7f\u7528attention dropout\u6216\u6e29\u5ea6\u7f29\u653e\u3002",
    "attention_pattern_stats": {
      "global_avg_entropy": 3.878161907196045,
      "global_sparsity": 0.6947555541992188,
      "max_attention_weight": 1.0,
      "min_attention_weight": 0.0
    },
    "attention_behavior_stats": {
      "high_entropy_tokens": 0,
      "low_entropy_tokens": 6,
      "total_analyzed": 8
    },
    "top_tokens_summary": [
      {
        "batch_idx": 0,
        "head_idx": 5,
        "token_idx": 1,
        "token_error": 9.250808943761513e-06,
        "entropy_ref": 0.6930872201919556,
        "max_attention_weight_ref": 0.5054728984832764,
        "attention_weight_error": 1.341104507446289e-06,
        "stage_errors": {
          "storage_error": 2.1231683604128193e-05,
          "matmul1_error": 1.1379597060616573e-09,
          "softmax_error": 7.10110180079937e-07,
          "matmul2_error": 7.048414772725664e-07,
          "demote_error": 7.10110180079937e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 5,
        "token_idx": 0,
        "token_error": 8.514805813319981e-06,
        "entropy_ref": -0.0,
        "max_attention_weight_ref": 1.0,
        "attention_weight_error": 0.0,
        "stage_errors": {
          "storage_error": 1.904146029119147e-05,
          "matmul1_error": 7.869739087423884e-10,
          "softmax_error": 4.910878487862647e-07,
          "matmul2_error": 7.048414772725664e-07,
          "demote_error": 4.9108784878626466e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 1,
        "token_idx": 1,
        "token_error": 8.107514986477327e-06,
        "entropy_ref": 0.6931178569793701,
        "max_attention_weight_ref": 0.5038273334503174,
        "attention_weight_error": 7.152557373046875e-07,
        "stage_errors": {
          "storage_error": 2.030655014095828e-05,
          "matmul1_error": 9.876885262761849e-10,
          "softmax_error": 6.00411294726655e-07,
          "matmul2_error": 7.032407665974461e-07,
          "demote_error": 6.004112947266549e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 1,
        "token_idx": 0,
        "token_error": 8.016082574613392e-06,
        "entropy_ref": -0.0,
        "max_attention_weight_ref": 1.0,
        "attention_weight_error": 0.0,
        "stage_errors": {
          "storage_error": 1.9869054085575044e-05,
          "matmul1_error": 9.157195546748371e-10,
          "softmax_error": 5.566616891883314e-07,
          "matmul2_error": 7.032407665974461e-07,
          "demote_error": 5.5666168918833135e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 2,
        "token_idx": 1,
        "token_error": 7.4187846621498466e-06,
        "entropy_ref": 0.6930978298187256,
        "max_attention_weight_ref": 0.5049640536308289,
        "attention_weight_error": 1.5497207641601562e-06,
        "stage_errors": {
          "storage_error": 2.2041556803742424e-05,
          "matmul1_error": 1.2560699009688212e-09,
          "softmax_error": 7.89572368375957e-07,
          "matmul2_error": 7.115322205208941e-07,
          "demote_error": 7.895723683759571e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 6,
        "token_idx": 1,
        "token_error": 7.129150617402047e-06,
        "entropy_ref": 0.6931287050247192,
        "max_attention_weight_ref": 0.5030437111854553,
        "attention_weight_error": 3.5762786865234375e-07,
        "stage_errors": {
          "storage_error": 2.132218378392281e-05,
          "matmul1_error": 1.1274738302834026e-09,
          "softmax_error": 7.253518560901285e-07,
          "matmul2_error": 7.199202627816704e-07,
          "demote_error": 7.253518560901284e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 7,
        "token_idx": 2,
        "token_error": 6.943702828721143e-06,
        "entropy_ref": 1.098587989807129,
        "max_attention_weight_ref": 0.336388498544693,
        "attention_weight_error": 1.0132789611816406e-06,
        "stage_errors": {
          "storage_error": 2.0753326680278406e-05,
          "matmul1_error": 1.0751517268870923e-09,
          "softmax_error": 6.794497494411189e-07,
          "matmul2_error": 6.965605280129239e-07,
          "demote_error": 6.79449749441119e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 0,
        "token_idx": 2,
        "token_error": 6.829563062638044e-06,
        "entropy_ref": 1.0985862016677856,
        "max_attention_weight_ref": 0.3367133140563965,
        "attention_weight_error": 4.76837158203125e-07,
        "stage_errors": {
          "storage_error": 2.305050929862773e-05,
          "matmul1_error": 1.4219594294085095e-09,
          "softmax_error": 9.050912922248244e-07,
          "matmul2_error": 7.056393769744319e-07,
          "demote_error": 9.050912922248244e-08
        }
      }
    ],
    "head_analysis": [
      {
        "head_idx": 0,
        "avg_error": 1.7400955130142393e-06,
        "avg_entropy": 3.878161668777466,
        "avg_max_weight": 0.0428689643740654,
        "sparsity": 0.69476318359375
      },
      {
        "head_idx": 1,
        "avg_error": 1.9004799014510354e-06,
        "avg_entropy": 3.878161668777466,
        "avg_max_weight": 0.04288259893655777,
        "sparsity": 0.69464111328125
      },
      {
        "head_idx": 2,
        "avg_error": 1.7285427702518064e-06,
        "avg_entropy": 3.878162145614624,
        "avg_max_weight": 0.04285315424203873,
        "sparsity": 0.69500732421875
      },
      {
        "head_idx": 3,
        "avg_error": 1.845763904384512e-06,
        "avg_entropy": 3.878161668777466,
        "avg_max_weight": 0.04287591576576233,
        "sparsity": 0.69451904296875
      },
      {
        "head_idx": 4,
        "avg_error": 1.7598222257220186e-06,
        "avg_entropy": 3.878161907196045,
        "avg_max_weight": 0.04285838454961777,
        "sparsity": 0.69488525390625
      },
      {
        "head_idx": 5,
        "avg_error": 1.7950947039935272e-06,
        "avg_entropy": 3.8781614303588867,
        "avg_max_weight": 0.042883992195129395,
        "sparsity": 0.69500732421875
      },
      {
        "head_idx": 6,
        "avg_error": 1.8206973209089483e-06,
        "avg_entropy": 3.878162145614624,
        "avg_max_weight": 0.04284927621483803,
        "sparsity": 0.6944580078125
      },
      {
        "head_idx": 7,
        "avg_error": 1.8172989939557738e-06,
        "avg_entropy": 3.878161907196045,
        "avg_max_weight": 0.04286087304353714,
        "sparsity": 0.69476318359375
      }
    ]
  }
}
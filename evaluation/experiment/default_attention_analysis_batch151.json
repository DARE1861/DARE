{
  "detector": {
    "detected_exceeded": false,
    "actual_err": 5.879998207092285e-05,
    "predicted_bound": 0.00014882264949847015,
    "elapsed_sec": 2.973468780517578
  },
  "analyzer_report": {
    "component_estimates": {
      "input_storage_error": 5.879998207092285e-05,
      "matmul1_accumulation_error": 5.879998207092285e-05,
      "scaling_error": 5.879998207092285e-05,
      "softmax_numerical_error": 5.879998207092285e-05,
      "matmul2_accumulation_error": 5.879998207092285e-05,
      "output_demote_error": 9.494274854660034e-05
    },
    "component_ratios": {
      "input_storage_error": 0.15117905101239393,
      "matmul1_accumulation_error": 0.15117905101239393,
      "scaling_error": 0.15117905101239393,
      "softmax_numerical_error": 0.15117905101239393,
      "matmul2_accumulation_error": 0.15117905101239393,
      "output_demote_error": 0.2441047449380304
    },
    "primary_source": "storage_error",
    "suggestion": "\u4e3b\u8981\u8bef\u5dee\u6765\u6e90\u4e3a\u8f93\u5165\u5b58\u50a8\u7cbe\u5ea6\u3002\u5efa\u8bae\uff1a\u63d0\u5347Q/K/V\u7684\u5b58\u50a8\u7cbe\u5ea6\uff1b\u8fdb\u884c\u8f93\u5165\u5f52\u4e00\u5316\uff1b\u68c0\u67e5embedding\u5c42\u7684\u8f93\u51fa\u8303\u56f4\u3002 \u68c0\u6d4b\u5230\u5927\u91cf\u5c16\u9510\u7684attention\u6a21\u5f0f\uff08\u4f4e\u71b5\uff09\uff0c\u8fd9\u4f1a\u653e\u5927softmax\u7684\u6570\u503c\u8bef\u5dee\u3002\u8003\u8651\u4f7f\u7528attention dropout\u6216\u6e29\u5ea6\u7f29\u653e\u3002",
    "attention_pattern_stats": {
      "global_avg_entropy": 3.878162145614624,
      "global_sparsity": 0.69482421875,
      "max_attention_weight": 1.0,
      "min_attention_weight": 0.0
    },
    "attention_behavior_stats": {
      "high_entropy_tokens": 0,
      "low_entropy_tokens": 7,
      "total_analyzed": 8
    },
    "top_tokens_summary": [
      {
        "batch_idx": 0,
        "head_idx": 6,
        "token_idx": 0,
        "token_error": 1.0936979379039258e-05,
        "entropy_ref": -0.0,
        "max_attention_weight_ref": 1.0,
        "attention_weight_error": 0.0,
        "stage_errors": {
          "storage_error": 2.0752422642544843e-05,
          "matmul1_error": 1.0794686453560895e-09,
          "softmax_error": 6.822792784078047e-07,
          "matmul2_error": 6.937445505172946e-07,
          "demote_error": 6.822792784078047e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 1,
        "token_idx": 1,
        "token_error": 9.911671440931968e-06,
        "entropy_ref": 0.6931196451187134,
        "max_attention_weight_ref": 0.503711998462677,
        "attention_weight_error": 4.76837158203125e-07,
        "stage_errors": {
          "storage_error": 1.9844604139507283e-05,
          "matmul1_error": 9.036726686413613e-10,
          "softmax_error": 5.885187420062721e-07,
          "matmul2_error": 7.173385256464826e-07,
          "demote_error": 5.885187420062721e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 6,
        "token_idx": 1,
        "token_error": 9.805644367588684e-06,
        "entropy_ref": 0.6931205987930298,
        "max_attention_weight_ref": 0.5036472678184509,
        "attention_weight_error": 2.682209014892578e-07,
        "stage_errors": {
          "storage_error": 1.8675658793654293e-05,
          "matmul1_error": 7.508933053695166e-10,
          "softmax_error": 4.7460289351874965e-07,
          "matmul2_error": 6.937445505172946e-07,
          "demote_error": 4.746028935187496e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 3,
        "token_idx": 0,
        "token_error": 9.353396308142692e-06,
        "entropy_ref": -0.0,
        "max_attention_weight_ref": 1.0,
        "attention_weight_error": 0.0,
        "stage_errors": {
          "storage_error": 2.258403173982515e-05,
          "matmul1_error": 1.3608078035709944e-09,
          "softmax_error": 8.584560418967158e-07,
          "matmul2_error": 6.99389693181729e-07,
          "demote_error": 8.584560418967158e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 7,
        "token_idx": 1,
        "token_error": 8.945251465775073e-06,
        "entropy_ref": 0.6931276321411133,
        "max_attention_weight_ref": 0.503127932548523,
        "attention_weight_error": 2.086162567138672e-07,
        "stage_errors": {
          "storage_error": 1.9760917439270997e-05,
          "matmul1_error": 9.154328810036274e-10,
          "softmax_error": 5.801277438877151e-07,
          "matmul2_error": 6.985865638853284e-07,
          "demote_error": 5.8012774388771505e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 6,
        "token_idx": 2,
        "token_error": 8.64735193317756e-06,
        "entropy_ref": 1.0985878705978394,
        "max_attention_weight_ref": 0.33657464385032654,
        "attention_weight_error": 6.258487701416016e-07,
        "stage_errors": {
          "storage_error": 2.3856946427258663e-05,
          "matmul1_error": 1.5706510966510155e-09,
          "softmax_error": 9.927316568791866e-07,
          "matmul2_error": 6.937445505172946e-07,
          "demote_error": 9.927316568791866e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 2,
        "token_idx": 1,
        "token_error": 8.540699127479456e-06,
        "entropy_ref": 0.6930990219116211,
        "max_attention_weight_ref": 0.5049097537994385,
        "attention_weight_error": 8.344650268554688e-07,
        "stage_errors": {
          "storage_error": 2.2942302166484296e-05,
          "matmul1_error": 1.4140822341958798e-09,
          "softmax_error": 8.80636798683554e-07,
          "matmul2_error": 7.039456249913201e-07,
          "demote_error": 8.80636798683554e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 1,
        "token_idx": 0,
        "token_error": 8.305236406158656e-06,
        "entropy_ref": -0.0,
        "max_attention_weight_ref": 1.0,
        "attention_weight_error": 0.0,
        "stage_errors": {
          "storage_error": 1.9859112398989964e-05,
          "matmul1_error": 9.059004171612066e-10,
          "softmax_error": 5.899695679545403e-07,
          "matmul2_error": 7.173385256464826e-07,
          "demote_error": 5.899695679545403e-08
        }
      }
    ],
    "head_analysis": [
      {
        "head_idx": 0,
        "avg_error": 1.7593498569112853e-06,
        "avg_entropy": 3.878161668777466,
        "avg_max_weight": 0.04287845641374588,
        "sparsity": 0.69476318359375
      },
      {
        "head_idx": 1,
        "avg_error": 1.990599685086636e-06,
        "avg_entropy": 3.878161668777466,
        "avg_max_weight": 0.04286746308207512,
        "sparsity": 0.69488525390625
      },
      {
        "head_idx": 2,
        "avg_error": 1.8146115507988725e-06,
        "avg_entropy": 3.8781611919403076,
        "avg_max_weight": 0.04288589954376221,
        "sparsity": 0.69464111328125
      },
      {
        "head_idx": 3,
        "avg_error": 1.8661473859538091e-06,
        "avg_entropy": 3.878161907196045,
        "avg_max_weight": 0.042867597192525864,
        "sparsity": 0.69512939453125
      },
      {
        "head_idx": 4,
        "avg_error": 1.9485341908875853e-06,
        "avg_entropy": 3.878161907196045,
        "avg_max_weight": 0.04286520928144455,
        "sparsity": 0.6947021484375
      },
      {
        "head_idx": 5,
        "avg_error": 1.6183664683921961e-06,
        "avg_entropy": 3.878161907196045,
        "avg_max_weight": 0.042850665748119354,
        "sparsity": 0.69482421875
      },
      {
        "head_idx": 6,
        "avg_error": 2.248874352517305e-06,
        "avg_entropy": 3.878162145614624,
        "avg_max_weight": 0.04285862669348717,
        "sparsity": 0.69482421875
      },
      {
        "head_idx": 7,
        "avg_error": 1.8141158761864062e-06,
        "avg_entropy": 3.878162145614624,
        "avg_max_weight": 0.04284524545073509,
        "sparsity": 0.69482421875
      }
    ]
  }
}
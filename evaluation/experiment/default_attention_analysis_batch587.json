{
  "detector": {
    "detected_exceeded": false,
    "actual_err": 5.108863115310669e-05,
    "predicted_bound": 0.00010572907704045066,
    "elapsed_sec": 3.045398712158203
  },
  "analyzer_report": {
    "component_estimates": {
      "input_storage_error": 3.4827739000320435e-05,
      "matmul1_accumulation_error": 3.4827739000320435e-05,
      "scaling_error": 3.4827739000320435e-05,
      "softmax_numerical_error": 3.4827739000320435e-05,
      "matmul2_accumulation_error": 3.4827739000320435e-05,
      "output_demote_error": 7.151812314987183e-05
    },
    "component_ratios": {
      "input_storage_error": 0.14177395629558862,
      "matmul1_accumulation_error": 0.14177395629558862,
      "scaling_error": 0.14177395629558862,
      "softmax_numerical_error": 0.14177395629558862,
      "matmul2_accumulation_error": 0.14177395629558862,
      "output_demote_error": 0.29113021852205695
    },
    "primary_source": "storage_error",
    "suggestion": "\u4e3b\u8981\u8bef\u5dee\u6765\u6e90\u4e3a\u8f93\u5165\u5b58\u50a8\u7cbe\u5ea6\u3002\u5efa\u8bae\uff1a\u63d0\u5347Q/K/V\u7684\u5b58\u50a8\u7cbe\u5ea6\uff1b\u8fdb\u884c\u8f93\u5165\u5f52\u4e00\u5316\uff1b\u68c0\u67e5embedding\u5c42\u7684\u8f93\u51fa\u8303\u56f4\u3002",
    "attention_pattern_stats": {
      "global_avg_entropy": 3.878161668777466,
      "global_sparsity": 0.6949691772460938,
      "max_attention_weight": 1.0,
      "min_attention_weight": 0.0
    },
    "attention_behavior_stats": {
      "high_entropy_tokens": 0,
      "low_entropy_tokens": 4,
      "total_analyzed": 8
    },
    "top_tokens_summary": [
      {
        "batch_idx": 0,
        "head_idx": 2,
        "token_idx": 1,
        "token_error": 1.093945320462808e-05,
        "entropy_ref": 0.693123459815979,
        "max_attention_weight_ref": 0.5034440755844116,
        "attention_weight_error": 9.834766387939453e-07,
        "stage_errors": {
          "storage_error": 1.9181663901690627e-05,
          "matmul1_error": 8.24223653554112e-10,
          "softmax_error": 5.168629286345095e-07,
          "matmul2_error": 6.965540706005414e-07,
          "demote_error": 5.1686292863450945e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 0,
        "token_idx": 1,
        "token_error": 1.0580940397630911e-05,
        "entropy_ref": 0.6930753588676453,
        "max_attention_weight_ref": 0.5059927105903625,
        "attention_weight_error": 8.940696716308594e-08,
        "stage_errors": {
          "storage_error": 2.2296108909358736e-05,
          "matmul1_error": 1.3140247474603752e-09,
          "softmax_error": 8.436607458861545e-07,
          "matmul2_error": 6.976137683523121e-07,
          "demote_error": 8.436607458861544e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 0,
        "token_idx": 2,
        "token_error": 9.836612662184052e-06,
        "entropy_ref": 1.0985790491104126,
        "max_attention_weight_ref": 0.33702021837234497,
        "attention_weight_error": 6.854534149169922e-07,
        "stage_errors": {
          "storage_error": 2.0958413188054692e-05,
          "matmul1_error": 1.1056749704988941e-09,
          "softmax_error": 7.098911737557501e-07,
          "matmul2_error": 6.976137683523121e-07,
          "demote_error": 7.0989117375575e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 1,
        "token_idx": 2,
        "token_error": 7.2702878242125735e-06,
        "entropy_ref": 1.098583459854126,
        "max_attention_weight_ref": 0.3368784785270691,
        "attention_weight_error": 5.960464477539062e-07,
        "stage_errors": {
          "storage_error": 2.2226260171009926e-05,
          "matmul1_error": 1.3168558729295703e-09,
          "softmax_error": 8.279908797703684e-07,
          "matmul2_error": 6.917607606737874e-07,
          "demote_error": 8.279908797703683e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 6,
        "token_idx": 0,
        "token_error": 6.9746511144330725e-06,
        "entropy_ref": -0.0,
        "max_attention_weight_ref": 1.0,
        "attention_weight_error": 0.0,
        "stage_errors": {
          "storage_error": 2.0406744624779094e-05,
          "matmul1_error": 1.0283863514413608e-09,
          "softmax_error": 6.376838427968324e-07,
          "matmul2_error": 6.902756013005274e-07,
          "demote_error": 6.376838427968323e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 7,
        "token_idx": 2,
        "token_error": 6.882998604851309e-06,
        "entropy_ref": 1.098541498184204,
        "max_attention_weight_ref": 0.33895325660705566,
        "attention_weight_error": 3.8743019104003906e-07,
        "stage_errors": {
          "storage_error": 2.1826933334523346e-05,
          "matmul1_error": 1.2441320637409888e-09,
          "softmax_error": 7.60411421651952e-07,
          "matmul2_error": 6.992077032919042e-07,
          "demote_error": 7.604114216519519e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 6,
        "token_idx": 2,
        "token_error": 6.731786015734542e-06,
        "entropy_ref": 1.0986016988754272,
        "max_attention_weight_ref": 0.3354819715023041,
        "attention_weight_error": 2.682209014892578e-07,
        "stage_errors": {
          "storage_error": 1.955268544406863e-05,
          "matmul1_error": 8.90653082096843e-10,
          "softmax_error": 5.522779247257859e-07,
          "matmul2_error": 6.902756013005274e-07,
          "demote_error": 5.5227792472578584e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 6,
        "token_idx": 1,
        "token_error": 6.6614193201530725e-06,
        "entropy_ref": 0.6930751800537109,
        "max_attention_weight_ref": 0.5059993863105774,
        "attention_weight_error": 8.046627044677734e-07,
        "stage_errors": {
          "storage_error": 2.295504691574024e-05,
          "matmul1_error": 1.439348511604816e-09,
          "softmax_error": 8.92514071892947e-07,
          "matmul2_error": 6.902756013005274e-07,
          "demote_error": 8.92514071892947e-08
        }
      }
    ],
    "head_analysis": [
      {
        "head_idx": 0,
        "avg_error": 1.7082359136111336e-06,
        "avg_entropy": 3.8781614303588867,
        "avg_max_weight": 0.04287467896938324,
        "sparsity": 0.6949462890625
      },
      {
        "head_idx": 1,
        "avg_error": 1.8380815163254738e-06,
        "avg_entropy": 3.8781614303588867,
        "avg_max_weight": 0.042862340807914734,
        "sparsity": 0.69500732421875
      },
      {
        "head_idx": 2,
        "avg_error": 1.7778738765628077e-06,
        "avg_entropy": 3.8781626224517822,
        "avg_max_weight": 0.042844999581575394,
        "sparsity": 0.695068359375
      },
      {
        "head_idx": 3,
        "avg_error": 1.8388878970654332e-06,
        "avg_entropy": 3.8781614303588867,
        "avg_max_weight": 0.04288383945822716,
        "sparsity": 0.69488525390625
      },
      {
        "head_idx": 4,
        "avg_error": 1.6343453808076447e-06,
        "avg_entropy": 3.8781609535217285,
        "avg_max_weight": 0.04290963336825371,
        "sparsity": 0.69482421875
      },
      {
        "head_idx": 5,
        "avg_error": 1.7297028307439177e-06,
        "avg_entropy": 3.878161907196045,
        "avg_max_weight": 0.04285064712166786,
        "sparsity": 0.69549560546875
      },
      {
        "head_idx": 6,
        "avg_error": 1.9220844933443004e-06,
        "avg_entropy": 3.8781614303588867,
        "avg_max_weight": 0.042883627116680145,
        "sparsity": 0.6947021484375
      },
      {
        "head_idx": 7,
        "avg_error": 1.957515451067593e-06,
        "avg_entropy": 3.8781604766845703,
        "avg_max_weight": 0.042917534708976746,
        "sparsity": 0.69482421875
      }
    ]
  }
}
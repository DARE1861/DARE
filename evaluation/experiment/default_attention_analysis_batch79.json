{
  "detector": {
    "detected_exceeded": false,
    "actual_err": 5.170702934265137e-05,
    "predicted_bound": 0.00013472695136442783,
    "elapsed_sec": 2.9382901191711426
  },
  "analyzer_report": {
    "component_estimates": {
      "input_storage_error": 5.330890417098999e-05,
      "matmul1_accumulation_error": 5.330890417098999e-05,
      "scaling_error": 5.330890417098999e-05,
      "softmax_numerical_error": 5.330890417098999e-05,
      "matmul2_accumulation_error": 5.330890417098999e-05,
      "output_demote_error": 8.538365364074707e-05
    },
    "component_ratios": {
      "input_storage_error": 0.15147665925690695,
      "matmul1_accumulation_error": 0.15147665925690695,
      "scaling_error": 0.15147665925690695,
      "softmax_numerical_error": 0.15147665925690695,
      "matmul2_accumulation_error": 0.15147665925690695,
      "output_demote_error": 0.24261670371546523
    },
    "primary_source": "storage_error",
    "suggestion": "\u4e3b\u8981\u8bef\u5dee\u6765\u6e90\u4e3a\u8f93\u5165\u5b58\u50a8\u7cbe\u5ea6\u3002\u5efa\u8bae\uff1a\u63d0\u5347Q/K/V\u7684\u5b58\u50a8\u7cbe\u5ea6\uff1b\u8fdb\u884c\u8f93\u5165\u5f52\u4e00\u5316\uff1b\u68c0\u67e5embedding\u5c42\u7684\u8f93\u51fa\u8303\u56f4\u3002 \u68c0\u6d4b\u5230\u5927\u91cf\u5c16\u9510\u7684attention\u6a21\u5f0f\uff08\u4f4e\u71b5\uff09\uff0c\u8fd9\u4f1a\u653e\u5927softmax\u7684\u6570\u503c\u8bef\u5dee\u3002\u8003\u8651\u4f7f\u7528attention dropout\u6216\u6e29\u5ea6\u7f29\u653e\u3002",
    "attention_pattern_stats": {
      "global_avg_entropy": 3.878162145614624,
      "global_sparsity": 0.6949234008789062,
      "max_attention_weight": 1.0,
      "min_attention_weight": 0.0
    },
    "attention_behavior_stats": {
      "high_entropy_tokens": 0,
      "low_entropy_tokens": 7,
      "total_analyzed": 8
    },
    "top_tokens_summary": [
      {
        "batch_idx": 0,
        "head_idx": 3,
        "token_idx": 0,
        "token_error": 1.1569940397748724e-05,
        "entropy_ref": -0.0,
        "max_attention_weight_ref": 1.0,
        "attention_weight_error": 0.0,
        "stage_errors": {
          "storage_error": 1.9420132048253436e-05,
          "matmul1_error": 8.200959593741119e-10,
          "softmax_error": 5.095672349852975e-07,
          "matmul2_error": 7.211862794065383e-07,
          "demote_error": 5.0956723498529756e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 1,
        "token_idx": 1,
        "token_error": 9.437681001145393e-06,
        "entropy_ref": 0.6931195855140686,
        "max_attention_weight_ref": 0.5037145614624023,
        "attention_weight_error": 6.556510925292969e-07,
        "stage_errors": {
          "storage_error": 2.0502822735579684e-05,
          "matmul1_error": 1.0181943863506194e-09,
          "softmax_error": 6.309150194283575e-07,
          "matmul2_error": 7.061450560286176e-07,
          "demote_error": 6.309150194283575e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 3,
        "token_idx": 1,
        "token_error": 9.292121831094846e-06,
        "entropy_ref": 0.6931389570236206,
        "max_attention_weight_ref": 0.5020239353179932,
        "attention_weight_error": 5.960464477539063e-08,
        "stage_errors": {
          "storage_error": 1.968827382370364e-05,
          "matmul1_error": 8.632506152248668e-10,
          "softmax_error": 5.363814125303179e-07,
          "matmul2_error": 7.211862794065383e-07,
          "demote_error": 5.363814125303179e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 1,
        "token_idx": 0,
        "token_error": 8.79544131748844e-06,
        "entropy_ref": -0.0,
        "max_attention_weight_ref": 1.0,
        "attention_weight_error": 0.0,
        "stage_errors": {
          "storage_error": 1.9274539226898924e-05,
          "matmul1_error": 8.199693742849799e-10,
          "softmax_error": 5.080866685602815e-07,
          "matmul2_error": 7.061450560286176e-07,
          "demote_error": 5.080866685602814e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 3,
        "token_idx": 2,
        "token_error": 7.900249329395592e-06,
        "entropy_ref": 1.0985363721847534,
        "max_attention_weight_ref": 0.3391382396221161,
        "attention_weight_error": 5.364418029785156e-07,
        "stage_errors": {
          "storage_error": 2.3655889890505932e-05,
          "matmul1_error": 1.5017975392291642e-09,
          "softmax_error": 9.331430192105473e-07,
          "matmul2_error": 7.211862794065383e-07,
          "demote_error": 9.331430192105472e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 6,
        "token_idx": 1,
        "token_error": 7.758821084280498e-06,
        "entropy_ref": 0.6931270360946655,
        "max_attention_weight_ref": 0.5031754374504089,
        "attention_weight_error": 2.682209014892578e-07,
        "stage_errors": {
          "storage_error": 2.173212942579994e-05,
          "matmul1_error": 1.2183130899137116e-09,
          "softmax_error": 7.75173248257488e-07,
          "matmul2_error": 7.034550890239189e-07,
          "demote_error": 7.75173248257488e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 2,
        "token_idx": 0,
        "token_error": 7.69264079281129e-06,
        "entropy_ref": -0.0,
        "max_attention_weight_ref": 1.0,
        "attention_weight_error": 0.0,
        "stage_errors": {
          "storage_error": 2.079046453218325e-05,
          "matmul1_error": 1.0740434505277489e-09,
          "softmax_error": 6.759335519745946e-07,
          "matmul2_error": 7.008772627159488e-07,
          "demote_error": 6.759335519745947e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 7,
        "token_idx": 0,
        "token_error": 7.663034921279177e-06,
        "entropy_ref": -0.0,
        "max_attention_weight_ref": 1.0,
        "attention_weight_error": 0.0,
        "stage_errors": {
          "storage_error": 1.980142906177207e-05,
          "matmul1_error": 9.273192800601569e-10,
          "softmax_error": 6.112561095505953e-07,
          "matmul2_error": 6.984295396250673e-07,
          "demote_error": 6.112561095505953e-08
        }
      }
    ],
    "head_analysis": [
      {
        "head_idx": 0,
        "avg_error": 1.7446252513764193e-06,
        "avg_entropy": 3.8781614303588867,
        "avg_max_weight": 0.04285997152328491,
        "sparsity": 0.69500732421875
      },
      {
        "head_idx": 1,
        "avg_error": 1.964471039173077e-06,
        "avg_entropy": 3.878161668777466,
        "avg_max_weight": 0.042870961129665375,
        "sparsity": 0.6953125
      },
      {
        "head_idx": 2,
        "avg_error": 1.9458627775748027e-06,
        "avg_entropy": 3.878161907196045,
        "avg_max_weight": 0.04286767169833183,
        "sparsity": 0.69476318359375
      },
      {
        "head_idx": 3,
        "avg_error": 1.8350874597672373e-06,
        "avg_entropy": 3.8781611919403076,
        "avg_max_weight": 0.042886242270469666,
        "sparsity": 0.695068359375
      },
      {
        "head_idx": 4,
        "avg_error": 1.754161530698184e-06,
        "avg_entropy": 3.8781611919403076,
        "avg_max_weight": 0.042877569794654846,
        "sparsity": 0.69451904296875
      },
      {
        "head_idx": 5,
        "avg_error": 1.6507782447661157e-06,
        "avg_entropy": 3.878162145614624,
        "avg_max_weight": 0.04285344108939171,
        "sparsity": 0.69482421875
      },
      {
        "head_idx": 6,
        "avg_error": 1.706280841062835e-06,
        "avg_entropy": 3.8781614303588867,
        "avg_max_weight": 0.042867694050073624,
        "sparsity": 0.69488525390625
      },
      {
        "head_idx": 7,
        "avg_error": 1.9459889699646737e-06,
        "avg_entropy": 3.878162145614624,
        "avg_max_weight": 0.04284217953681946,
        "sparsity": 0.69500732421875
      }
    ]
  }
}
{
  "detector": {
    "detected_exceeded": false,
    "actual_err": 3.363192081451416e-05,
    "predicted_bound": 0.00010604019116726704,
    "elapsed_sec": 3.0165650844573975
  },
  "analyzer_report": {
    "component_estimates": {
      "input_storage_error": 4.3064355850219727e-05,
      "matmul1_accumulation_error": 4.3064355850219727e-05,
      "scaling_error": 4.3064355850219727e-05,
      "softmax_numerical_error": 4.3064355850219727e-05,
      "matmul2_accumulation_error": 4.3064355850219727e-05,
      "output_demote_error": 7.27921724319458e-05
    },
    "component_ratios": {
      "input_storage_error": 0.14946987328678563,
      "matmul1_accumulation_error": 0.14946987328678563,
      "scaling_error": 0.14946987328678563,
      "softmax_numerical_error": 0.14946987328678563,
      "matmul2_accumulation_error": 0.14946987328678563,
      "output_demote_error": 0.25265063356607187
    },
    "primary_source": "storage_error",
    "suggestion": "\u4e3b\u8981\u8bef\u5dee\u6765\u6e90\u4e3a\u8f93\u5165\u5b58\u50a8\u7cbe\u5ea6\u3002\u5efa\u8bae\uff1a\u63d0\u5347Q/K/V\u7684\u5b58\u50a8\u7cbe\u5ea6\uff1b\u8fdb\u884c\u8f93\u5165\u5f52\u4e00\u5316\uff1b\u68c0\u67e5embedding\u5c42\u7684\u8f93\u51fa\u8303\u56f4\u3002 \u68c0\u6d4b\u5230\u5927\u91cf\u5c16\u9510\u7684attention\u6a21\u5f0f\uff08\u4f4e\u71b5\uff09\uff0c\u8fd9\u4f1a\u653e\u5927softmax\u7684\u6570\u503c\u8bef\u5dee\u3002\u8003\u8651\u4f7f\u7528attention dropout\u6216\u6e29\u5ea6\u7f29\u653e\u3002",
    "attention_pattern_stats": {
      "global_avg_entropy": 3.878161907196045,
      "global_sparsity": 0.6949310302734375,
      "max_attention_weight": 1.0,
      "min_attention_weight": 0.0
    },
    "attention_behavior_stats": {
      "high_entropy_tokens": 0,
      "low_entropy_tokens": 6,
      "total_analyzed": 8
    },
    "top_tokens_summary": [
      {
        "batch_idx": 0,
        "head_idx": 1,
        "token_idx": 1,
        "token_error": 9.654531822889112e-06,
        "entropy_ref": 0.6931313872337341,
        "max_attention_weight_ref": 0.5028072595596313,
        "attention_weight_error": 1.6093254089355469e-06,
        "stage_errors": {
          "storage_error": 1.9994778540421976e-05,
          "matmul1_error": 9.507525699002699e-10,
          "softmax_error": 5.931899067945779e-07,
          "matmul2_error": 6.97952827977133e-07,
          "demote_error": 5.931899067945778e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 1,
        "token_idx": 0,
        "token_error": 8.268396413768642e-06,
        "entropy_ref": -0.0,
        "max_attention_weight_ref": 1.0,
        "attention_weight_error": 0.0,
        "stage_errors": {
          "storage_error": 2.3647556645300938e-05,
          "matmul1_error": 1.536212324139105e-09,
          "softmax_error": 9.584677172824742e-07,
          "matmul2_error": 6.97952827977133e-07,
          "demote_error": 9.58467717282474e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 2,
        "token_idx": 0,
        "token_error": 7.310496584977955e-06,
        "entropy_ref": -0.0,
        "max_attention_weight_ref": 1.0,
        "attention_weight_error": 0.0,
        "stage_errors": {
          "storage_error": 2.400202856733813e-05,
          "matmul1_error": 1.6022499058016698e-09,
          "softmax_error": 1.0122857929673046e-06,
          "matmul2_error": 6.884099548187805e-07,
          "demote_error": 1.0122857929673046e-07
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 6,
        "token_idx": 0,
        "token_error": 7.190865289885551e-06,
        "entropy_ref": -0.0,
        "max_attention_weight_ref": 1.0,
        "attention_weight_error": 0.0,
        "stage_errors": {
          "storage_error": 1.9484979475237196e-05,
          "matmul1_error": 8.972899665553607e-10,
          "softmax_error": 5.668924131896347e-07,
          "matmul2_error": 6.820902854087763e-07,
          "demote_error": 5.668924131896347e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 6,
        "token_idx": 1,
        "token_error": 7.119399015209638e-06,
        "entropy_ref": 0.6931320428848267,
        "max_attention_weight_ref": 0.5027465224266052,
        "attention_weight_error": 5.960464477539063e-08,
        "stage_errors": {
          "storage_error": 1.9761451312660938e-05,
          "matmul1_error": 9.410505461615765e-10,
          "softmax_error": 5.945395969320089e-07,
          "matmul2_error": 6.820902854087763e-07,
          "demote_error": 5.9453959693200886e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 2,
        "token_idx": 2,
        "token_error": 6.978174496907741e-06,
        "entropy_ref": 1.0986026525497437,
        "max_attention_weight_ref": 0.3354029953479767,
        "attention_weight_error": 8.046627044677734e-07,
        "stage_errors": {
          "storage_error": 2.15439699786657e-05,
          "matmul1_error": 1.213187432583438e-09,
          "softmax_error": 7.664799341000617e-07,
          "matmul2_error": 6.884099548187805e-07,
          "demote_error": 7.664799341000617e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 2,
        "token_idx": 3,
        "token_error": 6.811824277974665e-06,
        "entropy_ref": 1.3862848281860352,
        "max_attention_weight_ref": 0.2517360746860504,
        "attention_weight_error": 5.960464477539062e-07,
        "stage_errors": {
          "storage_error": 1.9763455838983646e-05,
          "matmul1_error": 9.31366959313568e-10,
          "softmax_error": 5.884285201318562e-07,
          "matmul2_error": 6.884099548187805e-07,
          "demote_error": 5.884285201318562e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 4,
        "token_idx": 1,
        "token_error": 6.758746167179197e-06,
        "entropy_ref": 0.6931021213531494,
        "max_attention_weight_ref": 0.5047489404678345,
        "attention_weight_error": 9.834766387939453e-07,
        "stage_errors": {
          "storage_error": 2.187002110076719e-05,
          "matmul1_error": 1.2310136008312687e-09,
          "softmax_error": 7.707683835178614e-07,
          "matmul2_error": 7.10397443981492e-07,
          "demote_error": 7.707683835178614e-08
        }
      }
    ],
    "head_analysis": [
      {
        "head_idx": 0,
        "avg_error": 1.6392297084166785e-06,
        "avg_entropy": 3.878161668777466,
        "avg_max_weight": 0.042863957583904266,
        "sparsity": 0.6951904296875
      },
      {
        "head_idx": 1,
        "avg_error": 1.906388547467941e-06,
        "avg_entropy": 3.878161668777466,
        "avg_max_weight": 0.04285933077335358,
        "sparsity": 0.69500732421875
      },
      {
        "head_idx": 2,
        "avg_error": 1.8112131101588602e-06,
        "avg_entropy": 3.878161907196045,
        "avg_max_weight": 0.042845718562603,
        "sparsity": 0.69476318359375
      },
      {
        "head_idx": 3,
        "avg_error": 1.7937400116352364e-06,
        "avg_entropy": 3.8781607151031494,
        "avg_max_weight": 0.042892955243587494,
        "sparsity": 0.69476318359375
      },
      {
        "head_idx": 4,
        "avg_error": 1.7961011735678767e-06,
        "avg_entropy": 3.878162145614624,
        "avg_max_weight": 0.042855098843574524,
        "sparsity": 0.6949462890625
      },
      {
        "head_idx": 5,
        "avg_error": 1.805635974960751e-06,
        "avg_entropy": 3.878161907196045,
        "avg_max_weight": 0.042860761284828186,
        "sparsity": 0.69500732421875
      },
      {
        "head_idx": 6,
        "avg_error": 1.7477271967436536e-06,
        "avg_entropy": 3.878161907196045,
        "avg_max_weight": 0.0428469143807888,
        "sparsity": 0.6949462890625
      },
      {
        "head_idx": 7,
        "avg_error": 1.7442955595470266e-06,
        "avg_entropy": 3.878161668777466,
        "avg_max_weight": 0.042882416397333145,
        "sparsity": 0.69482421875
      }
    ]
  }
}
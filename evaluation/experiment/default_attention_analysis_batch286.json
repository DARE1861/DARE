{
  "detector": {
    "detected_exceeded": false,
    "actual_err": 5.5536627769470215e-05,
    "predicted_bound": 0.00013298236081027426,
    "elapsed_sec": 2.9121124744415283
  },
  "analyzer_report": {
    "component_estimates": {
      "input_storage_error": 5.5536627769470215e-05,
      "matmul1_accumulation_error": 5.5536627769470215e-05,
      "scaling_error": 5.5536627769470215e-05,
      "softmax_numerical_error": 5.5536627769470215e-05,
      "matmul2_accumulation_error": 5.5536627769470215e-05,
      "output_demote_error": 7.775425910949707e-05
    },
    "component_ratios": {
      "input_storage_error": 0.15624868989225674,
      "matmul1_accumulation_error": 0.15624868989225674,
      "scaling_error": 0.15624868989225674,
      "softmax_numerical_error": 0.15624868989225674,
      "matmul2_accumulation_error": 0.15624868989225674,
      "output_demote_error": 0.21875655053871632
    },
    "primary_source": "storage_error",
    "suggestion": "\u4e3b\u8981\u8bef\u5dee\u6765\u6e90\u4e3a\u8f93\u5165\u5b58\u50a8\u7cbe\u5ea6\u3002\u5efa\u8bae\uff1a\u63d0\u5347Q/K/V\u7684\u5b58\u50a8\u7cbe\u5ea6\uff1b\u8fdb\u884c\u8f93\u5165\u5f52\u4e00\u5316\uff1b\u68c0\u67e5embedding\u5c42\u7684\u8f93\u51fa\u8303\u56f4\u3002 \u68c0\u6d4b\u5230\u5927\u91cf\u5c16\u9510\u7684attention\u6a21\u5f0f\uff08\u4f4e\u71b5\uff09\uff0c\u8fd9\u4f1a\u653e\u5927softmax\u7684\u6570\u503c\u8bef\u5dee\u3002\u8003\u8651\u4f7f\u7528attention dropout\u6216\u6e29\u5ea6\u7f29\u653e\u3002",
    "attention_pattern_stats": {
      "global_avg_entropy": 3.878161668777466,
      "global_sparsity": 0.6948394775390625,
      "max_attention_weight": 1.0,
      "min_attention_weight": 0.0
    },
    "attention_behavior_stats": {
      "high_entropy_tokens": 0,
      "low_entropy_tokens": 7,
      "total_analyzed": 8
    },
    "top_tokens_summary": [
      {
        "batch_idx": 0,
        "head_idx": 2,
        "token_idx": 1,
        "token_error": 8.812670785118826e-06,
        "entropy_ref": 0.6931290626525879,
        "max_attention_weight_ref": 0.5030096769332886,
        "attention_weight_error": 7.152557373046875e-07,
        "stage_errors": {
          "storage_error": 2.2719381377100945e-05,
          "matmul1_error": 1.3777273786119004e-09,
          "softmax_error": 8.750073902774603e-07,
          "matmul2_error": 7.010792160144774e-07,
          "demote_error": 8.750073902774602e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 0,
        "token_idx": 1,
        "token_error": 7.991096936166286e-06,
        "entropy_ref": 0.6931127309799194,
        "max_attention_weight_ref": 0.5041490197181702,
        "attention_weight_error": 7.152557373046875e-07,
        "stage_errors": {
          "storage_error": 2.370825995967607e-05,
          "matmul1_error": 1.5371645615828131e-09,
          "softmax_error": 9.229581337422133e-07,
          "matmul2_error": 7.118245321180439e-07,
          "demote_error": 9.229581337422133e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 2,
        "token_idx": 0,
        "token_error": 7.911114153102972e-06,
        "entropy_ref": -0.0,
        "max_attention_weight_ref": 1.0,
        "attention_weight_error": 0.0,
        "stage_errors": {
          "storage_error": 2.0890111045446247e-05,
          "matmul1_error": 1.0897028605556592e-09,
          "softmax_error": 6.920803571119905e-07,
          "matmul2_error": 7.010792160144774e-07,
          "demote_error": 6.920803571119905e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 1,
        "token_idx": 1,
        "token_error": 7.771268428768963e-06,
        "entropy_ref": 0.6931089162826538,
        "max_attention_weight_ref": 0.5043768286705017,
        "attention_weight_error": 2.980232238769531e-07,
        "stage_errors": {
          "storage_error": 2.0514284187811427e-05,
          "matmul1_error": 1.0040996860711516e-09,
          "softmax_error": 6.329224561341108e-07,
          "matmul2_error": 7.173875928856432e-07,
          "demote_error": 6.329224561341107e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 3,
        "token_idx": 1,
        "token_error": 7.630327672814019e-06,
        "entropy_ref": 0.6931298971176147,
        "max_attention_weight_ref": 0.5029374957084656,
        "attention_weight_error": 5.662441253662109e-07,
        "stage_errors": {
          "storage_error": 1.9066148070123745e-05,
          "matmul1_error": 8.111381430678281e-10,
          "softmax_error": 5.129564669914543e-07,
          "matmul2_error": 6.948157988517778e-07,
          "demote_error": 5.129564669914544e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 5,
        "token_idx": 1,
        "token_error": 7.603237463627011e-06,
        "entropy_ref": 0.6931228041648865,
        "max_attention_weight_ref": 0.5034912824630737,
        "attention_weight_error": 1.5795230865478516e-06,
        "stage_errors": {
          "storage_error": 2.0700733784906333e-05,
          "matmul1_error": 1.022915869760579e-09,
          "softmax_error": 6.433969247154892e-07,
          "matmul2_error": 7.240476406877861e-07,
          "demote_error": 6.433969247154892e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 0,
        "token_idx": 2,
        "token_error": 7.2661860031075776e-06,
        "entropy_ref": 1.0986015796661377,
        "max_attention_weight_ref": 0.33551421761512756,
        "attention_weight_error": 4.470348358154297e-07,
        "stage_errors": {
          "storage_error": 1.912956167871016e-05,
          "matmul1_error": 7.745933811172482e-10,
          "softmax_error": 4.650883056456223e-07,
          "matmul2_error": 7.118245321180439e-07,
          "demote_error": 4.650883056456223e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 1,
        "token_idx": 0,
        "token_error": 7.071298568916973e-06,
        "entropy_ref": -0.0,
        "max_attention_weight_ref": 1.0,
        "attention_weight_error": 0.0,
        "stage_errors": {
          "storage_error": 2.1712314264732413e-05,
          "matmul1_error": 1.1941611402795747e-09,
          "softmax_error": 7.527254638262093e-07,
          "matmul2_error": 7.173875928856432e-07,
          "demote_error": 7.527254638262094e-08
        }
      }
    ],
    "head_analysis": [
      {
        "head_idx": 0,
        "avg_error": 1.772498194441141e-06,
        "avg_entropy": 3.8781609535217285,
        "avg_max_weight": 0.04289696738123894,
        "sparsity": 0.69482421875
      },
      {
        "head_idx": 1,
        "avg_error": 1.8785545989885577e-06,
        "avg_entropy": 3.878162145614624,
        "avg_max_weight": 0.042848266661167145,
        "sparsity": 0.6949462890625
      },
      {
        "head_idx": 2,
        "avg_error": 1.9606225123425247e-06,
        "avg_entropy": 3.878161668777466,
        "avg_max_weight": 0.04284992441534996,
        "sparsity": 0.6944580078125
      },
      {
        "head_idx": 3,
        "avg_error": 1.803256282073562e-06,
        "avg_entropy": 3.878161668777466,
        "avg_max_weight": 0.04286818206310272,
        "sparsity": 0.6944580078125
      },
      {
        "head_idx": 4,
        "avg_error": 1.5792830936334212e-06,
        "avg_entropy": 3.8781609535217285,
        "avg_max_weight": 0.04290051385760307,
        "sparsity": 0.6949462890625
      },
      {
        "head_idx": 5,
        "avg_error": 1.9653145955089713e-06,
        "avg_entropy": 3.878161668777466,
        "avg_max_weight": 0.042861178517341614,
        "sparsity": 0.69482421875
      },
      {
        "head_idx": 6,
        "avg_error": 2.0566758394124918e-06,
        "avg_entropy": 3.878162145614624,
        "avg_max_weight": 0.04284302890300751,
        "sparsity": 0.695068359375
      },
      {
        "head_idx": 7,
        "avg_error": 1.7793685174183338e-06,
        "avg_entropy": 3.878161907196045,
        "avg_max_weight": 0.04287366569042206,
        "sparsity": 0.6951904296875
      }
    ]
  }
}
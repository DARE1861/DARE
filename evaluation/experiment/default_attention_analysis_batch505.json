{
  "detector": {
    "detected_exceeded": false,
    "actual_err": 5.482137203216553e-05,
    "predicted_bound": 0.0001541071236715652,
    "elapsed_sec": 3.051973342895508
  },
  "analyzer_report": {
    "component_estimates": {
      "input_storage_error": 5.482137203216553e-05,
      "matmul1_accumulation_error": 5.482137203216553e-05,
      "scaling_error": 5.482137203216553e-05,
      "softmax_numerical_error": 5.482137203216553e-05,
      "matmul2_accumulation_error": 5.482137203216553e-05,
      "output_demote_error": 0.00010281801223754883
    },
    "component_ratios": {
      "input_storage_error": 0.14544376358964223,
      "matmul1_accumulation_error": 0.14544376358964223,
      "scaling_error": 0.14544376358964223,
      "softmax_numerical_error": 0.14544376358964223,
      "matmul2_accumulation_error": 0.14544376358964223,
      "output_demote_error": 0.2727811820517889
    },
    "primary_source": "storage_error",
    "suggestion": "\u4e3b\u8981\u8bef\u5dee\u6765\u6e90\u4e3a\u8f93\u5165\u5b58\u50a8\u7cbe\u5ea6\u3002\u5efa\u8bae\uff1a\u63d0\u5347Q/K/V\u7684\u5b58\u50a8\u7cbe\u5ea6\uff1b\u8fdb\u884c\u8f93\u5165\u5f52\u4e00\u5316\uff1b\u68c0\u67e5embedding\u5c42\u7684\u8f93\u51fa\u8303\u56f4\u3002 \u68c0\u6d4b\u5230\u5927\u91cf\u5c16\u9510\u7684attention\u6a21\u5f0f\uff08\u4f4e\u71b5\uff09\uff0c\u8fd9\u4f1a\u653e\u5927softmax\u7684\u6570\u503c\u8bef\u5dee\u3002\u8003\u8651\u4f7f\u7528attention dropout\u6216\u6e29\u5ea6\u7f29\u653e\u3002",
    "attention_pattern_stats": {
      "global_avg_entropy": 3.878161668777466,
      "global_sparsity": 0.6948623657226562,
      "max_attention_weight": 1.0,
      "min_attention_weight": 0.0
    },
    "attention_behavior_stats": {
      "high_entropy_tokens": 0,
      "low_entropy_tokens": 7,
      "total_analyzed": 8
    },
    "top_tokens_summary": [
      {
        "batch_idx": 0,
        "head_idx": 7,
        "token_idx": 0,
        "token_error": 1.0042194844572805e-05,
        "entropy_ref": -0.0,
        "max_attention_weight_ref": 1.0,
        "attention_weight_error": 0.0,
        "stage_errors": {
          "storage_error": 2.0979356577299768e-05,
          "matmul1_error": 1.1078030589746946e-09,
          "softmax_error": 6.994632713031024e-07,
          "matmul2_error": 6.98529402143322e-07,
          "demote_error": 6.994632713031024e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 2,
        "token_idx": 1,
        "token_error": 9.731906175147742e-06,
        "entropy_ref": 0.6931190490722656,
        "max_attention_weight_ref": 0.5037490129470825,
        "attention_weight_error": 2.682209014892578e-07,
        "stage_errors": {
          "storage_error": 1.977886813619989e-05,
          "matmul1_error": 9.023992695484323e-10,
          "softmax_error": 5.742418579757214e-07,
          "matmul2_error": 7.091502993716858e-07,
          "demote_error": 5.742418579757214e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 4,
        "token_idx": 0,
        "token_error": 8.947172318585217e-06,
        "entropy_ref": -0.0,
        "max_attention_weight_ref": 1.0,
        "attention_weight_error": 0.0,
        "stage_errors": {
          "storage_error": 1.9161780528520467e-05,
          "matmul1_error": 8.037004024977396e-10,
          "softmax_error": 4.936453478876502e-07,
          "matmul2_error": 7.030105734884274e-07,
          "demote_error": 4.936453478876502e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 2,
        "token_idx": 0,
        "token_error": 8.893606718629599e-06,
        "entropy_ref": -0.0,
        "max_attention_weight_ref": 1.0,
        "attention_weight_error": 0.0,
        "stage_errors": {
          "storage_error": 2.075743350360426e-05,
          "matmul1_error": 1.0561771003502463e-09,
          "softmax_error": 6.720983947161585e-07,
          "matmul2_error": 7.091502993716858e-07,
          "demote_error": 6.720983947161585e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 7,
        "token_idx": 2,
        "token_error": 8.355889804079197e-06,
        "entropy_ref": 1.098548412322998,
        "max_attention_weight_ref": 0.33861029148101807,
        "attention_weight_error": 1.1622905731201172e-06,
        "stage_errors": {
          "storage_error": 2.2688377157464856e-05,
          "matmul1_error": 1.3784760598644261e-09,
          "softmax_error": 8.703653293196112e-07,
          "matmul2_error": 6.98529402143322e-07,
          "demote_error": 8.703653293196113e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 7,
        "token_idx": 1,
        "token_error": 8.315502782352269e-06,
        "entropy_ref": 0.6931424736976624,
        "max_attention_weight_ref": 0.5015348196029663,
        "attention_weight_error": 2.384185791015625e-07,
        "stage_errors": {
          "storage_error": 1.9241363133915e-05,
          "matmul1_error": 8.325413644653223e-10,
          "softmax_error": 5.256639269646257e-07,
          "matmul2_error": 6.98529402143322e-07,
          "demote_error": 5.256639269646257e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 3,
        "token_idx": 1,
        "token_error": 7.912203727755696e-06,
        "entropy_ref": 0.693137526512146,
        "max_attention_weight_ref": 0.5021908283233643,
        "attention_weight_error": 5.364418029785156e-07,
        "stage_errors": {
          "storage_error": 2.0545139250316424e-05,
          "matmul1_error": 1.02789949235205e-09,
          "softmax_error": 6.414804374799133e-07,
          "matmul2_error": 7.048720817692811e-07,
          "demote_error": 6.414804374799133e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 1,
        "token_idx": 0,
        "token_error": 7.536938937846571e-06,
        "entropy_ref": -0.0,
        "max_attention_weight_ref": 1.0,
        "attention_weight_error": 0.0,
        "stage_errors": {
          "storage_error": 2.255557637909078e-05,
          "matmul1_error": 1.3152962201353968e-09,
          "softmax_error": 8.158607670338825e-07,
          "matmul2_error": 7.272170932992595e-07,
          "demote_error": 8.158607670338824e-08
        }
      }
    ],
    "head_analysis": [
      {
        "head_idx": 0,
        "avg_error": 1.6260203210549662e-06,
        "avg_entropy": 3.8781607151031494,
        "avg_max_weight": 0.042897533625364304,
        "sparsity": 0.6947021484375
      },
      {
        "head_idx": 1,
        "avg_error": 1.8566228163763299e-06,
        "avg_entropy": 3.8781609535217285,
        "avg_max_weight": 0.0428800955414772,
        "sparsity": 0.69537353515625
      },
      {
        "head_idx": 2,
        "avg_error": 2.018128952840925e-06,
        "avg_entropy": 3.878161668777466,
        "avg_max_weight": 0.04286903515458107,
        "sparsity": 0.69488525390625
      },
      {
        "head_idx": 3,
        "avg_error": 1.7721481526677962e-06,
        "avg_entropy": 3.8781614303588867,
        "avg_max_weight": 0.04286907613277435,
        "sparsity": 0.69482421875
      },
      {
        "head_idx": 4,
        "avg_error": 1.8357751514486154e-06,
        "avg_entropy": 3.878161907196045,
        "avg_max_weight": 0.042862530797719955,
        "sparsity": 0.69488525390625
      },
      {
        "head_idx": 5,
        "avg_error": 1.8363871276960708e-06,
        "avg_entropy": 3.878161668777466,
        "avg_max_weight": 0.04286554455757141,
        "sparsity": 0.69464111328125
      },
      {
        "head_idx": 6,
        "avg_error": 1.941155687745777e-06,
        "avg_entropy": 3.878161907196045,
        "avg_max_weight": 0.04285629466176033,
        "sparsity": 0.69500732421875
      },
      {
        "head_idx": 7,
        "avg_error": 1.992557827179553e-06,
        "avg_entropy": 3.878161907196045,
        "avg_max_weight": 0.042862363159656525,
        "sparsity": 0.694580078125
      }
    ]
  }
}
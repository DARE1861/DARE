{
  "detector": {
    "detected_exceeded": false,
    "actual_err": 5.875527858734131e-05,
    "predicted_bound": 0.00014012033789185808,
    "elapsed_sec": 2.9659323692321777
  },
  "analyzer_report": {
    "component_estimates": {
      "input_storage_error": 5.875527858734131e-05,
      "matmul1_accumulation_error": 5.875527858734131e-05,
      "scaling_error": 5.875527858734131e-05,
      "softmax_numerical_error": 5.875527858734131e-05,
      "matmul2_accumulation_error": 5.875527858734131e-05,
      "output_demote_error": 9.994208812713623e-05
    },
    "component_ratios": {
      "input_storage_error": 0.14923170085534782,
      "matmul1_accumulation_error": 0.14923170085534782,
      "scaling_error": 0.14923170085534782,
      "softmax_numerical_error": 0.14923170085534782,
      "matmul2_accumulation_error": 0.14923170085534782,
      "output_demote_error": 0.2538414957232609
    },
    "primary_source": "storage_error",
    "suggestion": "\u4e3b\u8981\u8bef\u5dee\u6765\u6e90\u4e3a\u8f93\u5165\u5b58\u50a8\u7cbe\u5ea6\u3002\u5efa\u8bae\uff1a\u63d0\u5347Q/K/V\u7684\u5b58\u50a8\u7cbe\u5ea6\uff1b\u8fdb\u884c\u8f93\u5165\u5f52\u4e00\u5316\uff1b\u68c0\u67e5embedding\u5c42\u7684\u8f93\u51fa\u8303\u56f4\u3002 \u68c0\u6d4b\u5230\u5927\u91cf\u5c16\u9510\u7684attention\u6a21\u5f0f\uff08\u4f4e\u71b5\uff09\uff0c\u8fd9\u4f1a\u653e\u5927softmax\u7684\u6570\u503c\u8bef\u5dee\u3002\u8003\u8651\u4f7f\u7528attention dropout\u6216\u6e29\u5ea6\u7f29\u653e\u3002",
    "attention_pattern_stats": {
      "global_avg_entropy": 3.878162145614624,
      "global_sparsity": 0.6948776245117188,
      "max_attention_weight": 1.0,
      "min_attention_weight": 0.0
    },
    "attention_behavior_stats": {
      "high_entropy_tokens": 0,
      "low_entropy_tokens": 6,
      "total_analyzed": 8
    },
    "top_tokens_summary": [
      {
        "batch_idx": 0,
        "head_idx": 3,
        "token_idx": 1,
        "token_error": 9.166862582787871e-06,
        "entropy_ref": 0.6931203007698059,
        "max_attention_weight_ref": 0.5036659240722656,
        "attention_weight_error": 1.7881393432617188e-07,
        "stage_errors": {
          "storage_error": 1.9751220861508045e-05,
          "matmul1_error": 9.360360553330201e-10,
          "softmax_error": 5.754074663855136e-07,
          "matmul2_error": 6.807920726714656e-07,
          "demote_error": 5.7540746638551355e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 6,
        "token_idx": 1,
        "token_error": 8.845468983054161e-06,
        "entropy_ref": 0.6931328177452087,
        "max_attention_weight_ref": 0.502680242061615,
        "attention_weight_error": 1.043081283569336e-06,
        "stage_errors": {
          "storage_error": 2.1459489744302118e-05,
          "matmul1_error": 1.1471491688378424e-09,
          "softmax_error": 7.128681318135933e-07,
          "matmul2_error": 7.219070994324284e-07,
          "demote_error": 7.128681318135933e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 1,
        "token_idx": 0,
        "token_error": 8.690735739946831e-06,
        "entropy_ref": -0.0,
        "max_attention_weight_ref": 1.0,
        "attention_weight_error": 0.0,
        "stage_errors": {
          "storage_error": 1.9985352992080152e-05,
          "matmul1_error": 9.566948919919998e-10,
          "softmax_error": 6.110496542532929e-07,
          "matmul2_error": 6.955559456400807e-07,
          "demote_error": 6.110496542532928e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 7,
        "token_idx": 0,
        "token_error": 8.178720236173831e-06,
        "entropy_ref": -0.0,
        "max_attention_weight_ref": 1.0,
        "attention_weight_error": 0.0,
        "stage_errors": {
          "storage_error": 2.105274052155437e-05,
          "matmul1_error": 1.1095251144694865e-09,
          "softmax_error": 7.034905138425529e-07,
          "matmul2_error": 7.047656708891737e-07,
          "demote_error": 7.03490513842553e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 7,
        "token_idx": 1,
        "token_error": 8.024089765967801e-06,
        "entropy_ref": 0.693130612373352,
        "max_attention_weight_ref": 0.5028800368309021,
        "attention_weight_error": 7.450580596923828e-07,
        "stage_errors": {
          "storage_error": 2.1880118765693624e-05,
          "matmul1_error": 1.2400168443471156e-09,
          "softmax_error": 7.862283382564784e-07,
          "matmul2_error": 7.047656708891737e-07,
          "demote_error": 7.862283382564783e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 1,
        "token_idx": 2,
        "token_error": 7.5858588388655335e-06,
        "entropy_ref": 1.098573088645935,
        "max_attention_weight_ref": 0.3374209702014923,
        "attention_weight_error": 7.450580596923828e-07,
        "stage_errors": {
          "storage_error": 2.3967810193425976e-05,
          "matmul1_error": 1.5802115629506223e-09,
          "softmax_error": 1.0092953743878752e-06,
          "matmul2_error": 6.955559456400807e-07,
          "demote_error": 1.0092953743878752e-07
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 4,
        "token_idx": 0,
        "token_error": 7.4838080763584e-06,
        "entropy_ref": -0.0,
        "max_attention_weight_ref": 1.0,
        "attention_weight_error": 0.0,
        "stage_errors": {
          "storage_error": 2.063984447886469e-05,
          "matmul1_error": 1.0382179565962363e-09,
          "softmax_error": 6.564810973941349e-07,
          "matmul2_error": 7.085771358106286e-07,
          "demote_error": 6.564810973941349e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 7,
        "token_idx": 2,
        "token_error": 7.054766683722846e-06,
        "entropy_ref": 1.098571538925171,
        "max_attention_weight_ref": 0.33756595849990845,
        "attention_weight_error": 8.046627044677734e-07,
        "stage_errors": {
          "storage_error": 2.202700579800876e-05,
          "matmul1_error": 1.2631834469006231e-09,
          "softmax_error": 8.009170414879919e-07,
          "matmul2_error": 7.047656708891737e-07,
          "demote_error": 8.009170414879918e-08
        }
      }
    ],
    "head_analysis": [
      {
        "head_idx": 0,
        "avg_error": 1.703205725789303e-06,
        "avg_entropy": 3.878161907196045,
        "avg_max_weight": 0.042846061289310455,
        "sparsity": 0.6947021484375
      },
      {
        "head_idx": 1,
        "avg_error": 2.02404612537066e-06,
        "avg_entropy": 3.878162145614624,
        "avg_max_weight": 0.042870085686445236,
        "sparsity": 0.69500732421875
      },
      {
        "head_idx": 2,
        "avg_error": 1.7794690165828797e-06,
        "avg_entropy": 3.878162145614624,
        "avg_max_weight": 0.042844805866479874,
        "sparsity": 0.69464111328125
      },
      {
        "head_idx": 3,
        "avg_error": 1.7984435771722929e-06,
        "avg_entropy": 3.8781614303588867,
        "avg_max_weight": 0.04286479949951172,
        "sparsity": 0.6951904296875
      },
      {
        "head_idx": 4,
        "avg_error": 1.804834710128489e-06,
        "avg_entropy": 3.878162145614624,
        "avg_max_weight": 0.042854756116867065,
        "sparsity": 0.69476318359375
      },
      {
        "head_idx": 5,
        "avg_error": 1.913301275635604e-06,
        "avg_entropy": 3.878161907196045,
        "avg_max_weight": 0.042855679988861084,
        "sparsity": 0.6944580078125
      },
      {
        "head_idx": 6,
        "avg_error": 2.0276318082323996e-06,
        "avg_entropy": 3.878161668777466,
        "avg_max_weight": 0.042853161692619324,
        "sparsity": 0.69500732421875
      },
      {
        "head_idx": 7,
        "avg_error": 1.8539406028139638e-06,
        "avg_entropy": 3.878162145614624,
        "avg_max_weight": 0.04286276921629906,
        "sparsity": 0.69525146484375
      }
    ]
  }
}
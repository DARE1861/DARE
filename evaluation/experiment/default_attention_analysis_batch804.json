{
  "detector": {
    "detected_exceeded": false,
    "actual_err": 3.711879253387451e-05,
    "predicted_bound": 9.509023366263137e-05,
    "elapsed_sec": 2.9116859436035156
  },
  "analyzer_report": {
    "component_estimates": {
      "input_storage_error": 3.6813318729400635e-05,
      "matmul1_accumulation_error": 3.6813318729400635e-05,
      "scaling_error": 3.6813318729400635e-05,
      "softmax_numerical_error": 3.6813318729400635e-05,
      "matmul2_accumulation_error": 3.6813318729400635e-05,
      "output_demote_error": 7.221102714538574e-05
    },
    "component_ratios": {
      "input_storage_error": 0.14364624821932145,
      "matmul1_accumulation_error": 0.14364624821932145,
      "scaling_error": 0.14364624821932145,
      "softmax_numerical_error": 0.14364624821932145,
      "matmul2_accumulation_error": 0.14364624821932145,
      "output_demote_error": 0.28176875890339276
    },
    "primary_source": "storage_error",
    "suggestion": "\u4e3b\u8981\u8bef\u5dee\u6765\u6e90\u4e3a\u8f93\u5165\u5b58\u50a8\u7cbe\u5ea6\u3002\u5efa\u8bae\uff1a\u63d0\u5347Q/K/V\u7684\u5b58\u50a8\u7cbe\u5ea6\uff1b\u8fdb\u884c\u8f93\u5165\u5f52\u4e00\u5316\uff1b\u68c0\u67e5embedding\u5c42\u7684\u8f93\u51fa\u8303\u56f4\u3002",
    "attention_pattern_stats": {
      "global_avg_entropy": 3.878161668777466,
      "global_sparsity": 0.694976806640625,
      "max_attention_weight": 1.0,
      "min_attention_weight": 0.0
    },
    "attention_behavior_stats": {
      "high_entropy_tokens": 0,
      "low_entropy_tokens": 4,
      "total_analyzed": 8
    },
    "top_tokens_summary": [
      {
        "batch_idx": 0,
        "head_idx": 2,
        "token_idx": 1,
        "token_error": 9.208710253005847e-06,
        "entropy_ref": 0.6931294202804565,
        "max_attention_weight_ref": 0.502981960773468,
        "attention_weight_error": 7.450580596923828e-07,
        "stage_errors": {
          "storage_error": 2.2423591417464195e-05,
          "matmul1_error": 1.3631150572697833e-09,
          "softmax_error": 8.591621735831723e-07,
          "matmul2_error": 6.820284852437908e-07,
          "demote_error": 8.591621735831723e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 2,
        "token_idx": 2,
        "token_error": 8.686511137057096e-06,
        "entropy_ref": 1.0985918045043945,
        "max_attention_weight_ref": 0.3363453149795532,
        "attention_weight_error": 1.1622905731201172e-06,
        "stage_errors": {
          "storage_error": 2.1029521576565458e-05,
          "matmul1_error": 1.1419370713850497e-09,
          "softmax_error": 7.197551894932986e-07,
          "matmul2_error": 6.820284852437908e-07,
          "demote_error": 7.197551894932985e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 4,
        "token_idx": 0,
        "token_error": 8.674862328916788e-06,
        "entropy_ref": -0.0,
        "max_attention_weight_ref": 1.0,
        "attention_weight_error": 0.0,
        "stage_errors": {
          "storage_error": 1.9587126189435367e-05,
          "matmul1_error": 8.622873400826534e-10,
          "softmax_error": 5.345718818716705e-07,
          "matmul2_error": 7.112697858246975e-07,
          "demote_error": 5.345718818716705e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 6,
        "token_idx": 0,
        "token_error": 8.543782314518467e-06,
        "entropy_ref": -0.0,
        "max_attention_weight_ref": 1.0,
        "attention_weight_error": 0.0,
        "stage_errors": {
          "storage_error": 2.053964362858096e-05,
          "matmul1_error": 1.0350629453846391e-09,
          "softmax_error": 6.587380994460546e-07,
          "matmul2_error": 7.008114152995404e-07,
          "demote_error": 6.587380994460546e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 4,
        "token_idx": 1,
        "token_error": 7.972542334755417e-06,
        "entropy_ref": 0.6931189298629761,
        "max_attention_weight_ref": 0.50375896692276,
        "attention_weight_error": 7.450580596923828e-07,
        "stage_errors": {
          "storage_error": 2.0279891941754613e-05,
          "matmul1_error": 9.740334229062024e-10,
          "softmax_error": 6.038484571035952e-07,
          "matmul2_error": 7.112697858246975e-07,
          "demote_error": 6.038484571035951e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 4,
        "token_idx": 2,
        "token_error": 7.922099030110985e-06,
        "entropy_ref": 1.098586916923523,
        "max_attention_weight_ref": 0.33662137389183044,
        "attention_weight_error": 5.364418029785156e-07,
        "stage_errors": {
          "storage_error": 2.072372899419861e-05,
          "matmul1_error": 1.0456262403290113e-09,
          "softmax_error": 6.482321623479948e-07,
          "matmul2_error": 7.112697858246975e-07,
          "demote_error": 6.482321623479948e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 4,
        "token_idx": 3,
        "token_error": 7.5876450864598155e-06,
        "entropy_ref": 1.3862746953964233,
        "max_attention_weight_ref": 0.25247088074684143,
        "attention_weight_error": 5.066394805908203e-07,
        "stage_errors": {
          "storage_error": 2.0260254132153932e-05,
          "matmul1_error": 9.708657601128784e-10,
          "softmax_error": 6.018846761435271e-07,
          "matmul2_error": 7.112697858246975e-07,
          "demote_error": 6.01884676143527e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 0,
        "token_idx": 2,
        "token_error": 7.485889000236057e-06,
        "entropy_ref": 1.0985987186431885,
        "max_attention_weight_ref": 0.3357642889022827,
        "attention_weight_error": 4.470348358154297e-07,
        "stage_errors": {
          "storage_error": 1.8162982087233104e-05,
          "matmul1_error": 6.545984836554689e-10,
          "softmax_error": 4.1460807551629843e-07,
          "matmul2_error": 7.039362571958919e-07,
          "demote_error": 4.146080755162984e-08
        }
      }
    ],
    "head_analysis": [
      {
        "head_idx": 0,
        "avg_error": 1.800768814064213e-06,
        "avg_entropy": 3.878162384033203,
        "avg_max_weight": 0.042856283485889435,
        "sparsity": 0.69500732421875
      },
      {
        "head_idx": 1,
        "avg_error": 1.783201923899469e-06,
        "avg_entropy": 3.8781614303588867,
        "avg_max_weight": 0.042879242449998856,
        "sparsity": 0.69512939453125
      },
      {
        "head_idx": 2,
        "avg_error": 1.7800623481889488e-06,
        "avg_entropy": 3.878161668777466,
        "avg_max_weight": 0.04285873472690582,
        "sparsity": 0.6949462890625
      },
      {
        "head_idx": 3,
        "avg_error": 1.9010182086276473e-06,
        "avg_entropy": 3.878161668777466,
        "avg_max_weight": 0.04286573454737663,
        "sparsity": 0.6949462890625
      },
      {
        "head_idx": 4,
        "avg_error": 1.915423581522191e-06,
        "avg_entropy": 3.8781609535217285,
        "avg_max_weight": 0.042897023260593414,
        "sparsity": 0.69488525390625
      },
      {
        "head_idx": 5,
        "avg_error": 1.8854572090276633e-06,
        "avg_entropy": 3.878161668777466,
        "avg_max_weight": 0.04287227988243103,
        "sparsity": 0.6949462890625
      },
      {
        "head_idx": 6,
        "avg_error": 1.8039282849713345e-06,
        "avg_entropy": 3.878162145614624,
        "avg_max_weight": 0.0428343191742897,
        "sparsity": 0.69488525390625
      },
      {
        "head_idx": 7,
        "avg_error": 1.932149643835146e-06,
        "avg_entropy": 3.878162145614624,
        "avg_max_weight": 0.04285935312509537,
        "sparsity": 0.695068359375
      }
    ]
  }
}
{
  "detector": {
    "detected_exceeded": false,
    "actual_err": 5.2794814109802246e-05,
    "predicted_bound": 0.00012738366713165307,
    "elapsed_sec": 2.9369351863861084
  },
  "analyzer_report": {
    "component_estimates": {
      "input_storage_error": 4.589557647705078e-05,
      "matmul1_accumulation_error": 4.589557647705078e-05,
      "scaling_error": 4.589557647705078e-05,
      "softmax_numerical_error": 4.589557647705078e-05,
      "matmul2_accumulation_error": 4.589557647705078e-05,
      "output_demote_error": 8.563697338104248e-05
    },
    "component_ratios": {
      "input_storage_error": 0.14564713670969878,
      "matmul1_accumulation_error": 0.14564713670969878,
      "scaling_error": 0.14564713670969878,
      "softmax_numerical_error": 0.14564713670969878,
      "matmul2_accumulation_error": 0.14564713670969878,
      "output_demote_error": 0.2717643164515061
    },
    "primary_source": "storage_error",
    "suggestion": "\u4e3b\u8981\u8bef\u5dee\u6765\u6e90\u4e3a\u8f93\u5165\u5b58\u50a8\u7cbe\u5ea6\u3002\u5efa\u8bae\uff1a\u63d0\u5347Q/K/V\u7684\u5b58\u50a8\u7cbe\u5ea6\uff1b\u8fdb\u884c\u8f93\u5165\u5f52\u4e00\u5316\uff1b\u68c0\u67e5embedding\u5c42\u7684\u8f93\u51fa\u8303\u56f4\u3002",
    "attention_pattern_stats": {
      "global_avg_entropy": 3.878162145614624,
      "global_sparsity": 0.6949310302734375,
      "max_attention_weight": 1.0,
      "min_attention_weight": 0.0
    },
    "attention_behavior_stats": {
      "high_entropy_tokens": 0,
      "low_entropy_tokens": 4,
      "total_analyzed": 8
    },
    "top_tokens_summary": [
      {
        "batch_idx": 0,
        "head_idx": 7,
        "token_idx": 1,
        "token_error": 1.0390853276476264e-05,
        "entropy_ref": 0.6931233406066895,
        "max_attention_weight_ref": 0.5034506320953369,
        "attention_weight_error": 0.0,
        "stage_errors": {
          "storage_error": 2.1192646727286046e-05,
          "matmul1_error": 1.1207089157109423e-09,
          "softmax_error": 6.9466041168198e-07,
          "matmul2_error": 7.116112101357431e-07,
          "demote_error": 6.946604116819799e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 2,
        "token_idx": 1,
        "token_error": 9.88044121186249e-06,
        "entropy_ref": 0.6931145191192627,
        "max_attention_weight_ref": 0.5040377974510193,
        "attention_weight_error": 8.046627044677734e-07,
        "stage_errors": {
          "storage_error": 2.3268932636710815e-05,
          "matmul1_error": 1.4790160107457477e-09,
          "softmax_error": 9.257739293389023e-07,
          "matmul2_error": 6.95073413226055e-07,
          "demote_error": 9.257739293389022e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 7,
        "token_idx": 2,
        "token_error": 8.772272849455476e-06,
        "entropy_ref": 1.0985954999923706,
        "max_attention_weight_ref": 0.3359392583370209,
        "attention_weight_error": 3.5762786865234375e-07,
        "stage_errors": {
          "storage_error": 2.137640103683225e-05,
          "matmul1_error": 1.1503543495870584e-09,
          "softmax_error": 7.130358426366002e-07,
          "matmul2_error": 7.116112101357431e-07,
          "demote_error": 7.130358426366001e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 5,
        "token_idx": 1,
        "token_error": 8.214668923756108e-06,
        "entropy_ref": 0.6931164264678955,
        "max_attention_weight_ref": 0.5039193034172058,
        "attention_weight_error": 1.2516975402832031e-06,
        "stage_errors": {
          "storage_error": 2.097905417031143e-05,
          "matmul1_error": 1.0862677135774717e-09,
          "softmax_error": 6.870221113786102e-07,
          "matmul2_error": 7.121182534319815e-07,
          "demote_error": 6.870221113786102e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 5,
        "token_idx": 3,
        "token_error": 7.810769602656364e-06,
        "entropy_ref": 1.3862850666046143,
        "max_attention_weight_ref": 0.25179195404052734,
        "attention_weight_error": 1.0579824447631836e-06,
        "stage_errors": {
          "storage_error": 2.2618240109295584e-05,
          "matmul1_error": 1.3454434711809114e-09,
          "softmax_error": 8.509407052770258e-07,
          "matmul2_error": 7.121182534319815e-07,
          "demote_error": 8.509407052770257e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 2,
        "token_idx": 3,
        "token_error": 7.707440090598539e-06,
        "entropy_ref": 1.3862812519073486,
        "max_attention_weight_ref": 0.2522008717060089,
        "attention_weight_error": 5.21540641784668e-07,
        "stage_errors": {
          "storage_error": 2.128294545400422e-05,
          "matmul1_error": 1.161734788271009e-09,
          "softmax_error": 7.271752110682429e-07,
          "matmul2_error": 6.95073413226055e-07,
          "demote_error": 7.271752110682427e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 0,
        "token_idx": 0,
        "token_error": 7.5812567956745625e-06,
        "entropy_ref": -0.0,
        "max_attention_weight_ref": 1.0,
        "attention_weight_error": 0.0,
        "stage_errors": {
          "storage_error": 2.003372219405719e-05,
          "matmul1_error": 9.551191395046681e-10,
          "softmax_error": 5.981710273772478e-07,
          "matmul2_error": 6.995384410402039e-07,
          "demote_error": 5.981710273772479e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 0,
        "token_idx": 2,
        "token_error": 7.548322173533961e-06,
        "entropy_ref": 1.0986005067825317,
        "max_attention_weight_ref": 0.33558952808380127,
        "attention_weight_error": 5.960464477539063e-08,
        "stage_errors": {
          "storage_error": 1.9117169813398505e-05,
          "matmul1_error": 8.087702390966948e-10,
          "softmax_error": 5.065157893113792e-07,
          "matmul2_error": 6.995384410402039e-07,
          "demote_error": 5.065157893113792e-08
        }
      }
    ],
    "head_analysis": [
      {
        "head_idx": 0,
        "avg_error": 2.0174488781776745e-06,
        "avg_entropy": 3.878161907196045,
        "avg_max_weight": 0.04284731671214104,
        "sparsity": 0.6949462890625
      },
      {
        "head_idx": 1,
        "avg_error": 1.6431076801382005e-06,
        "avg_entropy": 3.878161907196045,
        "avg_max_weight": 0.04285825043916702,
        "sparsity": 0.69464111328125
      },
      {
        "head_idx": 2,
        "avg_error": 1.704339751995576e-06,
        "avg_entropy": 3.878161668777466,
        "avg_max_weight": 0.04287560284137726,
        "sparsity": 0.69500732421875
      },
      {
        "head_idx": 3,
        "avg_error": 1.8216596799902618e-06,
        "avg_entropy": 3.8781614303588867,
        "avg_max_weight": 0.04287862405180931,
        "sparsity": 0.694580078125
      },
      {
        "head_idx": 4,
        "avg_error": 1.690290218903101e-06,
        "avg_entropy": 3.8781614303588867,
        "avg_max_weight": 0.042870454490184784,
        "sparsity": 0.69537353515625
      },
      {
        "head_idx": 5,
        "avg_error": 1.7067511635104893e-06,
        "avg_entropy": 3.878162145614624,
        "avg_max_weight": 0.04285164922475815,
        "sparsity": 0.6949462890625
      },
      {
        "head_idx": 6,
        "avg_error": 1.93806135939667e-06,
        "avg_entropy": 3.878162145614624,
        "avg_max_weight": 0.04283365234732628,
        "sparsity": 0.69500732421875
      },
      {
        "head_idx": 7,
        "avg_error": 1.9277131286798976e-06,
        "avg_entropy": 3.878161907196045,
        "avg_max_weight": 0.04286443442106247,
        "sparsity": 0.6949462890625
      }
    ]
  }
}
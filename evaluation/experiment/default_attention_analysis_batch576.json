{
  "detector": {
    "detected_exceeded": false,
    "actual_err": 4.024803638458252e-05,
    "predicted_bound": 0.00011308465473121033,
    "elapsed_sec": 2.986643075942993
  },
  "analyzer_report": {
    "component_estimates": {
      "input_storage_error": 4.201382398605347e-05,
      "matmul1_accumulation_error": 4.201382398605347e-05,
      "scaling_error": 4.201382398605347e-05,
      "softmax_numerical_error": 4.201382398605347e-05,
      "matmul2_accumulation_error": 4.201382398605347e-05,
      "output_demote_error": 7.729232311248779e-05
    },
    "component_ratios": {
      "input_storage_error": 0.14620550182789288,
      "matmul1_accumulation_error": 0.14620550182789288,
      "scaling_error": 0.14620550182789288,
      "softmax_numerical_error": 0.14620550182789288,
      "matmul2_accumulation_error": 0.14620550182789288,
      "output_demote_error": 0.26897249086053565
    },
    "primary_source": "storage_error",
    "suggestion": "\u4e3b\u8981\u8bef\u5dee\u6765\u6e90\u4e3a\u8f93\u5165\u5b58\u50a8\u7cbe\u5ea6\u3002\u5efa\u8bae\uff1a\u63d0\u5347Q/K/V\u7684\u5b58\u50a8\u7cbe\u5ea6\uff1b\u8fdb\u884c\u8f93\u5165\u5f52\u4e00\u5316\uff1b\u68c0\u67e5embedding\u5c42\u7684\u8f93\u51fa\u8303\u56f4\u3002 \u68c0\u6d4b\u5230\u5927\u91cf\u5c16\u9510\u7684attention\u6a21\u5f0f\uff08\u4f4e\u71b5\uff09\uff0c\u8fd9\u4f1a\u653e\u5927softmax\u7684\u6570\u503c\u8bef\u5dee\u3002\u8003\u8651\u4f7f\u7528attention dropout\u6216\u6e29\u5ea6\u7f29\u653e\u3002",
    "attention_pattern_stats": {
      "global_avg_entropy": 3.878161907196045,
      "global_sparsity": 0.6947402954101562,
      "max_attention_weight": 1.0,
      "min_attention_weight": 0.0
    },
    "attention_behavior_stats": {
      "high_entropy_tokens": 0,
      "low_entropy_tokens": 8,
      "total_analyzed": 8
    },
    "top_tokens_summary": [
      {
        "batch_idx": 0,
        "head_idx": 4,
        "token_idx": 1,
        "token_error": 1.0567313438514248e-05,
        "entropy_ref": 0.6931349039077759,
        "max_attention_weight_ref": 0.5024747848510742,
        "attention_weight_error": 8.940696716308594e-07,
        "stage_errors": {
          "storage_error": 2.037829744949704e-05,
          "matmul1_error": 1.0084654965524607e-09,
          "softmax_error": 6.609741831198335e-07,
          "matmul2_error": 7.025735612842255e-07,
          "demote_error": 6.609741831198335e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 6,
        "token_idx": 1,
        "token_error": 8.713883289601654e-06,
        "entropy_ref": 0.6931226253509521,
        "max_attention_weight_ref": 0.5035072565078735,
        "attention_weight_error": 8.642673492431641e-07,
        "stage_errors": {
          "storage_error": 2.0655000298575033e-05,
          "matmul1_error": 1.0297436137242332e-09,
          "softmax_error": 6.443191523430869e-07,
          "matmul2_error": 7.148745680751745e-07,
          "demote_error": 6.443191523430869e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 1,
        "token_idx": 0,
        "token_error": 8.322920621139929e-06,
        "entropy_ref": -0.0,
        "max_attention_weight_ref": 1.0,
        "attention_weight_error": 0.0,
        "stage_errors": {
          "storage_error": 2.093005468850606e-05,
          "matmul1_error": 1.062225956924644e-09,
          "softmax_error": 6.604313966818154e-07,
          "matmul2_error": 7.217629445221974e-07,
          "demote_error": 6.604313966818154e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 6,
        "token_idx": 0,
        "token_error": 7.903669029474258e-06,
        "entropy_ref": -0.0,
        "max_attention_weight_ref": 1.0,
        "attention_weight_error": 0.0,
        "stage_errors": {
          "storage_error": 2.1066946828796063e-05,
          "matmul1_error": 1.0955804442993214e-09,
          "softmax_error": 6.855138053651899e-07,
          "matmul2_error": 7.148745680751745e-07,
          "demote_error": 6.8551380536519e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 5,
        "token_idx": 0,
        "token_error": 7.88988108979538e-06,
        "entropy_ref": -0.0,
        "max_attention_weight_ref": 1.0,
        "attention_weight_error": 0.0,
        "stage_errors": {
          "storage_error": 1.8746515706880018e-05,
          "matmul1_error": 7.495931250936349e-10,
          "softmax_error": 4.705416358774528e-07,
          "matmul2_error": 7.000776804488851e-07,
          "demote_error": 4.705416358774528e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 1,
        "token_idx": 1,
        "token_error": 7.5854459282709286e-06,
        "entropy_ref": 0.6931241750717163,
        "max_attention_weight_ref": 0.5033939480781555,
        "attention_weight_error": 8.046627044677734e-07,
        "stage_errors": {
          "storage_error": 2.1487167487066472e-05,
          "matmul1_error": 1.1518309754835827e-09,
          "softmax_error": 7.161426765378565e-07,
          "matmul2_error": 7.217629445221974e-07,
          "demote_error": 7.161426765378565e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 5,
        "token_idx": 1,
        "token_error": 7.395210559479892e-06,
        "entropy_ref": 0.6931149959564209,
        "max_attention_weight_ref": 0.5040117502212524,
        "attention_weight_error": 2.980232238769531e-07,
        "stage_errors": {
          "storage_error": 2.1508923964574933e-05,
          "matmul1_error": 1.1896566775587945e-09,
          "softmax_error": 7.467824616469443e-07,
          "matmul2_error": 7.000776804488851e-07,
          "demote_error": 7.467824616469443e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 7,
        "token_idx": 0,
        "token_error": 7.320675649680197e-06,
        "entropy_ref": -0.0,
        "max_attention_weight_ref": 1.0,
        "attention_weight_error": 0.0,
        "stage_errors": {
          "storage_error": 1.8925563836091897e-05,
          "matmul1_error": 8.037288033479786e-10,
          "softmax_error": 5.124369636178017e-07,
          "matmul2_error": 6.869584467494861e-07,
          "demote_error": 5.124369636178017e-08
        }
      }
    ],
    "head_analysis": [
      {
        "head_idx": 0,
        "avg_error": 1.720015916362172e-06,
        "avg_entropy": 3.878162145614624,
        "avg_max_weight": 0.042856745421886444,
        "sparsity": 0.694580078125
      },
      {
        "head_idx": 1,
        "avg_error": 1.803774125619384e-06,
        "avg_entropy": 3.8781611919403076,
        "avg_max_weight": 0.04287620633840561,
        "sparsity": 0.69488525390625
      },
      {
        "head_idx": 2,
        "avg_error": 1.8199662008555606e-06,
        "avg_entropy": 3.878161907196045,
        "avg_max_weight": 0.04286748170852661,
        "sparsity": 0.695068359375
      },
      {
        "head_idx": 3,
        "avg_error": 1.9028279893973377e-06,
        "avg_entropy": 3.878161907196045,
        "avg_max_weight": 0.04285619407892227,
        "sparsity": 0.6947021484375
      },
      {
        "head_idx": 4,
        "avg_error": 1.7302775177086005e-06,
        "avg_entropy": 3.878162384033203,
        "avg_max_weight": 0.04285135120153427,
        "sparsity": 0.69476318359375
      },
      {
        "head_idx": 5,
        "avg_error": 1.7344070784020005e-06,
        "avg_entropy": 3.8781614303588867,
        "avg_max_weight": 0.04287586733698845,
        "sparsity": 0.69464111328125
      },
      {
        "head_idx": 6,
        "avg_error": 1.8598466340336017e-06,
        "avg_entropy": 3.878161907196045,
        "avg_max_weight": 0.042860716581344604,
        "sparsity": 0.6947021484375
      },
      {
        "head_idx": 7,
        "avg_error": 1.8941888129120343e-06,
        "avg_entropy": 3.878162145614624,
        "avg_max_weight": 0.04285724461078644,
        "sparsity": 0.694580078125
      }
    ]
  }
}
{
  "detector": {
    "detected_exceeded": false,
    "actual_err": 4.971027374267578e-05,
    "predicted_bound": 0.00012353294951026328,
    "elapsed_sec": 2.948667049407959
  },
  "analyzer_report": {
    "component_estimates": {
      "input_storage_error": 5.520135164260864e-05,
      "matmul1_accumulation_error": 5.520135164260864e-05,
      "scaling_error": 5.520135164260864e-05,
      "softmax_numerical_error": 5.520135164260864e-05,
      "matmul2_accumulation_error": 5.520135164260864e-05,
      "output_demote_error": 8.592009544372559e-05
    },
    "component_ratios": {
      "input_storage_error": 0.1525207402680281,
      "matmul1_accumulation_error": 0.1525207402680281,
      "scaling_error": 0.1525207402680281,
      "softmax_numerical_error": 0.1525207402680281,
      "matmul2_accumulation_error": 0.1525207402680281,
      "output_demote_error": 0.23739629865985962
    },
    "primary_source": "storage_error",
    "suggestion": "\u4e3b\u8981\u8bef\u5dee\u6765\u6e90\u4e3a\u8f93\u5165\u5b58\u50a8\u7cbe\u5ea6\u3002\u5efa\u8bae\uff1a\u63d0\u5347Q/K/V\u7684\u5b58\u50a8\u7cbe\u5ea6\uff1b\u8fdb\u884c\u8f93\u5165\u5f52\u4e00\u5316\uff1b\u68c0\u67e5embedding\u5c42\u7684\u8f93\u51fa\u8303\u56f4\u3002 \u68c0\u6d4b\u5230\u5927\u91cf\u5c16\u9510\u7684attention\u6a21\u5f0f\uff08\u4f4e\u71b5\uff09\uff0c\u8fd9\u4f1a\u653e\u5927softmax\u7684\u6570\u503c\u8bef\u5dee\u3002\u8003\u8651\u4f7f\u7528attention dropout\u6216\u6e29\u5ea6\u7f29\u653e\u3002",
    "attention_pattern_stats": {
      "global_avg_entropy": 3.878161668777466,
      "global_sparsity": 0.69482421875,
      "max_attention_weight": 1.0,
      "min_attention_weight": 0.0
    },
    "attention_behavior_stats": {
      "high_entropy_tokens": 0,
      "low_entropy_tokens": 6,
      "total_analyzed": 8
    },
    "top_tokens_summary": [
      {
        "batch_idx": 0,
        "head_idx": 0,
        "token_idx": 1,
        "token_error": 8.869690645951778e-06,
        "entropy_ref": 0.6931042671203613,
        "max_attention_weight_ref": 0.5046324133872986,
        "attention_weight_error": 1.8775463104248047e-06,
        "stage_errors": {
          "storage_error": 2.2838337372377282e-05,
          "matmul1_error": 1.3970805020721448e-09,
          "softmax_error": 8.581308065913618e-07,
          "matmul2_error": 7.061993528623134e-07,
          "demote_error": 8.581308065913617e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 6,
        "token_idx": 0,
        "token_error": 8.129856723826379e-06,
        "entropy_ref": -0.0,
        "max_attention_weight_ref": 1.0,
        "attention_weight_error": 0.0,
        "stage_errors": {
          "storage_error": 2.1683172690245556e-05,
          "matmul1_error": 1.2474322090386309e-09,
          "softmax_error": 7.590657332912088e-07,
          "matmul2_error": 6.82974041410489e-07,
          "demote_error": 7.590657332912088e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 2,
        "token_idx": 0,
        "token_error": 7.488772098440677e-06,
        "entropy_ref": -0.0,
        "max_attention_weight_ref": 1.0,
        "attention_weight_error": 0.0,
        "stage_errors": {
          "storage_error": 2.0094457795494236e-05,
          "matmul1_error": 9.500657493931006e-10,
          "softmax_error": 5.817884812131525e-07,
          "matmul2_error": 7.059625204419717e-07,
          "demote_error": 5.817884812131524e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 7,
        "token_idx": 2,
        "token_error": 7.443868526024744e-06,
        "entropy_ref": 1.0986000299453735,
        "max_attention_weight_ref": 0.33566486835479736,
        "attention_weight_error": 5.662441253662109e-07,
        "stage_errors": {
          "storage_error": 1.8612029634823557e-05,
          "matmul1_error": 7.266942855702329e-10,
          "softmax_error": 4.522200470091775e-07,
          "matmul2_error": 6.988053428358399e-07,
          "demote_error": 4.522200470091775e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 4,
        "token_idx": 1,
        "token_error": 7.300841389223933e-06,
        "entropy_ref": 0.6931381225585938,
        "max_attention_weight_ref": 0.5021317601203918,
        "attention_weight_error": 4.172325134277344e-07,
        "stage_errors": {
          "storage_error": 2.0695747025456512e-05,
          "matmul1_error": 1.0241181715641819e-09,
          "softmax_error": 6.525471690110863e-07,
          "matmul2_error": 7.234369604702807e-07,
          "demote_error": 6.525471690110863e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 3,
        "token_idx": 2,
        "token_error": 7.203454515547492e-06,
        "entropy_ref": 1.0986051559448242,
        "max_attention_weight_ref": 0.33512166142463684,
        "attention_weight_error": 1.7881393432617188e-07,
        "stage_errors": {
          "storage_error": 2.0582680917868856e-05,
          "matmul1_error": 1.0588158933255504e-09,
          "softmax_error": 6.393893272615969e-07,
          "matmul2_error": 6.870321158203297e-07,
          "demote_error": 6.39389327261597e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 4,
        "token_idx": 0,
        "token_error": 7.181937689892948e-06,
        "entropy_ref": -0.0,
        "max_attention_weight_ref": 1.0,
        "attention_weight_error": 0.0,
        "stage_errors": {
          "storage_error": 2.3024620986689115e-05,
          "matmul1_error": 1.3896154499594617e-09,
          "softmax_error": 8.854345651343466e-07,
          "matmul2_error": 7.234369604702807e-07,
          "demote_error": 8.854345651343465e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 7,
        "token_idx": 0,
        "token_error": 7.0776222855784e-06,
        "entropy_ref": -0.0,
        "max_attention_weight_ref": 1.0,
        "attention_weight_error": 0.0,
        "stage_errors": {
          "storage_error": 2.049152953986777e-05,
          "matmul1_error": 1.0287202239952287e-09,
          "softmax_error": 6.401700375135988e-07,
          "matmul2_error": 6.988053428358399e-07,
          "demote_error": 6.401700375135988e-08
        }
      }
    ],
    "head_analysis": [
      {
        "head_idx": 0,
        "avg_error": 1.7606100755074294e-06,
        "avg_entropy": 3.878161668777466,
        "avg_max_weight": 0.04287438839673996,
        "sparsity": 0.69500732421875
      },
      {
        "head_idx": 1,
        "avg_error": 1.9214082840335323e-06,
        "avg_entropy": 3.8781611919403076,
        "avg_max_weight": 0.042870014905929565,
        "sparsity": 0.6949462890625
      },
      {
        "head_idx": 2,
        "avg_error": 1.6885749118955573e-06,
        "avg_entropy": 3.8781609535217285,
        "avg_max_weight": 0.042887188494205475,
        "sparsity": 0.69451904296875
      },
      {
        "head_idx": 3,
        "avg_error": 1.97356530406978e-06,
        "avg_entropy": 3.878161668777466,
        "avg_max_weight": 0.04287898167967796,
        "sparsity": 0.6949462890625
      },
      {
        "head_idx": 4,
        "avg_error": 1.939928097272059e-06,
        "avg_entropy": 3.878162384033203,
        "avg_max_weight": 0.042828503996133804,
        "sparsity": 0.69464111328125
      },
      {
        "head_idx": 5,
        "avg_error": 1.8864947151087108e-06,
        "avg_entropy": 3.878161668777466,
        "avg_max_weight": 0.04285922273993492,
        "sparsity": 0.69476318359375
      },
      {
        "head_idx": 6,
        "avg_error": 1.678533749327471e-06,
        "avg_entropy": 3.8781607151031494,
        "avg_max_weight": 0.04288826137781143,
        "sparsity": 0.6949462890625
      },
      {
        "head_idx": 7,
        "avg_error": 1.718870407785289e-06,
        "avg_entropy": 3.878161668777466,
        "avg_max_weight": 0.04285936430096626,
        "sparsity": 0.69482421875
      }
    ]
  }
}
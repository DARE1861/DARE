{
  "detector": {
    "detected_exceeded": false,
    "actual_err": 5.02169132232666e-05,
    "predicted_bound": 0.00012468804634409026,
    "elapsed_sec": 2.911548376083374
  },
  "analyzer_report": {
    "component_estimates": {
      "input_storage_error": 5.02169132232666e-05,
      "matmul1_accumulation_error": 5.02169132232666e-05,
      "scaling_error": 5.02169132232666e-05,
      "softmax_numerical_error": 5.02169132232666e-05,
      "matmul2_accumulation_error": 5.02169132232666e-05,
      "output_demote_error": 7.66068696975708e-05
    },
    "component_ratios": {
      "input_storage_error": 0.1532445091173662,
      "matmul1_accumulation_error": 0.1532445091173662,
      "scaling_error": 0.1532445091173662,
      "softmax_numerical_error": 0.1532445091173662,
      "matmul2_accumulation_error": 0.1532445091173662,
      "output_demote_error": 0.23377745441316902
    },
    "primary_source": "storage_error",
    "suggestion": "\u4e3b\u8981\u8bef\u5dee\u6765\u6e90\u4e3a\u8f93\u5165\u5b58\u50a8\u7cbe\u5ea6\u3002\u5efa\u8bae\uff1a\u63d0\u5347Q/K/V\u7684\u5b58\u50a8\u7cbe\u5ea6\uff1b\u8fdb\u884c\u8f93\u5165\u5f52\u4e00\u5316\uff1b\u68c0\u67e5embedding\u5c42\u7684\u8f93\u51fa\u8303\u56f4\u3002 \u68c0\u6d4b\u5230\u5927\u91cf\u5c16\u9510\u7684attention\u6a21\u5f0f\uff08\u4f4e\u71b5\uff09\uff0c\u8fd9\u4f1a\u653e\u5927softmax\u7684\u6570\u503c\u8bef\u5dee\u3002\u8003\u8651\u4f7f\u7528attention dropout\u6216\u6e29\u5ea6\u7f29\u653e\u3002",
    "attention_pattern_stats": {
      "global_avg_entropy": 3.878161668777466,
      "global_sparsity": 0.6948699951171875,
      "max_attention_weight": 1.0,
      "min_attention_weight": 0.0
    },
    "attention_behavior_stats": {
      "high_entropy_tokens": 0,
      "low_entropy_tokens": 7,
      "total_analyzed": 8
    },
    "top_tokens_summary": [
      {
        "batch_idx": 0,
        "head_idx": 6,
        "token_idx": 1,
        "token_error": 8.769842679612339e-06,
        "entropy_ref": 0.6931068897247314,
        "max_attention_weight_ref": 0.5044875741004944,
        "attention_weight_error": 9.238719940185547e-07,
        "stage_errors": {
          "storage_error": 2.3395691641781013e-05,
          "matmul1_error": 1.5339541714553631e-09,
          "softmax_error": 9.477444109506905e-07,
          "matmul2_error": 6.765281341358787e-07,
          "demote_error": 9.477444109506906e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 4,
        "token_idx": 1,
        "token_error": 8.367955160792917e-06,
        "entropy_ref": 0.693138599395752,
        "max_attention_weight_ref": 0.5020757913589478,
        "attention_weight_error": 2.980232238769531e-07,
        "stage_errors": {
          "storage_error": 1.9255575352872256e-05,
          "matmul1_error": 7.786603421786201e-10,
          "softmax_error": 4.992331014364026e-07,
          "matmul2_error": 7.370221737801331e-07,
          "demote_error": 4.992331014364027e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 4,
        "token_idx": 0,
        "token_error": 8.023336704354733e-06,
        "entropy_ref": -0.0,
        "max_attention_weight_ref": 1.0,
        "attention_weight_error": 0.0,
        "stage_errors": {
          "storage_error": 2.034197223110823e-05,
          "matmul1_error": 9.481070720759507e-10,
          "softmax_error": 6.078727892600001e-07,
          "matmul2_error": 7.370221737801331e-07,
          "demote_error": 6.0787278926e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 6,
        "token_idx": 0,
        "token_error": 7.661440577066969e-06,
        "entropy_ref": -0.0,
        "max_attention_weight_ref": 1.0,
        "attention_weight_error": 0.0,
        "stage_errors": {
          "storage_error": 2.1222610484983306e-05,
          "matmul1_error": 1.1822341436857328e-09,
          "softmax_error": 7.304362952709199e-07,
          "matmul2_error": 6.765281341358787e-07,
          "demote_error": 7.304362952709199e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 5,
        "token_idx": 1,
        "token_error": 7.394530257442966e-06,
        "entropy_ref": 0.6931212544441223,
        "max_attention_weight_ref": 0.5036006569862366,
        "attention_weight_error": 9.834766387939453e-07,
        "stage_errors": {
          "storage_error": 2.0544951439660508e-05,
          "matmul1_error": 1.0417232103427638e-09,
          "softmax_error": 6.566981028299779e-07,
          "matmul2_error": 6.967428362258944e-07,
          "demote_error": 6.566981028299779e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 2,
        "token_idx": 0,
        "token_error": 7.281219950527884e-06,
        "entropy_ref": -0.0,
        "max_attention_weight_ref": 1.0,
        "attention_weight_error": 0.0,
        "stage_errors": {
          "storage_error": 2.1356377601478016e-05,
          "matmul1_error": 1.147745827541587e-09,
          "softmax_error": 7.327143975999206e-07,
          "matmul2_error": 7.106525572453393e-07,
          "demote_error": 7.327143975999207e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 1,
        "token_idx": 0,
        "token_error": 6.9377383624669164e-06,
        "entropy_ref": -0.0,
        "max_attention_weight_ref": 1.0,
        "attention_weight_error": 0.0,
        "stage_errors": {
          "storage_error": 2.357583707635058e-05,
          "matmul1_error": 1.524212677904462e-09,
          "softmax_error": 9.255280019715429e-07,
          "matmul2_error": 7.042406650725753e-07,
          "demote_error": 9.255280019715429e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 2,
        "token_idx": 3,
        "token_error": 6.866811418149155e-06,
        "entropy_ref": 1.3862879276275635,
        "max_attention_weight_ref": 0.2515372931957245,
        "attention_weight_error": 5.960464477539063e-08,
        "stage_errors": {
          "storage_error": 2.0246415715519106e-05,
          "matmul1_error": 9.738780657625783e-10,
          "softmax_error": 6.217182090040297e-07,
          "matmul2_error": 7.106525572453393e-07,
          "demote_error": 6.217182090040296e-08
        }
      }
    ],
    "head_analysis": [
      {
        "head_idx": 0,
        "avg_error": 1.9685721781570464e-06,
        "avg_entropy": 3.878161907196045,
        "avg_max_weight": 0.042844850569963455,
        "sparsity": 0.69482421875
      },
      {
        "head_idx": 1,
        "avg_error": 1.7158143919004942e-06,
        "avg_entropy": 3.8781611919403076,
        "avg_max_weight": 0.042877644300460815,
        "sparsity": 0.69482421875
      },
      {
        "head_idx": 2,
        "avg_error": 1.8977697209265898e-06,
        "avg_entropy": 3.878162145614624,
        "avg_max_weight": 0.0428498350083828,
        "sparsity": 0.6949462890625
      },
      {
        "head_idx": 3,
        "avg_error": 1.907483010654687e-06,
        "avg_entropy": 3.8781607151031494,
        "avg_max_weight": 0.04290257766842842,
        "sparsity": 0.695068359375
      },
      {
        "head_idx": 4,
        "avg_error": 1.964642933671712e-06,
        "avg_entropy": 3.878162145614624,
        "avg_max_weight": 0.042849645018577576,
        "sparsity": 0.69482421875
      },
      {
        "head_idx": 5,
        "avg_error": 1.791710928955581e-06,
        "avg_entropy": 3.878162145614624,
        "avg_max_weight": 0.04284856095910072,
        "sparsity": 0.69464111328125
      },
      {
        "head_idx": 6,
        "avg_error": 1.7843791511040763e-06,
        "avg_entropy": 3.8781609535217285,
        "avg_max_weight": 0.042904503643512726,
        "sparsity": 0.69476318359375
      },
      {
        "head_idx": 7,
        "avg_error": 1.762593342391483e-06,
        "avg_entropy": 3.878161907196045,
        "avg_max_weight": 0.042860835790634155,
        "sparsity": 0.695068359375
      }
    ]
  }
}
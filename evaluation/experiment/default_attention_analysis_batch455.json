{
  "detector": {
    "detected_exceeded": false,
    "actual_err": 4.884600639343262e-05,
    "predicted_bound": 0.0001309617997321766,
    "elapsed_sec": 2.9470722675323486
  },
  "analyzer_report": {
    "component_estimates": {
      "input_storage_error": 4.884600639343262e-05,
      "matmul1_accumulation_error": 4.884600639343262e-05,
      "scaling_error": 4.884600639343262e-05,
      "softmax_numerical_error": 4.884600639343262e-05,
      "matmul2_accumulation_error": 4.884600639343262e-05,
      "output_demote_error": 9.080767631530762e-05
    },
    "component_ratios": {
      "input_storage_error": 0.14579256360078277,
      "matmul1_accumulation_error": 0.14579256360078277,
      "scaling_error": 0.14579256360078277,
      "softmax_numerical_error": 0.14579256360078277,
      "matmul2_accumulation_error": 0.14579256360078277,
      "output_demote_error": 0.2710371819960861
    },
    "primary_source": "storage_error",
    "suggestion": "\u4e3b\u8981\u8bef\u5dee\u6765\u6e90\u4e3a\u8f93\u5165\u5b58\u50a8\u7cbe\u5ea6\u3002\u5efa\u8bae\uff1a\u63d0\u5347Q/K/V\u7684\u5b58\u50a8\u7cbe\u5ea6\uff1b\u8fdb\u884c\u8f93\u5165\u5f52\u4e00\u5316\uff1b\u68c0\u67e5embedding\u5c42\u7684\u8f93\u51fa\u8303\u56f4\u3002 \u68c0\u6d4b\u5230\u5927\u91cf\u5c16\u9510\u7684attention\u6a21\u5f0f\uff08\u4f4e\u71b5\uff09\uff0c\u8fd9\u4f1a\u653e\u5927softmax\u7684\u6570\u503c\u8bef\u5dee\u3002\u8003\u8651\u4f7f\u7528attention dropout\u6216\u6e29\u5ea6\u7f29\u653e\u3002",
    "attention_pattern_stats": {
      "global_avg_entropy": 3.878161668777466,
      "global_sparsity": 0.694793701171875,
      "max_attention_weight": 1.0,
      "min_attention_weight": 0.0
    },
    "attention_behavior_stats": {
      "high_entropy_tokens": 0,
      "low_entropy_tokens": 6,
      "total_analyzed": 8
    },
    "top_tokens_summary": [
      {
        "batch_idx": 0,
        "head_idx": 5,
        "token_idx": 1,
        "token_error": 9.557879820931703e-06,
        "entropy_ref": 0.6931159496307373,
        "max_attention_weight_ref": 0.5039517879486084,
        "attention_weight_error": 5.960464477539063e-08,
        "stage_errors": {
          "storage_error": 2.1088897028676e-05,
          "matmul1_error": 1.1203090256854587e-09,
          "softmax_error": 7.415626896545291e-07,
          "matmul2_error": 6.996675892878557e-07,
          "demote_error": 7.415626896545292e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 6,
        "token_idx": 1,
        "token_error": 8.755654562264681e-06,
        "entropy_ref": 0.6931082010269165,
        "max_attention_weight_ref": 0.5044142603874207,
        "attention_weight_error": 9.834766387939453e-07,
        "stage_errors": {
          "storage_error": 2.167919410567265e-05,
          "matmul1_error": 1.2075982918818759e-09,
          "softmax_error": 7.62650597607717e-07,
          "matmul2_error": 7.054882189549971e-07,
          "demote_error": 7.62650597607717e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 6,
        "token_idx": 0,
        "token_error": 8.118171535898e-06,
        "entropy_ref": -0.0,
        "max_attention_weight_ref": 1.0,
        "attention_weight_error": 0.0,
        "stage_errors": {
          "storage_error": 1.911138133436907e-05,
          "matmul1_error": 8.010049808393709e-10,
          "softmax_error": 5.058693204773591e-07,
          "matmul2_error": 7.054882189549971e-07,
          "demote_error": 5.05869320477359e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 5,
        "token_idx": 4,
        "token_error": 7.941285730339587e-06,
        "entropy_ref": 1.609428882598877,
        "max_attention_weight_ref": 0.20159059762954712,
        "attention_weight_error": 6.258487701416016e-07,
        "stage_errors": {
          "storage_error": 1.8967766209243564e-05,
          "matmul1_error": 7.998611343848854e-10,
          "softmax_error": 5.294496077112854e-07,
          "matmul2_error": 6.996675892878557e-07,
          "demote_error": 5.2944960771128534e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 3,
        "token_idx": 2,
        "token_error": 7.818049198249355e-06,
        "entropy_ref": 1.0985615253448486,
        "max_attention_weight_ref": 0.3379465341567993,
        "attention_weight_error": 1.0728836059570312e-06,
        "stage_errors": {
          "storage_error": 2.3427560336131137e-05,
          "matmul1_error": 1.5176563585278878e-09,
          "softmax_error": 9.343133569927886e-07,
          "matmul2_error": 6.905725058459211e-07,
          "demote_error": 9.343133569927886e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 4,
        "token_idx": 1,
        "token_error": 7.597391231684014e-06,
        "entropy_ref": 0.6930941343307495,
        "max_attention_weight_ref": 0.505151629447937,
        "attention_weight_error": 1.8477439880371094e-06,
        "stage_errors": {
          "storage_error": 2.3770626739860745e-05,
          "matmul1_error": 1.5548445390754318e-09,
          "softmax_error": 9.826836503634696e-07,
          "matmul2_error": 6.951197065063753e-07,
          "demote_error": 9.826836503634696e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 1,
        "token_idx": 1,
        "token_error": 7.472921424778178e-06,
        "entropy_ref": 0.6931166648864746,
        "max_attention_weight_ref": 0.5039069652557373,
        "attention_weight_error": 4.470348358154297e-07,
        "stage_errors": {
          "storage_error": 1.9675216208270285e-05,
          "matmul1_error": 8.798510844389956e-10,
          "softmax_error": 5.579524440690876e-07,
          "matmul2_error": 7.126586751837749e-07,
          "demote_error": 5.5795244406908754e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 0,
        "token_idx": 0,
        "token_error": 7.037448085611686e-06,
        "entropy_ref": -0.0,
        "max_attention_weight_ref": 1.0,
        "attention_weight_error": 0.0,
        "stage_errors": {
          "storage_error": 2.447297401886317e-05,
          "matmul1_error": 1.673794506974162e-09,
          "softmax_error": 1.0547468264121564e-06,
          "matmul2_error": 6.912262051628204e-07,
          "demote_error": 1.0547468264121562e-07
        }
      }
    ],
    "head_analysis": [
      {
        "head_idx": 0,
        "avg_error": 1.8371467831457267e-06,
        "avg_entropy": 3.878161907196045,
        "avg_max_weight": 0.042859259992837906,
        "sparsity": 0.69476318359375
      },
      {
        "head_idx": 1,
        "avg_error": 1.8372126078247675e-06,
        "avg_entropy": 3.878161907196045,
        "avg_max_weight": 0.042851053178310394,
        "sparsity": 0.69488525390625
      },
      {
        "head_idx": 2,
        "avg_error": 1.8307474647372146e-06,
        "avg_entropy": 3.878162145614624,
        "avg_max_weight": 0.04284903034567833,
        "sparsity": 0.6949462890625
      },
      {
        "head_idx": 3,
        "avg_error": 1.7481045233580517e-06,
        "avg_entropy": 3.8781611919403076,
        "avg_max_weight": 0.042885053902864456,
        "sparsity": 0.69464111328125
      },
      {
        "head_idx": 4,
        "avg_error": 1.750113597154268e-06,
        "avg_entropy": 3.8781614303588867,
        "avg_max_weight": 0.04287232458591461,
        "sparsity": 0.6951904296875
      },
      {
        "head_idx": 5,
        "avg_error": 1.8757418729364872e-06,
        "avg_entropy": 3.8781628608703613,
        "avg_max_weight": 0.04282462224364281,
        "sparsity": 0.694580078125
      },
      {
        "head_idx": 6,
        "avg_error": 1.8144764908356592e-06,
        "avg_entropy": 3.878161668777466,
        "avg_max_weight": 0.04287596419453621,
        "sparsity": 0.694580078125
      },
      {
        "head_idx": 7,
        "avg_error": 1.9514025098033017e-06,
        "avg_entropy": 3.8781614303588867,
        "avg_max_weight": 0.04288221895694733,
        "sparsity": 0.69476318359375
      }
    ]
  }
}
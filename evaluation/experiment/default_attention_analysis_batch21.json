{
  "detector": {
    "detected_exceeded": false,
    "actual_err": 5.151331424713135e-05,
    "predicted_bound": 0.00013142394891474396,
    "elapsed_sec": 2.972593069076538
  },
  "analyzer_report": {
    "component_estimates": {
      "input_storage_error": 5.151331424713135e-05,
      "matmul1_accumulation_error": 5.151331424713135e-05,
      "scaling_error": 5.151331424713135e-05,
      "softmax_numerical_error": 5.151331424713135e-05,
      "matmul2_accumulation_error": 5.151331424713135e-05,
      "output_demote_error": 8.475035429000854e-05
    },
    "component_ratios": {
      "input_storage_error": 0.15048427467624334,
      "matmul1_accumulation_error": 0.15048427467624334,
      "scaling_error": 0.15048427467624334,
      "softmax_numerical_error": 0.15048427467624334,
      "matmul2_accumulation_error": 0.15048427467624334,
      "output_demote_error": 0.24757862661878333
    },
    "primary_source": "storage_error",
    "suggestion": "\u4e3b\u8981\u8bef\u5dee\u6765\u6e90\u4e3a\u8f93\u5165\u5b58\u50a8\u7cbe\u5ea6\u3002\u5efa\u8bae\uff1a\u63d0\u5347Q/K/V\u7684\u5b58\u50a8\u7cbe\u5ea6\uff1b\u8fdb\u884c\u8f93\u5165\u5f52\u4e00\u5316\uff1b\u68c0\u67e5embedding\u5c42\u7684\u8f93\u51fa\u8303\u56f4\u3002 \u68c0\u6d4b\u5230\u5927\u91cf\u5c16\u9510\u7684attention\u6a21\u5f0f\uff08\u4f4e\u71b5\uff09\uff0c\u8fd9\u4f1a\u653e\u5927softmax\u7684\u6570\u503c\u8bef\u5dee\u3002\u8003\u8651\u4f7f\u7528attention dropout\u6216\u6e29\u5ea6\u7f29\u653e\u3002",
    "attention_pattern_stats": {
      "global_avg_entropy": 3.878161668777466,
      "global_sparsity": 0.694915771484375,
      "max_attention_weight": 1.0,
      "min_attention_weight": 0.0
    },
    "attention_behavior_stats": {
      "high_entropy_tokens": 0,
      "low_entropy_tokens": 6,
      "total_analyzed": 8
    },
    "top_tokens_summary": [
      {
        "batch_idx": 0,
        "head_idx": 5,
        "token_idx": 2,
        "token_error": 9.648287232266739e-06,
        "entropy_ref": 1.0985857248306274,
        "max_attention_weight_ref": 0.3366508483886719,
        "attention_weight_error": 5.364418029785156e-07,
        "stage_errors": {
          "storage_error": 2.1013880541431718e-05,
          "matmul1_error": 1.1020506500908198e-09,
          "softmax_error": 6.954272976145148e-07,
          "matmul2_error": 7.056112281134119e-07,
          "demote_error": 6.954272976145149e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 4,
        "token_idx": 0,
        "token_error": 9.256647899746895e-06,
        "entropy_ref": -0.0,
        "max_attention_weight_ref": 1.0,
        "attention_weight_error": 0.0,
        "stage_errors": {
          "storage_error": 2.442408685965347e-05,
          "matmul1_error": 1.6213005490957964e-09,
          "softmax_error": 1.0374140401836485e-06,
          "matmul2_error": 7.143153652577894e-07,
          "demote_error": 1.0374140401836485e-07
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 4,
        "token_idx": 1,
        "token_error": 8.56474980537314e-06,
        "entropy_ref": 0.6931102275848389,
        "max_attention_weight_ref": 0.5042979717254639,
        "attention_weight_error": 1.1324882507324219e-06,
        "stage_errors": {
          "storage_error": 2.2198320493771462e-05,
          "matmul1_error": 1.2734513691748618e-09,
          "softmax_error": 8.148374035954476e-07,
          "matmul2_error": 7.143153652577894e-07,
          "demote_error": 8.148374035954476e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 5,
        "token_idx": 1,
        "token_error": 8.555740350857377e-06,
        "entropy_ref": 0.6931161880493164,
        "max_attention_weight_ref": 0.5039372444152832,
        "attention_weight_error": 4.172325134277344e-07,
        "stage_errors": {
          "storage_error": 2.1739497242379002e-05,
          "matmul1_error": 1.2170398602841444e-09,
          "softmax_error": 7.679889677092433e-07,
          "matmul2_error": 7.056112281134119e-07,
          "demote_error": 7.679889677092433e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 1,
        "token_idx": 1,
        "token_error": 8.427158718404826e-06,
        "entropy_ref": 0.6931024789810181,
        "max_attention_weight_ref": 0.5047286748886108,
        "attention_weight_error": 5.662441253662109e-07,
        "stage_errors": {
          "storage_error": 2.4544402094761608e-05,
          "matmul1_error": 1.693519849248062e-09,
          "softmax_error": 1.0458586984896101e-06,
          "matmul2_error": 6.929617939022137e-07,
          "demote_error": 1.0458586984896101e-07
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 6,
        "token_idx": 1,
        "token_error": 8.312854333780706e-06,
        "entropy_ref": 0.6931219100952148,
        "max_attention_weight_ref": 0.5035585165023804,
        "attention_weight_error": 7.152557373046875e-07,
        "stage_errors": {
          "storage_error": 1.894029810500797e-05,
          "matmul1_error": 7.991285414158271e-10,
          "softmax_error": 5.038909876020625e-07,
          "matmul2_error": 6.89256557961926e-07,
          "demote_error": 5.0389098760206254e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 4,
        "token_idx": 2,
        "token_error": 7.77783861849457e-06,
        "entropy_ref": 1.0985772609710693,
        "max_attention_weight_ref": 0.3372511863708496,
        "attention_weight_error": 1.2516975402832031e-06,
        "stage_errors": {
          "storage_error": 2.28495296141773e-05,
          "matmul1_error": 1.3752242065950368e-09,
          "softmax_error": 8.799583156360314e-07,
          "matmul2_error": 7.143153652577894e-07,
          "demote_error": 8.799583156360314e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 6,
        "token_idx": 0,
        "token_error": 7.739106877124868e-06,
        "entropy_ref": -0.0,
        "max_attention_weight_ref": 1.0,
        "attention_weight_error": 0.0,
        "stage_errors": {
          "storage_error": 2.204788506787736e-05,
          "matmul1_error": 1.291965583169358e-09,
          "softmax_error": 8.146496838890017e-07,
          "matmul2_error": 6.89256557961926e-07,
          "demote_error": 8.146496838890017e-08
        }
      }
    ],
    "head_analysis": [
      {
        "head_idx": 0,
        "avg_error": 1.6706574115232797e-06,
        "avg_entropy": 3.878161907196045,
        "avg_max_weight": 0.04286150634288788,
        "sparsity": 0.69488525390625
      },
      {
        "head_idx": 1,
        "avg_error": 1.8491758737582131e-06,
        "avg_entropy": 3.8781614303588867,
        "avg_max_weight": 0.04288603365421295,
        "sparsity": 0.6949462890625
      },
      {
        "head_idx": 2,
        "avg_error": 1.809996660995239e-06,
        "avg_entropy": 3.8781614303588867,
        "avg_max_weight": 0.0428750216960907,
        "sparsity": 0.69464111328125
      },
      {
        "head_idx": 3,
        "avg_error": 1.7665254290477606e-06,
        "avg_entropy": 3.878162145614624,
        "avg_max_weight": 0.04284796118736267,
        "sparsity": 0.69500732421875
      },
      {
        "head_idx": 4,
        "avg_error": 1.8917298802989535e-06,
        "avg_entropy": 3.8781609535217285,
        "avg_max_weight": 0.0428985171020031,
        "sparsity": 0.6949462890625
      },
      {
        "head_idx": 5,
        "avg_error": 1.8987900602951413e-06,
        "avg_entropy": 3.878161668777466,
        "avg_max_weight": 0.04287044703960419,
        "sparsity": 0.69476318359375
      },
      {
        "head_idx": 6,
        "avg_error": 1.6632359347568126e-06,
        "avg_entropy": 3.878161668777466,
        "avg_max_weight": 0.042864661663770676,
        "sparsity": 0.6951904296875
      },
      {
        "head_idx": 7,
        "avg_error": 1.8505222669773502e-06,
        "avg_entropy": 3.878161907196045,
        "avg_max_weight": 0.04284641891717911,
        "sparsity": 0.6949462890625
      }
    ]
  }
}
{
  "detector": {
    "detected_exceeded": false,
    "actual_err": 4.5672059059143066e-05,
    "predicted_bound": 0.0001179763065010775,
    "elapsed_sec": 2.9633638858795166
  },
  "analyzer_report": {
    "component_estimates": {
      "input_storage_error": 4.346668720245361e-05,
      "matmul1_accumulation_error": 4.346668720245361e-05,
      "scaling_error": 4.346668720245361e-05,
      "softmax_numerical_error": 4.346668720245361e-05,
      "matmul2_accumulation_error": 4.346668720245361e-05,
      "output_demote_error": 7.436424493789673e-05
    },
    "component_ratios": {
      "input_storage_error": 0.1490127966080049,
      "matmul1_accumulation_error": 0.1490127966080049,
      "scaling_error": 0.1490127966080049,
      "softmax_numerical_error": 0.1490127966080049,
      "matmul2_accumulation_error": 0.1490127966080049,
      "output_demote_error": 0.2549360169599755
    },
    "primary_source": "storage_error",
    "suggestion": "\u4e3b\u8981\u8bef\u5dee\u6765\u6e90\u4e3a\u8f93\u5165\u5b58\u50a8\u7cbe\u5ea6\u3002\u5efa\u8bae\uff1a\u63d0\u5347Q/K/V\u7684\u5b58\u50a8\u7cbe\u5ea6\uff1b\u8fdb\u884c\u8f93\u5165\u5f52\u4e00\u5316\uff1b\u68c0\u67e5embedding\u5c42\u7684\u8f93\u51fa\u8303\u56f4\u3002 \u68c0\u6d4b\u5230\u5927\u91cf\u5c16\u9510\u7684attention\u6a21\u5f0f\uff08\u4f4e\u71b5\uff09\uff0c\u8fd9\u4f1a\u653e\u5927softmax\u7684\u6570\u503c\u8bef\u5dee\u3002\u8003\u8651\u4f7f\u7528attention dropout\u6216\u6e29\u5ea6\u7f29\u653e\u3002",
    "attention_pattern_stats": {
      "global_avg_entropy": 3.878161668777466,
      "global_sparsity": 0.694793701171875,
      "max_attention_weight": 1.0,
      "min_attention_weight": 0.0
    },
    "attention_behavior_stats": {
      "high_entropy_tokens": 0,
      "low_entropy_tokens": 8,
      "total_analyzed": 8
    },
    "top_tokens_summary": [
      {
        "batch_idx": 0,
        "head_idx": 2,
        "token_idx": 1,
        "token_error": 1.1198027095815632e-05,
        "entropy_ref": 0.6931244134902954,
        "max_attention_weight_ref": 0.5033726096153259,
        "attention_weight_error": 1.1026859283447266e-06,
        "stage_errors": {
          "storage_error": 1.9749605598917697e-05,
          "matmul1_error": 9.447567560343818e-10,
          "softmax_error": 5.919908289797605e-07,
          "matmul2_error": 6.776759619242513e-07,
          "demote_error": 5.919908289797604e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 6,
        "token_idx": 1,
        "token_error": 8.934061042964458e-06,
        "entropy_ref": 0.6931185722351074,
        "max_attention_weight_ref": 0.5037838220596313,
        "attention_weight_error": 1.4901161193847656e-06,
        "stage_errors": {
          "storage_error": 2.3265665276994696e-05,
          "matmul1_error": 1.4456552769217212e-09,
          "softmax_error": 9.325553037342616e-07,
          "matmul2_error": 7.089093287504511e-07,
          "demote_error": 9.325553037342616e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 1,
        "token_idx": 1,
        "token_error": 8.597188752901275e-06,
        "entropy_ref": 0.6931396722793579,
        "max_attention_weight_ref": 0.5019315481185913,
        "attention_weight_error": 6.258487701416016e-07,
        "stage_errors": {
          "storage_error": 2.0635773125832202e-05,
          "matmul1_error": 1.0494922727082419e-09,
          "softmax_error": 6.77765638101846e-07,
          "matmul2_error": 7.014830316620646e-07,
          "demote_error": 6.77765638101846e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 0,
        "token_idx": 1,
        "token_error": 8.479721145704389e-06,
        "entropy_ref": 0.6931074261665344,
        "max_attention_weight_ref": 0.5044580101966858,
        "attention_weight_error": 8.344650268554688e-07,
        "stage_errors": {
          "storage_error": 2.306447186128935e-05,
          "matmul1_error": 1.4236901482034412e-09,
          "softmax_error": 8.980961865745485e-07,
          "matmul2_error": 7.077711416059174e-07,
          "demote_error": 8.980961865745485e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 5,
        "token_idx": 1,
        "token_error": 8.160694051184691e-06,
        "entropy_ref": 0.6931004524230957,
        "max_attention_weight_ref": 0.5048327445983887,
        "attention_weight_error": 3.2782554626464844e-07,
        "stage_errors": {
          "storage_error": 2.034333192568738e-05,
          "matmul1_error": 1.0169176907172732e-09,
          "softmax_error": 6.151185516500846e-07,
          "matmul2_error": 6.885939001222141e-07,
          "demote_error": 6.151185516500846e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 7,
        "token_idx": 0,
        "token_error": 8.030416211113334e-06,
        "entropy_ref": -0.0,
        "max_attention_weight_ref": 1.0,
        "attention_weight_error": 0.0,
        "stage_errors": {
          "storage_error": 2.146129600077984e-05,
          "matmul1_error": 1.2159435131077814e-09,
          "softmax_error": 7.517533958889545e-07,
          "matmul2_error": 6.795457920816261e-07,
          "demote_error": 7.517533958889544e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 7,
        "token_idx": 1,
        "token_error": 7.912327419035137e-06,
        "entropy_ref": 0.6931219100952148,
        "max_attention_weight_ref": 0.5035523176193237,
        "attention_weight_error": 5.066394805908203e-07,
        "stage_errors": {
          "storage_error": 2.218577765233931e-05,
          "matmul1_error": 1.3331267236388955e-09,
          "softmax_error": 8.242015610449017e-07,
          "matmul2_error": 6.795457920816261e-07,
          "demote_error": 8.242015610449016e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 5,
        "token_idx": 0,
        "token_error": 7.732513040537015e-06,
        "entropy_ref": -0.0,
        "max_attention_weight_ref": 1.0,
        "attention_weight_error": 0.0,
        "stage_errors": {
          "storage_error": 1.8785254724207334e-05,
          "matmul1_error": 7.593354302834113e-10,
          "softmax_error": 4.5931083150208e-07,
          "matmul2_error": 6.885939001222141e-07,
          "demote_error": 4.5931083150208e-08
        }
      }
    ],
    "head_analysis": [
      {
        "head_idx": 0,
        "avg_error": 1.8187784007750452e-06,
        "avg_entropy": 3.878161668777466,
        "avg_max_weight": 0.04285988211631775,
        "sparsity": 0.695068359375
      },
      {
        "head_idx": 1,
        "avg_error": 1.815882228584087e-06,
        "avg_entropy": 3.878162145614624,
        "avg_max_weight": 0.04284929856657982,
        "sparsity": 0.69476318359375
      },
      {
        "head_idx": 2,
        "avg_error": 1.9571489247027785e-06,
        "avg_entropy": 3.878162145614624,
        "avg_max_weight": 0.04285223409533501,
        "sparsity": 0.6949462890625
      },
      {
        "head_idx": 3,
        "avg_error": 1.837500690271554e-06,
        "avg_entropy": 3.878162145614624,
        "avg_max_weight": 0.04284458979964256,
        "sparsity": 0.694580078125
      },
      {
        "head_idx": 4,
        "avg_error": 1.7763576352081145e-06,
        "avg_entropy": 3.878162145614624,
        "avg_max_weight": 0.04286693409085274,
        "sparsity": 0.69488525390625
      },
      {
        "head_idx": 5,
        "avg_error": 1.6547636505492846e-06,
        "avg_entropy": 3.8781609535217285,
        "avg_max_weight": 0.04290817677974701,
        "sparsity": 0.6947021484375
      },
      {
        "head_idx": 6,
        "avg_error": 1.8377670585323358e-06,
        "avg_entropy": 3.878162145614624,
        "avg_max_weight": 0.042845919728279114,
        "sparsity": 0.69476318359375
      },
      {
        "head_idx": 7,
        "avg_error": 1.7575239326106384e-06,
        "avg_entropy": 3.8781611919403076,
        "avg_max_weight": 0.04288802668452263,
        "sparsity": 0.69464111328125
      }
    ]
  }
}
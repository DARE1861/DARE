{
  "detector": {
    "detected_exceeded": false,
    "actual_err": 5.844235420227051e-05,
    "predicted_bound": 0.00014071493787923828,
    "elapsed_sec": 2.9092376232147217
  },
  "analyzer_report": {
    "component_estimates": {
      "input_storage_error": 5.844235420227051e-05,
      "matmul1_accumulation_error": 5.844235420227051e-05,
      "scaling_error": 5.844235420227051e-05,
      "softmax_numerical_error": 5.844235420227051e-05,
      "matmul2_accumulation_error": 5.844235420227051e-05,
      "output_demote_error": 8.178502321243286e-05
    },
    "component_ratios": {
      "input_storage_error": 0.156264318584776,
      "matmul1_accumulation_error": 0.156264318584776,
      "scaling_error": 0.156264318584776,
      "softmax_numerical_error": 0.156264318584776,
      "matmul2_accumulation_error": 0.156264318584776,
      "output_demote_error": 0.21867840707612007
    },
    "primary_source": "storage_error",
    "suggestion": "\u4e3b\u8981\u8bef\u5dee\u6765\u6e90\u4e3a\u8f93\u5165\u5b58\u50a8\u7cbe\u5ea6\u3002\u5efa\u8bae\uff1a\u63d0\u5347Q/K/V\u7684\u5b58\u50a8\u7cbe\u5ea6\uff1b\u8fdb\u884c\u8f93\u5165\u5f52\u4e00\u5316\uff1b\u68c0\u67e5embedding\u5c42\u7684\u8f93\u51fa\u8303\u56f4\u3002 \u68c0\u6d4b\u5230\u5927\u91cf\u5c16\u9510\u7684attention\u6a21\u5f0f\uff08\u4f4e\u71b5\uff09\uff0c\u8fd9\u4f1a\u653e\u5927softmax\u7684\u6570\u503c\u8bef\u5dee\u3002\u8003\u8651\u4f7f\u7528attention dropout\u6216\u6e29\u5ea6\u7f29\u653e\u3002",
    "attention_pattern_stats": {
      "global_avg_entropy": 3.8781614303588867,
      "global_sparsity": 0.69500732421875,
      "max_attention_weight": 1.0,
      "min_attention_weight": 0.0
    },
    "attention_behavior_stats": {
      "high_entropy_tokens": 0,
      "low_entropy_tokens": 8,
      "total_analyzed": 8
    },
    "top_tokens_summary": [
      {
        "batch_idx": 0,
        "head_idx": 3,
        "token_idx": 0,
        "token_error": 9.853072697296739e-06,
        "entropy_ref": -0.0,
        "max_attention_weight_ref": 1.0,
        "attention_weight_error": 0.0,
        "stage_errors": {
          "storage_error": 2.0246219264663523e-05,
          "matmul1_error": 1.0192819314159479e-09,
          "softmax_error": 6.539383321069181e-07,
          "matmul2_error": 6.818369456595974e-07,
          "demote_error": 6.539383321069181e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 2,
        "token_idx": 1,
        "token_error": 9.021277946885675e-06,
        "entropy_ref": 0.6930954456329346,
        "max_attention_weight_ref": 0.5050886869430542,
        "attention_weight_error": 5.364418029785156e-07,
        "stage_errors": {
          "storage_error": 2.139411026291782e-05,
          "matmul1_error": 1.1766909595999894e-09,
          "softmax_error": 7.381502655334771e-07,
          "matmul2_error": 6.967580702621491e-07,
          "demote_error": 7.38150265533477e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 1,
        "token_idx": 0,
        "token_error": 8.9992317953147e-06,
        "entropy_ref": -0.0,
        "max_attention_weight_ref": 1.0,
        "attention_weight_error": 0.0,
        "stage_errors": {
          "storage_error": 2.1662125618604477e-05,
          "matmul1_error": 1.1857556209148855e-09,
          "softmax_error": 7.496761099901051e-07,
          "matmul2_error": 7.175213795562741e-07,
          "demote_error": 7.49676109990105e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 4,
        "token_idx": 1,
        "token_error": 8.44219175633043e-06,
        "entropy_ref": 0.693069338798523,
        "max_attention_weight_ref": 0.5062364935874939,
        "attention_weight_error": 1.9371509552001953e-06,
        "stage_errors": {
          "storage_error": 2.6150670692004496e-05,
          "matmul1_error": 1.9269662166513757e-09,
          "softmax_error": 1.2003110896330327e-06,
          "matmul2_error": 7.05267575540347e-07,
          "demote_error": 1.2003110896330327e-07
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 5,
        "token_idx": 1,
        "token_error": 8.358449122169986e-06,
        "entropy_ref": 0.6931279897689819,
        "max_attention_weight_ref": 0.5031007528305054,
        "attention_weight_error": 7.450580596923828e-07,
        "stage_errors": {
          "storage_error": 2.1003223992011044e-05,
          "matmul1_error": 1.1057421633118619e-09,
          "softmax_error": 6.797090463805944e-07,
          "matmul2_error": 7.016680683591404e-07,
          "demote_error": 6.797090463805944e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 5,
        "token_idx": 0,
        "token_error": 8.236820576712489e-06,
        "entropy_ref": -0.0,
        "max_attention_weight_ref": 1.0,
        "attention_weight_error": 0.0,
        "stage_errors": {
          "storage_error": 2.1115324670972768e-05,
          "matmul1_error": 1.1239785613595138e-09,
          "softmax_error": 6.909191142767669e-07,
          "matmul2_error": 7.016680683591404e-07,
          "demote_error": 6.909191142767668e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 1,
        "token_idx": 1,
        "token_error": 7.99680310592521e-06,
        "entropy_ref": 0.6930959224700928,
        "max_attention_weight_ref": 0.5050612092018127,
        "attention_weight_error": 5.066394805908203e-07,
        "stage_errors": {
          "storage_error": 2.214570758951595e-05,
          "matmul1_error": 1.2622433244097915e-09,
          "softmax_error": 7.980343070812523e-07,
          "matmul2_error": 7.175213795562741e-07,
          "demote_error": 7.980343070812524e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 7,
        "token_idx": 0,
        "token_error": 7.92768332757987e-06,
        "entropy_ref": -0.0,
        "max_attention_weight_ref": 1.0,
        "attention_weight_error": 0.0,
        "stage_errors": {
          "storage_error": 2.2241155420488212e-05,
          "matmul1_error": 1.2853444387594152e-09,
          "softmax_error": 8.178307325579226e-07,
          "matmul2_error": 7.117066616046941e-07,
          "demote_error": 8.178307325579226e-08
        }
      }
    ],
    "head_analysis": [
      {
        "head_idx": 0,
        "avg_error": 1.907418891278212e-06,
        "avg_entropy": 3.878161668777466,
        "avg_max_weight": 0.042878199368715286,
        "sparsity": 0.6949462890625
      },
      {
        "head_idx": 1,
        "avg_error": 1.8576428146843682e-06,
        "avg_entropy": 3.8781611919403076,
        "avg_max_weight": 0.042886123061180115,
        "sparsity": 0.69482421875
      },
      {
        "head_idx": 2,
        "avg_error": 1.9498102119541727e-06,
        "avg_entropy": 3.8781611919403076,
        "avg_max_weight": 0.04290064424276352,
        "sparsity": 0.69525146484375
      },
      {
        "head_idx": 3,
        "avg_error": 1.628854533919366e-06,
        "avg_entropy": 3.878161668777466,
        "avg_max_weight": 0.042862121015787125,
        "sparsity": 0.6949462890625
      },
      {
        "head_idx": 4,
        "avg_error": 1.9375715964997653e-06,
        "avg_entropy": 3.8781611919403076,
        "avg_max_weight": 0.04289136454463005,
        "sparsity": 0.6951904296875
      },
      {
        "head_idx": 5,
        "avg_error": 1.9415756469243206e-06,
        "avg_entropy": 3.8781614303588867,
        "avg_max_weight": 0.04286723583936691,
        "sparsity": 0.69500732421875
      },
      {
        "head_idx": 6,
        "avg_error": 1.7507818483863957e-06,
        "avg_entropy": 3.8781611919403076,
        "avg_max_weight": 0.04288874566555023,
        "sparsity": 0.695068359375
      },
      {
        "head_idx": 7,
        "avg_error": 1.7987035789701622e-06,
        "avg_entropy": 3.878162145614624,
        "avg_max_weight": 0.042861439287662506,
        "sparsity": 0.69482421875
      }
    ]
  }
}
{
  "detector": {
    "detected_exceeded": false,
    "actual_err": 4.947930574417114e-05,
    "predicted_bound": 0.00014083222195040437,
    "elapsed_sec": 2.928884506225586
  },
  "analyzer_report": {
    "component_estimates": {
      "input_storage_error": 4.9442052841186523e-05,
      "matmul1_accumulation_error": 4.9442052841186523e-05,
      "scaling_error": 4.9442052841186523e-05,
      "softmax_numerical_error": 4.9442052841186523e-05,
      "matmul2_accumulation_error": 4.9442052841186523e-05,
      "output_demote_error": 8.577108383178711e-05
    },
    "component_ratios": {
      "input_storage_error": 0.14848294996867448,
      "matmul1_accumulation_error": 0.14848294996867448,
      "scaling_error": 0.14848294996867448,
      "softmax_numerical_error": 0.14848294996867448,
      "matmul2_accumulation_error": 0.14848294996867448,
      "output_demote_error": 0.2575852501566276
    },
    "primary_source": "storage_error",
    "suggestion": "\u4e3b\u8981\u8bef\u5dee\u6765\u6e90\u4e3a\u8f93\u5165\u5b58\u50a8\u7cbe\u5ea6\u3002\u5efa\u8bae\uff1a\u63d0\u5347Q/K/V\u7684\u5b58\u50a8\u7cbe\u5ea6\uff1b\u8fdb\u884c\u8f93\u5165\u5f52\u4e00\u5316\uff1b\u68c0\u67e5embedding\u5c42\u7684\u8f93\u51fa\u8303\u56f4\u3002 \u68c0\u6d4b\u5230\u5927\u91cf\u5c16\u9510\u7684attention\u6a21\u5f0f\uff08\u4f4e\u71b5\uff09\uff0c\u8fd9\u4f1a\u653e\u5927softmax\u7684\u6570\u503c\u8bef\u5dee\u3002\u8003\u8651\u4f7f\u7528attention dropout\u6216\u6e29\u5ea6\u7f29\u653e\u3002",
    "attention_pattern_stats": {
      "global_avg_entropy": 3.8781614303588867,
      "global_sparsity": 0.694976806640625,
      "max_attention_weight": 1.0,
      "min_attention_weight": 0.0
    },
    "attention_behavior_stats": {
      "high_entropy_tokens": 0,
      "low_entropy_tokens": 7,
      "total_analyzed": 8
    },
    "top_tokens_summary": [
      {
        "batch_idx": 0,
        "head_idx": 3,
        "token_idx": 0,
        "token_error": 1.0662988643161952e-05,
        "entropy_ref": -0.0,
        "max_attention_weight_ref": 1.0,
        "attention_weight_error": 0.0,
        "stage_errors": {
          "storage_error": 2.0851026420132257e-05,
          "matmul1_error": 1.0875928286531334e-09,
          "softmax_error": 6.783331627957524e-07,
          "matmul2_error": 6.981904334679712e-07,
          "demote_error": 6.783331627957523e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 3,
        "token_idx": 1,
        "token_error": 9.912280802382156e-06,
        "entropy_ref": 0.6931418180465698,
        "max_attention_weight_ref": 0.5016304850578308,
        "attention_weight_error": 1.7881393432617188e-07,
        "stage_errors": {
          "storage_error": 2.1373432900873013e-05,
          "matmul1_error": 1.1713518976855055e-09,
          "softmax_error": 7.305738108698279e-07,
          "matmul2_error": 6.981904334679712e-07,
          "demote_error": 7.305738108698279e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 6,
        "token_idx": 1,
        "token_error": 9.347555533167906e-06,
        "entropy_ref": 0.6931225061416626,
        "max_attention_weight_ref": 0.5035095810890198,
        "attention_weight_error": 2.980232238769531e-07,
        "stage_errors": {
          "storage_error": 2.115120969392592e-05,
          "matmul1_error": 1.1437708085605103e-09,
          "softmax_error": 7.25533755030483e-07,
          "matmul2_error": 6.928862603672314e-07,
          "demote_error": 7.25533755030483e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 4,
        "token_idx": 1,
        "token_error": 8.37229163153097e-06,
        "entropy_ref": 0.693131685256958,
        "max_attention_weight_ref": 0.5027822852134705,
        "attention_weight_error": 5.960464477539063e-08,
        "stage_errors": {
          "storage_error": 2.097677770507289e-05,
          "matmul1_error": 1.1373847391546329e-09,
          "softmax_error": 7.043712685117498e-07,
          "matmul2_error": 6.796803063480184e-07,
          "demote_error": 7.043712685117498e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 2,
        "token_idx": 1,
        "token_error": 7.741218723822385e-06,
        "entropy_ref": 0.6931390762329102,
        "max_attention_weight_ref": 0.5020067691802979,
        "attention_weight_error": 1.8775463104248047e-06,
        "stage_errors": {
          "storage_error": 2.1288189145707292e-05,
          "matmul1_error": 1.1634412790027605e-09,
          "softmax_error": 7.439412001986057e-07,
          "matmul2_error": 6.937299986020663e-07,
          "demote_error": 7.439412001986056e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 1,
        "token_idx": 0,
        "token_error": 7.525673936470412e-06,
        "entropy_ref": -0.0,
        "max_attention_weight_ref": 1.0,
        "attention_weight_error": 0.0,
        "stage_errors": {
          "storage_error": 2.113831214956008e-05,
          "matmul1_error": 1.1256658835070476e-09,
          "softmax_error": 6.981579645071179e-07,
          "matmul2_error": 7.031142558844295e-07,
          "demote_error": 6.981579645071179e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 2,
        "token_idx": 0,
        "token_error": 7.4356430559419096e-06,
        "entropy_ref": -0.0,
        "max_attention_weight_ref": 1.0,
        "attention_weight_error": 0.0,
        "stage_errors": {
          "storage_error": 1.9644299300125567e-05,
          "matmul1_error": 9.063551942459725e-10,
          "softmax_error": 5.795522156404332e-07,
          "matmul2_error": 6.937299986020663e-07,
          "demote_error": 5.7955221564043315e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 3,
        "token_idx": 2,
        "token_error": 6.970938557060435e-06,
        "entropy_ref": 1.098605751991272,
        "max_attention_weight_ref": 0.33503344655036926,
        "attention_weight_error": 1.0132789611816406e-06,
        "stage_errors": {
          "storage_error": 1.9629502276075073e-05,
          "matmul1_error": 8.917420326183725e-10,
          "softmax_error": 5.561807483900339e-07,
          "matmul2_error": 6.981904334679712e-07,
          "demote_error": 5.5618074839003385e-08
        }
      }
    ],
    "head_analysis": [
      {
        "head_idx": 0,
        "avg_error": 1.7273944195039803e-06,
        "avg_entropy": 3.8781611919403076,
        "avg_max_weight": 0.04288921132683754,
        "sparsity": 0.69525146484375
      },
      {
        "head_idx": 1,
        "avg_error": 1.8719680383583182e-06,
        "avg_entropy": 3.878161907196045,
        "avg_max_weight": 0.04284946992993355,
        "sparsity": 0.695068359375
      },
      {
        "head_idx": 2,
        "avg_error": 1.8169481563745649e-06,
        "avg_entropy": 3.878162384033203,
        "avg_max_weight": 0.042848940938711166,
        "sparsity": 0.6947021484375
      },
      {
        "head_idx": 3,
        "avg_error": 1.9858659925375832e-06,
        "avg_entropy": 3.8781614303588867,
        "avg_max_weight": 0.04286469146609306,
        "sparsity": 0.69512939453125
      },
      {
        "head_idx": 4,
        "avg_error": 1.7924655821843771e-06,
        "avg_entropy": 3.8781614303588867,
        "avg_max_weight": 0.04287593811750412,
        "sparsity": 0.6947021484375
      },
      {
        "head_idx": 5,
        "avg_error": 1.8491770106265903e-06,
        "avg_entropy": 3.8781609535217285,
        "avg_max_weight": 0.042882539331912994,
        "sparsity": 0.69482421875
      },
      {
        "head_idx": 6,
        "avg_error": 1.662701606619521e-06,
        "avg_entropy": 3.878162145614624,
        "avg_max_weight": 0.042852263897657394,
        "sparsity": 0.695068359375
      },
      {
        "head_idx": 7,
        "avg_error": 1.818874807213433e-06,
        "avg_entropy": 3.8781614303588867,
        "avg_max_weight": 0.04288391023874283,
        "sparsity": 0.695068359375
      }
    ]
  }
}
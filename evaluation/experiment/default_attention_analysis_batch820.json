{
  "detector": {
    "detected_exceeded": false,
    "actual_err": 4.0471553802490234e-05,
    "predicted_bound": 8.724335784791038e-05,
    "elapsed_sec": 2.9161441326141357
  },
  "analyzer_report": {
    "component_estimates": {
      "input_storage_error": 4.0024518966674805e-05,
      "matmul1_accumulation_error": 4.0024518966674805e-05,
      "scaling_error": 4.0024518966674805e-05,
      "softmax_numerical_error": 4.0024518966674805e-05,
      "matmul2_accumulation_error": 4.0024518966674805e-05,
      "output_demote_error": 6.591528654098511e-05
    },
    "component_ratios": {
      "input_storage_error": 0.15044669112498948,
      "matmul1_accumulation_error": 0.15044669112498948,
      "scaling_error": 0.15044669112498948,
      "softmax_numerical_error": 0.15044669112498948,
      "matmul2_accumulation_error": 0.15044669112498948,
      "output_demote_error": 0.24776654437505252
    },
    "primary_source": "storage_error",
    "suggestion": "\u4e3b\u8981\u8bef\u5dee\u6765\u6e90\u4e3a\u8f93\u5165\u5b58\u50a8\u7cbe\u5ea6\u3002\u5efa\u8bae\uff1a\u63d0\u5347Q/K/V\u7684\u5b58\u50a8\u7cbe\u5ea6\uff1b\u8fdb\u884c\u8f93\u5165\u5f52\u4e00\u5316\uff1b\u68c0\u67e5embedding\u5c42\u7684\u8f93\u51fa\u8303\u56f4\u3002 \u68c0\u6d4b\u5230\u5927\u91cf\u5c16\u9510\u7684attention\u6a21\u5f0f\uff08\u4f4e\u71b5\uff09\uff0c\u8fd9\u4f1a\u653e\u5927softmax\u7684\u6570\u503c\u8bef\u5dee\u3002\u8003\u8651\u4f7f\u7528attention dropout\u6216\u6e29\u5ea6\u7f29\u653e\u3002",
    "attention_pattern_stats": {
      "global_avg_entropy": 3.878161668777466,
      "global_sparsity": 0.6948699951171875,
      "max_attention_weight": 1.0,
      "min_attention_weight": 0.0
    },
    "attention_behavior_stats": {
      "high_entropy_tokens": 0,
      "low_entropy_tokens": 7,
      "total_analyzed": 8
    },
    "top_tokens_summary": [
      {
        "batch_idx": 0,
        "head_idx": 4,
        "token_idx": 1,
        "token_error": 9.378220966027584e-06,
        "entropy_ref": 0.6931169033050537,
        "max_attention_weight_ref": 0.5038920044898987,
        "attention_weight_error": 2.086162567138672e-07,
        "stage_errors": {
          "storage_error": 2.2399178305931855e-05,
          "matmul1_error": 1.3067155176812338e-09,
          "softmax_error": 8.300541594508105e-07,
          "matmul2_error": 7.141354217310437e-07,
          "demote_error": 8.300541594508104e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 4,
        "token_idx": 0,
        "token_error": 8.080940460786223e-06,
        "entropy_ref": -0.0,
        "max_attention_weight_ref": 1.0,
        "attention_weight_error": 0.0,
        "stage_errors": {
          "storage_error": 2.0255901290511247e-05,
          "matmul1_error": 9.69309421602801e-10,
          "softmax_error": 6.157264579087496e-07,
          "matmul2_error": 7.141354217310437e-07,
          "demote_error": 6.157264579087495e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 4,
        "token_idx": 2,
        "token_error": 7.771850505378097e-06,
        "entropy_ref": 1.0986031293869019,
        "max_attention_weight_ref": 0.3352888226509094,
        "attention_weight_error": 4.76837158203125e-07,
        "stage_errors": {
          "storage_error": 1.955221432581311e-05,
          "matmul1_error": 8.585312674436262e-10,
          "softmax_error": 5.453577614389361e-07,
          "matmul2_error": 7.141354217310437e-07,
          "demote_error": 5.45357761438936e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 1,
        "token_idx": 0,
        "token_error": 7.587461368530057e-06,
        "entropy_ref": -0.0,
        "max_attention_weight_ref": 1.0,
        "attention_weight_error": 0.0,
        "stage_errors": {
          "storage_error": 2.2684729174216045e-05,
          "matmul1_error": 1.3931843989966023e-09,
          "softmax_error": 8.684946806170046e-07,
          "matmul2_error": 6.910431693540886e-07,
          "demote_error": 8.684946806170046e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 2,
        "token_idx": 1,
        "token_error": 7.55148676034878e-06,
        "entropy_ref": 0.6931267976760864,
        "max_attention_weight_ref": 0.5031874775886536,
        "attention_weight_error": 7.152557373046875e-07,
        "stage_errors": {
          "storage_error": 1.9287197119410848e-05,
          "matmul1_error": 8.507690977827465e-10,
          "softmax_error": 5.326803147909232e-07,
          "matmul2_error": 6.901932010805468e-07,
          "demote_error": 5.3268031479092315e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 2,
        "token_idx": 0,
        "token_error": 6.971396942390129e-06,
        "entropy_ref": -0.0,
        "max_attention_weight_ref": 1.0,
        "attention_weight_error": 0.0,
        "stage_errors": {
          "storage_error": 1.972803102034959e-05,
          "matmul1_error": 9.211767794183835e-10,
          "softmax_error": 5.767637048847974e-07,
          "matmul2_error": 6.901932010805468e-07,
          "demote_error": 5.767637048847974e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 3,
        "token_idx": 1,
        "token_error": 6.729050255671609e-06,
        "entropy_ref": 0.6931217312812805,
        "max_attention_weight_ref": 0.503567099571228,
        "attention_weight_error": 2.682209014892578e-07,
        "stage_errors": {
          "storage_error": 1.940177889991901e-05,
          "matmul1_error": 8.496567678956706e-10,
          "softmax_error": 5.326204700395465e-07,
          "matmul2_error": 7.02554871168104e-07,
          "demote_error": 5.326204700395465e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 1,
        "token_idx": 1,
        "token_error": 6.620677595492452e-06,
        "entropy_ref": 0.6931372880935669,
        "max_attention_weight_ref": 0.5022251009941101,
        "attention_weight_error": 1.1920928955078125e-07,
        "stage_errors": {
          "storage_error": 1.9087022792518837e-05,
          "matmul1_error": 8.160630285363711e-10,
          "softmax_error": 5.087240424472839e-07,
          "matmul2_error": 6.910431693540886e-07,
          "demote_error": 5.087240424472839e-08
        }
      }
    ],
    "head_analysis": [
      {
        "head_idx": 0,
        "avg_error": 1.846141685746261e-06,
        "avg_entropy": 3.878162145614624,
        "avg_max_weight": 0.042846694588661194,
        "sparsity": 0.69488525390625
      },
      {
        "head_idx": 1,
        "avg_error": 1.7514064438728383e-06,
        "avg_entropy": 3.878161668777466,
        "avg_max_weight": 0.04287341237068176,
        "sparsity": 0.69464111328125
      },
      {
        "head_idx": 2,
        "avg_error": 1.60792012593447e-06,
        "avg_entropy": 3.878162145614624,
        "avg_max_weight": 0.04284636303782463,
        "sparsity": 0.69500732421875
      },
      {
        "head_idx": 3,
        "avg_error": 1.71089266132185e-06,
        "avg_entropy": 3.878161668777466,
        "avg_max_weight": 0.042866311967372894,
        "sparsity": 0.69476318359375
      },
      {
        "head_idx": 4,
        "avg_error": 1.9129861357214395e-06,
        "avg_entropy": 3.878162384033203,
        "avg_max_weight": 0.04284517094492912,
        "sparsity": 0.6947021484375
      },
      {
        "head_idx": 5,
        "avg_error": 1.5211189747788012e-06,
        "avg_entropy": 3.8781611919403076,
        "avg_max_weight": 0.04289110004901886,
        "sparsity": 0.6949462890625
      },
      {
        "head_idx": 6,
        "avg_error": 1.9383596736588515e-06,
        "avg_entropy": 3.8781604766845703,
        "avg_max_weight": 0.0429159440100193,
        "sparsity": 0.69488525390625
      },
      {
        "head_idx": 7,
        "avg_error": 1.7808961274567991e-06,
        "avg_entropy": 3.8781626224517822,
        "avg_max_weight": 0.0428466871380806,
        "sparsity": 0.69512939453125
      }
    ]
  }
}
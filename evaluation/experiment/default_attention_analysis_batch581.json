{
  "detector": {
    "detected_exceeded": false,
    "actual_err": 4.57763671875e-05,
    "predicted_bound": 0.00011096567395725289,
    "elapsed_sec": 2.9519009590148926
  },
  "analyzer_report": {
    "component_estimates": {
      "input_storage_error": 4.415959119796753e-05,
      "matmul1_accumulation_error": 4.415959119796753e-05,
      "scaling_error": 4.415959119796753e-05,
      "softmax_numerical_error": 4.415959119796753e-05,
      "matmul2_accumulation_error": 4.415959119796753e-05,
      "output_demote_error": 7.274746894836426e-05
    },
    "component_ratios": {
      "input_storage_error": 0.15043529023579277,
      "matmul1_accumulation_error": 0.15043529023579277,
      "scaling_error": 0.15043529023579277,
      "softmax_numerical_error": 0.15043529023579277,
      "matmul2_accumulation_error": 0.15043529023579277,
      "output_demote_error": 0.24782354882103608
    },
    "primary_source": "storage_error",
    "suggestion": "\u4e3b\u8981\u8bef\u5dee\u6765\u6e90\u4e3a\u8f93\u5165\u5b58\u50a8\u7cbe\u5ea6\u3002\u5efa\u8bae\uff1a\u63d0\u5347Q/K/V\u7684\u5b58\u50a8\u7cbe\u5ea6\uff1b\u8fdb\u884c\u8f93\u5165\u5f52\u4e00\u5316\uff1b\u68c0\u67e5embedding\u5c42\u7684\u8f93\u51fa\u8303\u56f4\u3002 \u68c0\u6d4b\u5230\u5927\u91cf\u5c16\u9510\u7684attention\u6a21\u5f0f\uff08\u4f4e\u71b5\uff09\uff0c\u8fd9\u4f1a\u653e\u5927softmax\u7684\u6570\u503c\u8bef\u5dee\u3002\u8003\u8651\u4f7f\u7528attention dropout\u6216\u6e29\u5ea6\u7f29\u653e\u3002",
    "attention_pattern_stats": {
      "global_avg_entropy": 3.878161907196045,
      "global_sparsity": 0.694854736328125,
      "max_attention_weight": 1.0,
      "min_attention_weight": 0.0
    },
    "attention_behavior_stats": {
      "high_entropy_tokens": 0,
      "low_entropy_tokens": 7,
      "total_analyzed": 8
    },
    "top_tokens_summary": [
      {
        "batch_idx": 0,
        "head_idx": 1,
        "token_idx": 1,
        "token_error": 9.590501576894894e-06,
        "entropy_ref": 0.6931346654891968,
        "max_attention_weight_ref": 0.5025036334991455,
        "attention_weight_error": 2.384185791015625e-07,
        "stage_errors": {
          "storage_error": 1.9542741938494146e-05,
          "matmul1_error": 8.533129956995979e-10,
          "softmax_error": 5.279813194647431e-07,
          "matmul2_error": 7.120353529899148e-07,
          "demote_error": 5.279813194647432e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 5,
        "token_idx": 0,
        "token_error": 9.466602932661772e-06,
        "entropy_ref": -0.0,
        "max_attention_weight_ref": 1.0,
        "attention_weight_error": 0.0,
        "stage_errors": {
          "storage_error": 2.1607638245768612e-05,
          "matmul1_error": 1.1857344790261374e-09,
          "softmax_error": 7.537237252108753e-07,
          "matmul2_error": 7.11791244611959e-07,
          "demote_error": 7.537237252108753e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 6,
        "token_idx": 0,
        "token_error": 9.003692866826896e-06,
        "entropy_ref": -0.0,
        "max_attention_weight_ref": 1.0,
        "attention_weight_error": 0.0,
        "stage_errors": {
          "storage_error": 2.2850224922876805e-05,
          "matmul1_error": 1.3761141990667538e-09,
          "softmax_error": 8.938644896261394e-07,
          "matmul2_error": 7.107838428055403e-07,
          "demote_error": 8.938644896261394e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 4,
        "token_idx": 1,
        "token_error": 8.731272828299552e-06,
        "entropy_ref": 0.6931189298629761,
        "max_attention_weight_ref": 0.5037587285041809,
        "attention_weight_error": 7.152557373046875e-07,
        "stage_errors": {
          "storage_error": 2.0049269096489297e-05,
          "matmul1_error": 9.927120544374356e-10,
          "softmax_error": 6.195215974003077e-07,
          "matmul2_error": 6.772445431124652e-07,
          "demote_error": 6.195215974003076e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 3,
        "token_idx": 1,
        "token_error": 8.649672963656485e-06,
        "entropy_ref": 0.6931288242340088,
        "max_attention_weight_ref": 0.5030317306518555,
        "attention_weight_error": 2.384185791015625e-07,
        "stage_errors": {
          "storage_error": 2.1079802081658272e-05,
          "matmul1_error": 1.1172747873277782e-09,
          "softmax_error": 7.092816304066219e-07,
          "matmul2_error": 7.025430022622459e-07,
          "demote_error": 7.092816304066218e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 3,
        "token_idx": 0,
        "token_error": 7.971320883370936e-06,
        "entropy_ref": -0.0,
        "max_attention_weight_ref": 1.0,
        "attention_weight_error": 0.0,
        "stage_errors": {
          "storage_error": 2.002864266614779e-05,
          "matmul1_error": 9.516940275752975e-10,
          "softmax_error": 6.041656888555736e-07,
          "matmul2_error": 7.025430022622459e-07,
          "demote_error": 6.041656888555735e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 6,
        "token_idx": 2,
        "token_error": 7.795451892889105e-06,
        "entropy_ref": 1.098599910736084,
        "max_attention_weight_ref": 0.33567875623703003,
        "attention_weight_error": 5.960464477539062e-07,
        "stage_errors": {
          "storage_error": 1.8087266653310508e-05,
          "matmul1_error": 6.4285154232401e-10,
          "softmax_error": 4.175686626695097e-07,
          "matmul2_error": 7.107838428055403e-07,
          "demote_error": 4.175686626695097e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 6,
        "token_idx": 1,
        "token_error": 7.40948598831892e-06,
        "entropy_ref": 0.6930944919586182,
        "max_attention_weight_ref": 0.5051323771476746,
        "attention_weight_error": 2.086162567138672e-07,
        "stage_errors": {
          "storage_error": 2.128292544512078e-05,
          "matmul1_error": 1.1348267231058225e-09,
          "softmax_error": 7.371345418505371e-07,
          "matmul2_error": 7.107838428055403e-07,
          "demote_error": 7.371345418505371e-08
        }
      }
    ],
    "head_analysis": [
      {
        "head_idx": 0,
        "avg_error": 1.8605826426210115e-06,
        "avg_entropy": 3.878161907196045,
        "avg_max_weight": 0.04284175857901573,
        "sparsity": 0.6947021484375
      },
      {
        "head_idx": 1,
        "avg_error": 1.7345480500807753e-06,
        "avg_entropy": 3.878162145614624,
        "avg_max_weight": 0.04284851998090744,
        "sparsity": 0.6943359375
      },
      {
        "head_idx": 2,
        "avg_error": 1.7396980638295645e-06,
        "avg_entropy": 3.8781614303588867,
        "avg_max_weight": 0.04287487268447876,
        "sparsity": 0.6949462890625
      },
      {
        "head_idx": 3,
        "avg_error": 1.8062949038721854e-06,
        "avg_entropy": 3.878161907196045,
        "avg_max_weight": 0.04286621883511543,
        "sparsity": 0.695068359375
      },
      {
        "head_idx": 4,
        "avg_error": 1.7625119426156743e-06,
        "avg_entropy": 3.878161668777466,
        "avg_max_weight": 0.04287762939929962,
        "sparsity": 0.69488525390625
      },
      {
        "head_idx": 5,
        "avg_error": 1.7115565924541443e-06,
        "avg_entropy": 3.8781614303588867,
        "avg_max_weight": 0.04288235306739807,
        "sparsity": 0.69476318359375
      },
      {
        "head_idx": 6,
        "avg_error": 1.867982291514636e-06,
        "avg_entropy": 3.878162145614624,
        "avg_max_weight": 0.04285358265042305,
        "sparsity": 0.695068359375
      },
      {
        "head_idx": 7,
        "avg_error": 1.8230965679322253e-06,
        "avg_entropy": 3.878161907196045,
        "avg_max_weight": 0.0428629145026207,
        "sparsity": 0.695068359375
      }
    ]
  }
}
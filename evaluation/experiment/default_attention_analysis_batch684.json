{
  "detector": {
    "detected_exceeded": false,
    "actual_err": 3.8564205169677734e-05,
    "predicted_bound": 0.00010626014482113534,
    "elapsed_sec": 3.068024158477783
  },
  "analyzer_report": {
    "component_estimates": {
      "input_storage_error": 3.5628676414489746e-05,
      "matmul1_accumulation_error": 3.5628676414489746e-05,
      "scaling_error": 3.5628676414489746e-05,
      "softmax_numerical_error": 3.5628676414489746e-05,
      "matmul2_accumulation_error": 3.5628676414489746e-05,
      "output_demote_error": 6.604939699172974e-05
    },
    "component_ratios": {
      "input_storage_error": 0.14590389016018307,
      "matmul1_accumulation_error": 0.14590389016018307,
      "scaling_error": 0.14590389016018307,
      "softmax_numerical_error": 0.14590389016018307,
      "matmul2_accumulation_error": 0.14590389016018307,
      "output_demote_error": 0.27048054919908465
    },
    "primary_source": "storage_error",
    "suggestion": "\u4e3b\u8981\u8bef\u5dee\u6765\u6e90\u4e3a\u8f93\u5165\u5b58\u50a8\u7cbe\u5ea6\u3002\u5efa\u8bae\uff1a\u63d0\u5347Q/K/V\u7684\u5b58\u50a8\u7cbe\u5ea6\uff1b\u8fdb\u884c\u8f93\u5165\u5f52\u4e00\u5316\uff1b\u68c0\u67e5embedding\u5c42\u7684\u8f93\u51fa\u8303\u56f4\u3002 \u68c0\u6d4b\u5230\u5927\u91cf\u5c16\u9510\u7684attention\u6a21\u5f0f\uff08\u4f4e\u71b5\uff09\uff0c\u8fd9\u4f1a\u653e\u5927softmax\u7684\u6570\u503c\u8bef\u5dee\u3002\u8003\u8651\u4f7f\u7528attention dropout\u6216\u6e29\u5ea6\u7f29\u653e\u3002",
    "attention_pattern_stats": {
      "global_avg_entropy": 3.8781614303588867,
      "global_sparsity": 0.69482421875,
      "max_attention_weight": 1.0,
      "min_attention_weight": 0.0
    },
    "attention_behavior_stats": {
      "high_entropy_tokens": 0,
      "low_entropy_tokens": 7,
      "total_analyzed": 8
    },
    "top_tokens_summary": [
      {
        "batch_idx": 0,
        "head_idx": 6,
        "token_idx": 1,
        "token_error": 9.764591595740058e-06,
        "entropy_ref": 0.6931422352790833,
        "max_attention_weight_ref": 0.5015727877616882,
        "attention_weight_error": 7.152557373046875e-07,
        "stage_errors": {
          "storage_error": 1.7978618416236714e-05,
          "matmul1_error": 6.420142963577128e-10,
          "softmax_error": 4.0006852941587567e-07,
          "matmul2_error": 6.88582531438442e-07,
          "demote_error": 4.000685294158757e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 3,
        "token_idx": 1,
        "token_error": 8.443628757959232e-06,
        "entropy_ref": 0.6931140422821045,
        "max_attention_weight_ref": 0.5040730834007263,
        "attention_weight_error": 1.3113021850585938e-06,
        "stage_errors": {
          "storage_error": 2.1363913674576906e-05,
          "matmul1_error": 1.1258933444553378e-09,
          "softmax_error": 7.150592864491045e-07,
          "matmul2_error": 7.25474728824338e-07,
          "demote_error": 7.150592864491046e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 5,
        "token_idx": 1,
        "token_error": 7.784321496728808e-06,
        "entropy_ref": 0.693071722984314,
        "max_attention_weight_ref": 0.5061418414115906,
        "attention_weight_error": 1.8775463104248047e-06,
        "stage_errors": {
          "storage_error": 2.1985586499795318e-05,
          "matmul1_error": 1.2547827669232041e-09,
          "softmax_error": 8.00461566541344e-07,
          "matmul2_error": 7.053206900309306e-07,
          "demote_error": 8.00461566541344e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 3,
        "token_idx": 0,
        "token_error": 7.778209692332894e-06,
        "entropy_ref": -0.0,
        "max_attention_weight_ref": 1.0,
        "attention_weight_error": 0.0,
        "stage_errors": {
          "storage_error": 2.126979188687983e-05,
          "matmul1_error": 1.1110734412186961e-09,
          "softmax_error": 7.056471076793969e-07,
          "matmul2_error": 7.25474728824338e-07,
          "demote_error": 7.056471076793969e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 1,
        "token_idx": 1,
        "token_error": 7.716014806646854e-06,
        "entropy_ref": 0.6931325197219849,
        "max_attention_weight_ref": 0.5027086734771729,
        "attention_weight_error": 6.854534149169922e-07,
        "stage_errors": {
          "storage_error": 1.9979408534709364e-05,
          "matmul1_error": 9.610927611807593e-10,
          "softmax_error": 6.046502676326782e-07,
          "matmul2_error": 6.908233444846701e-07,
          "demote_error": 6.046502676326782e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 7,
        "token_idx": 0,
        "token_error": 7.659426046302542e-06,
        "entropy_ref": -0.0,
        "max_attention_weight_ref": 1.0,
        "attention_weight_error": 0.0,
        "stage_errors": {
          "storage_error": 2.1388104414654663e-05,
          "matmul1_error": 1.1863639897723305e-09,
          "softmax_error": 7.448879841831513e-07,
          "matmul2_error": 6.900531843712088e-07,
          "demote_error": 7.448879841831513e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 2,
        "token_idx": 0,
        "token_error": 7.658061804249883e-06,
        "entropy_ref": -0.0,
        "max_attention_weight_ref": 1.0,
        "attention_weight_error": 0.0,
        "stage_errors": {
          "storage_error": 2.099771791108651e-05,
          "matmul1_error": 1.0948525323787844e-09,
          "softmax_error": 6.71394809614867e-07,
          "matmul2_error": 7.076966539898422e-07,
          "demote_error": 6.71394809614867e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 1,
        "token_idx": 3,
        "token_error": 7.40657196729444e-06,
        "entropy_ref": 1.3862721920013428,
        "max_attention_weight_ref": 0.25247734785079956,
        "attention_weight_error": 6.407499313354492e-07,
        "stage_errors": {
          "storage_error": 1.978225918719545e-05,
          "matmul1_error": 9.297558345456353e-10,
          "softmax_error": 5.849353328812868e-07,
          "matmul2_error": 6.908233444846701e-07,
          "demote_error": 5.8493533288128674e-08
        }
      }
    ],
    "head_analysis": [
      {
        "head_idx": 0,
        "avg_error": 1.933742396431626e-06,
        "avg_entropy": 3.878161668777466,
        "avg_max_weight": 0.042864955961704254,
        "sparsity": 0.69482421875
      },
      {
        "head_idx": 1,
        "avg_error": 1.993316118387156e-06,
        "avg_entropy": 3.8781611919403076,
        "avg_max_weight": 0.04289127141237259,
        "sparsity": 0.69464111328125
      },
      {
        "head_idx": 2,
        "avg_error": 1.6566937119932845e-06,
        "avg_entropy": 3.8781607151031494,
        "avg_max_weight": 0.04290025681257248,
        "sparsity": 0.6944580078125
      },
      {
        "head_idx": 3,
        "avg_error": 1.7554325495439116e-06,
        "avg_entropy": 3.878161907196045,
        "avg_max_weight": 0.04286555200815201,
        "sparsity": 0.69476318359375
      },
      {
        "head_idx": 4,
        "avg_error": 1.7972197383642197e-06,
        "avg_entropy": 3.8781611919403076,
        "avg_max_weight": 0.042895156890153885,
        "sparsity": 0.6949462890625
      },
      {
        "head_idx": 5,
        "avg_error": 1.770889184626867e-06,
        "avg_entropy": 3.8781609535217285,
        "avg_max_weight": 0.042910583317279816,
        "sparsity": 0.69482421875
      },
      {
        "head_idx": 6,
        "avg_error": 1.8790119611367118e-06,
        "avg_entropy": 3.878161907196045,
        "avg_max_weight": 0.04286042973399162,
        "sparsity": 0.69512939453125
      },
      {
        "head_idx": 7,
        "avg_error": 1.6871372281457298e-06,
        "avg_entropy": 3.8781614303588867,
        "avg_max_weight": 0.04287813603878021,
        "sparsity": 0.69500732421875
      }
    ]
  }
}
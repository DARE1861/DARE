{
  "detector": {
    "detected_exceeded": false,
    "actual_err": 5.6415796279907227e-05,
    "predicted_bound": 0.00014486727741314098,
    "elapsed_sec": 3.104947090148926
  },
  "analyzer_report": {
    "component_estimates": {
      "input_storage_error": 5.6415796279907227e-05,
      "matmul1_accumulation_error": 5.6415796279907227e-05,
      "scaling_error": 5.6415796279907227e-05,
      "softmax_numerical_error": 5.6415796279907227e-05,
      "matmul2_accumulation_error": 5.6415796279907227e-05,
      "output_demote_error": 8.879601955413818e-05
    },
    "component_ratios": {
      "input_storage_error": 0.15211539234199847,
      "matmul1_accumulation_error": 0.15211539234199847,
      "scaling_error": 0.15211539234199847,
      "softmax_numerical_error": 0.15211539234199847,
      "matmul2_accumulation_error": 0.15211539234199847,
      "output_demote_error": 0.23942303829000763
    },
    "primary_source": "storage_error",
    "suggestion": "\u4e3b\u8981\u8bef\u5dee\u6765\u6e90\u4e3a\u8f93\u5165\u5b58\u50a8\u7cbe\u5ea6\u3002\u5efa\u8bae\uff1a\u63d0\u5347Q/K/V\u7684\u5b58\u50a8\u7cbe\u5ea6\uff1b\u8fdb\u884c\u8f93\u5165\u5f52\u4e00\u5316\uff1b\u68c0\u67e5embedding\u5c42\u7684\u8f93\u51fa\u8303\u56f4\u3002 \u68c0\u6d4b\u5230\u5927\u91cf\u5c16\u9510\u7684attention\u6a21\u5f0f\uff08\u4f4e\u71b5\uff09\uff0c\u8fd9\u4f1a\u653e\u5927softmax\u7684\u6570\u503c\u8bef\u5dee\u3002\u8003\u8651\u4f7f\u7528attention dropout\u6216\u6e29\u5ea6\u7f29\u653e\u3002",
    "attention_pattern_stats": {
      "global_avg_entropy": 3.878161907196045,
      "global_sparsity": 0.6948928833007812,
      "max_attention_weight": 1.0,
      "min_attention_weight": 0.0
    },
    "attention_behavior_stats": {
      "high_entropy_tokens": 0,
      "low_entropy_tokens": 7,
      "total_analyzed": 8
    },
    "top_tokens_summary": [
      {
        "batch_idx": 0,
        "head_idx": 2,
        "token_idx": 0,
        "token_error": 1.012015127344057e-05,
        "entropy_ref": -0.0,
        "max_attention_weight_ref": 1.0,
        "attention_weight_error": 0.0,
        "stage_errors": {
          "storage_error": 2.162438659070176e-05,
          "matmul1_error": 1.211829453500118e-09,
          "softmax_error": 7.369410013779998e-07,
          "matmul2_error": 6.987664619373391e-07,
          "demote_error": 7.369410013779998e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 1,
        "token_idx": 1,
        "token_error": 8.8355373009108e-06,
        "entropy_ref": 0.6931331157684326,
        "max_attention_weight_ref": 0.5026513934135437,
        "attention_weight_error": 1.4901161193847656e-07,
        "stage_errors": {
          "storage_error": 2.0146781025687233e-05,
          "matmul1_error": 9.629705926240472e-10,
          "softmax_error": 5.932721251156182e-07,
          "matmul2_error": 7.040675427560928e-07,
          "demote_error": 5.932721251156181e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 7,
        "token_idx": 0,
        "token_error": 8.104929293040186e-06,
        "entropy_ref": -0.0,
        "max_attention_weight_ref": 1.0,
        "attention_weight_error": 0.0,
        "stage_errors": {
          "storage_error": 1.999153346332605e-05,
          "matmul1_error": 9.318750430258338e-10,
          "softmax_error": 5.89259434491396e-07,
          "matmul2_error": 7.109921170922463e-07,
          "demote_error": 5.89259434491396e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 2,
        "token_idx": 1,
        "token_error": 7.746813935227692e-06,
        "entropy_ref": 0.6931272745132446,
        "max_attention_weight_ref": 0.5031526684761047,
        "attention_weight_error": 4.172325134277344e-07,
        "stage_errors": {
          "storage_error": 2.1512998955586227e-05,
          "matmul1_error": 1.1935128152975583e-09,
          "softmax_error": 7.258022378664464e-07,
          "matmul2_error": 6.987664619373391e-07,
          "demote_error": 7.258022378664464e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 0,
        "token_idx": 0,
        "token_error": 7.5606731115840375e-06,
        "entropy_ref": -0.0,
        "max_attention_weight_ref": 1.0,
        "attention_weight_error": 0.0,
        "stage_errors": {
          "storage_error": 2.118410793627845e-05,
          "matmul1_error": 1.14444263431605e-09,
          "softmax_error": 7.189984899014235e-07,
          "matmul2_error": 6.959658094274346e-07,
          "demote_error": 7.189984899014235e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 0,
        "token_idx": 1,
        "token_error": 7.5115240179002285e-06,
        "entropy_ref": 0.6931315064430237,
        "max_attention_weight_ref": 0.5027971267700195,
        "attention_weight_error": 1.4901161193847656e-07,
        "stage_errors": {
          "storage_error": 1.8960944544232916e-05,
          "matmul1_error": 7.905777785975872e-10,
          "softmax_error": 4.9668215069687e-07,
          "matmul2_error": 6.959658094274346e-07,
          "demote_error": 4.966821506968699e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 3,
        "token_idx": 2,
        "token_error": 7.324279977183323e-06,
        "entropy_ref": 1.0986027717590332,
        "max_attention_weight_ref": 0.3353358805179596,
        "attention_weight_error": 6.556510925292969e-07,
        "stage_errors": {
          "storage_error": 2.103246788465185e-05,
          "matmul1_error": 1.1033939660051475e-09,
          "softmax_error": 6.971393304411322e-07,
          "matmul2_error": 7.066262696753256e-07,
          "demote_error": 6.971393304411322e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 4,
        "token_idx": 0,
        "token_error": 7.323003956116736e-06,
        "entropy_ref": -0.0,
        "max_attention_weight_ref": 1.0,
        "attention_weight_error": 0.0,
        "stage_errors": {
          "storage_error": 2.0135486010985915e-05,
          "matmul1_error": 9.963073723245327e-10,
          "softmax_error": 6.215548637555913e-07,
          "matmul2_error": 6.83593179928721e-07,
          "demote_error": 6.215548637555913e-08
        }
      }
    ],
    "head_analysis": [
      {
        "head_idx": 0,
        "avg_error": 1.841991661422071e-06,
        "avg_entropy": 3.878161907196045,
        "avg_max_weight": 0.0428534671664238,
        "sparsity": 0.6949462890625
      },
      {
        "head_idx": 1,
        "avg_error": 1.7985151998800575e-06,
        "avg_entropy": 3.8781614303588867,
        "avg_max_weight": 0.04286270588636398,
        "sparsity": 0.6949462890625
      },
      {
        "head_idx": 2,
        "avg_error": 1.7657069975030026e-06,
        "avg_entropy": 3.8781609535217285,
        "avg_max_weight": 0.042887911200523376,
        "sparsity": 0.69488525390625
      },
      {
        "head_idx": 3,
        "avg_error": 1.8990663193108048e-06,
        "avg_entropy": 3.878162145614624,
        "avg_max_weight": 0.042841047048568726,
        "sparsity": 0.69482421875
      },
      {
        "head_idx": 4,
        "avg_error": 1.7530628610984422e-06,
        "avg_entropy": 3.878161907196045,
        "avg_max_weight": 0.04286207631230354,
        "sparsity": 0.69488525390625
      },
      {
        "head_idx": 5,
        "avg_error": 1.7815301589507726e-06,
        "avg_entropy": 3.878161907196045,
        "avg_max_weight": 0.042869266122579575,
        "sparsity": 0.69500732421875
      },
      {
        "head_idx": 6,
        "avg_error": 1.7081015357689466e-06,
        "avg_entropy": 3.878161668777466,
        "avg_max_weight": 0.042871128767728806,
        "sparsity": 0.69500732421875
      },
      {
        "head_idx": 7,
        "avg_error": 1.7681825283943908e-06,
        "avg_entropy": 3.878161668777466,
        "avg_max_weight": 0.04286988079547882,
        "sparsity": 0.69464111328125
      }
    ]
  }
}
{
  "detector": {
    "detected_exceeded": false,
    "actual_err": 5.793571472167969e-05,
    "predicted_bound": 0.00013032221177127214,
    "elapsed_sec": 2.9776673316955566
  },
  "analyzer_report": {
    "component_estimates": {
      "input_storage_error": 5.793571472167969e-05,
      "matmul1_accumulation_error": 5.793571472167969e-05,
      "scaling_error": 5.793571472167969e-05,
      "softmax_numerical_error": 5.793571472167969e-05,
      "matmul2_accumulation_error": 5.793571472167969e-05,
      "output_demote_error": 9.222328662872314e-05
    },
    "component_ratios": {
      "input_storage_error": 0.15170314877677632,
      "matmul1_accumulation_error": 0.15170314877677632,
      "scaling_error": 0.15170314877677632,
      "softmax_numerical_error": 0.15170314877677632,
      "matmul2_accumulation_error": 0.15170314877677632,
      "output_demote_error": 0.24148425611611846
    },
    "primary_source": "storage_error",
    "suggestion": "\u4e3b\u8981\u8bef\u5dee\u6765\u6e90\u4e3a\u8f93\u5165\u5b58\u50a8\u7cbe\u5ea6\u3002\u5efa\u8bae\uff1a\u63d0\u5347Q/K/V\u7684\u5b58\u50a8\u7cbe\u5ea6\uff1b\u8fdb\u884c\u8f93\u5165\u5f52\u4e00\u5316\uff1b\u68c0\u67e5embedding\u5c42\u7684\u8f93\u51fa\u8303\u56f4\u3002 \u68c0\u6d4b\u5230\u5927\u91cf\u5c16\u9510\u7684attention\u6a21\u5f0f\uff08\u4f4e\u71b5\uff09\uff0c\u8fd9\u4f1a\u653e\u5927softmax\u7684\u6570\u503c\u8bef\u5dee\u3002\u8003\u8651\u4f7f\u7528attention dropout\u6216\u6e29\u5ea6\u7f29\u653e\u3002",
    "attention_pattern_stats": {
      "global_avg_entropy": 3.878161668777466,
      "global_sparsity": 0.6948318481445312,
      "max_attention_weight": 1.0,
      "min_attention_weight": 0.0
    },
    "attention_behavior_stats": {
      "high_entropy_tokens": 0,
      "low_entropy_tokens": 7,
      "total_analyzed": 8
    },
    "top_tokens_summary": [
      {
        "batch_idx": 0,
        "head_idx": 4,
        "token_idx": 1,
        "token_error": 9.250245057046413e-06,
        "entropy_ref": 0.6931194067001343,
        "max_attention_weight_ref": 0.5037262439727783,
        "attention_weight_error": 2.2649765014648438e-06,
        "stage_errors": {
          "storage_error": 2.256095149277826e-05,
          "matmul1_error": 1.3351470379837852e-09,
          "softmax_error": 8.27992698759772e-07,
          "matmul2_error": 7.154666946007638e-07,
          "demote_error": 8.279926987597718e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 0,
        "token_idx": 1,
        "token_error": 9.186518582282588e-06,
        "entropy_ref": 0.6931284666061401,
        "max_attention_weight_ref": 0.5030604004859924,
        "attention_weight_error": 4.470348358154297e-07,
        "stage_errors": {
          "storage_error": 2.093668717861874e-05,
          "matmul1_error": 1.100413309049738e-09,
          "softmax_error": 7.07901199348271e-07,
          "matmul2_error": 6.987810138525675e-07,
          "demote_error": 7.079011993482709e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 1,
        "token_idx": 0,
        "token_error": 8.612585588707589e-06,
        "entropy_ref": -0.0,
        "max_attention_weight_ref": 1.0,
        "attention_weight_error": 0.0,
        "stage_errors": {
          "storage_error": 2.1384068077168195e-05,
          "matmul1_error": 1.1422536352615504e-09,
          "softmax_error": 7.26046710042283e-07,
          "matmul2_error": 7.170748631324386e-07,
          "demote_error": 7.26046710042283e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 4,
        "token_idx": 0,
        "token_error": 7.899356205598451e-06,
        "entropy_ref": -0.0,
        "max_attention_weight_ref": 1.0,
        "attention_weight_error": 0.0,
        "stage_errors": {
          "storage_error": 1.9963798422395485e-05,
          "matmul1_error": 9.163533415772769e-10,
          "softmax_error": 5.682773917214945e-07,
          "matmul2_error": 7.154666946007638e-07,
          "demote_error": 5.682773917214945e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 0,
        "token_idx": 0,
        "token_error": 7.742220077489037e-06,
        "entropy_ref": -0.0,
        "max_attention_weight_ref": 1.0,
        "attention_weight_error": 0.0,
        "stage_errors": {
          "storage_error": 2.0985845367249567e-05,
          "matmul1_error": 1.1080548168008114e-09,
          "softmax_error": 7.128170182113537e-07,
          "matmul2_error": 6.987810138525675e-07,
          "demote_error": 7.128170182113535e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 6,
        "token_idx": 1,
        "token_error": 7.644742254342418e-06,
        "entropy_ref": 0.6931403279304504,
        "max_attention_weight_ref": 0.501853346824646,
        "attention_weight_error": 4.470348358154297e-07,
        "stage_errors": {
          "storage_error": 2.0715709069918375e-05,
          "matmul1_error": 1.0539642944110486e-09,
          "softmax_error": 6.697548087686301e-07,
          "matmul2_error": 7.063514203764499e-07,
          "demote_error": 6.697548087686301e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 2,
        "token_idx": 1,
        "token_error": 7.446840754710138e-06,
        "entropy_ref": 0.6930878162384033,
        "max_attention_weight_ref": 0.5054491758346558,
        "attention_weight_error": 1.7881393432617188e-07,
        "stage_errors": {
          "storage_error": 2.3489513750973856e-05,
          "matmul1_error": 1.4934003637378197e-09,
          "softmax_error": 9.20613092603162e-07,
          "matmul2_error": 7.114291292964482e-07,
          "demote_error": 9.206130926031619e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 2,
        "token_idx": 3,
        "token_error": 7.311955414479598e-06,
        "entropy_ref": 1.3862721920013428,
        "max_attention_weight_ref": 0.2526678442955017,
        "attention_weight_error": 7.599592208862305e-07,
        "stage_errors": {
          "storage_error": 1.997230128836236e-05,
          "matmul1_error": 9.228451095044996e-10,
          "softmax_error": 5.688918463420123e-07,
          "matmul2_error": 7.114291292964482e-07,
          "demote_error": 5.688918463420123e-08
        }
      }
    ],
    "head_analysis": [
      {
        "head_idx": 0,
        "avg_error": 1.935398358909879e-06,
        "avg_entropy": 3.878162145614624,
        "avg_max_weight": 0.04285874962806702,
        "sparsity": 0.6949462890625
      },
      {
        "head_idx": 1,
        "avg_error": 1.9127962787024444e-06,
        "avg_entropy": 3.878162145614624,
        "avg_max_weight": 0.04284600913524628,
        "sparsity": 0.6949462890625
      },
      {
        "head_idx": 2,
        "avg_error": 1.7783387420422514e-06,
        "avg_entropy": 3.8781611919403076,
        "avg_max_weight": 0.04290124773979187,
        "sparsity": 0.69451904296875
      },
      {
        "head_idx": 3,
        "avg_error": 1.7878853668662487e-06,
        "avg_entropy": 3.878162384033203,
        "avg_max_weight": 0.04285074397921562,
        "sparsity": 0.6949462890625
      },
      {
        "head_idx": 4,
        "avg_error": 1.7373172340739984e-06,
        "avg_entropy": 3.878161907196045,
        "avg_max_weight": 0.04286663606762886,
        "sparsity": 0.69476318359375
      },
      {
        "head_idx": 5,
        "avg_error": 1.5965207467161235e-06,
        "avg_entropy": 3.878162145614624,
        "avg_max_weight": 0.042842864990234375,
        "sparsity": 0.69482421875
      },
      {
        "head_idx": 6,
        "avg_error": 1.8726652797340648e-06,
        "avg_entropy": 3.878161907196045,
        "avg_max_weight": 0.04285347834229469,
        "sparsity": 0.69476318359375
      },
      {
        "head_idx": 7,
        "avg_error": 1.66629581599409e-06,
        "avg_entropy": 3.878162145614624,
        "avg_max_weight": 0.04283731430768967,
        "sparsity": 0.6949462890625
      }
    ]
  }
}
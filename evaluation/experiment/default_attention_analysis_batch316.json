{
  "detector": {
    "detected_exceeded": false,
    "actual_err": 5.848705768585205e-05,
    "predicted_bound": 0.00013240590487839654,
    "elapsed_sec": 2.988603353500366
  },
  "analyzer_report": {
    "component_estimates": {
      "input_storage_error": 5.848705768585205e-05,
      "matmul1_accumulation_error": 5.848705768585205e-05,
      "scaling_error": 5.848705768585205e-05,
      "softmax_numerical_error": 5.848705768585205e-05,
      "matmul2_accumulation_error": 5.848705768585205e-05,
      "output_demote_error": 8.080154657363892e-05
    },
    "component_ratios": {
      "input_storage_error": 0.15670226569517917,
      "matmul1_accumulation_error": 0.15670226569517917,
      "scaling_error": 0.15670226569517917,
      "softmax_numerical_error": 0.15670226569517917,
      "matmul2_accumulation_error": 0.15670226569517917,
      "output_demote_error": 0.2164886715241042
    },
    "primary_source": "storage_error",
    "suggestion": "\u4e3b\u8981\u8bef\u5dee\u6765\u6e90\u4e3a\u8f93\u5165\u5b58\u50a8\u7cbe\u5ea6\u3002\u5efa\u8bae\uff1a\u63d0\u5347Q/K/V\u7684\u5b58\u50a8\u7cbe\u5ea6\uff1b\u8fdb\u884c\u8f93\u5165\u5f52\u4e00\u5316\uff1b\u68c0\u67e5embedding\u5c42\u7684\u8f93\u51fa\u8303\u56f4\u3002 \u68c0\u6d4b\u5230\u5927\u91cf\u5c16\u9510\u7684attention\u6a21\u5f0f\uff08\u4f4e\u71b5\uff09\uff0c\u8fd9\u4f1a\u653e\u5927softmax\u7684\u6570\u503c\u8bef\u5dee\u3002\u8003\u8651\u4f7f\u7528attention dropout\u6216\u6e29\u5ea6\u7f29\u653e\u3002",
    "attention_pattern_stats": {
      "global_avg_entropy": 3.8781614303588867,
      "global_sparsity": 0.6948623657226562,
      "max_attention_weight": 1.0,
      "min_attention_weight": 0.0
    },
    "attention_behavior_stats": {
      "high_entropy_tokens": 0,
      "low_entropy_tokens": 7,
      "total_analyzed": 8
    },
    "top_tokens_summary": [
      {
        "batch_idx": 0,
        "head_idx": 4,
        "token_idx": 1,
        "token_error": 9.399445843882859e-06,
        "entropy_ref": 0.6931246519088745,
        "max_attention_weight_ref": 0.5033555030822754,
        "attention_weight_error": 1.1026859283447266e-06,
        "stage_errors": {
          "storage_error": 2.076594364552875e-05,
          "matmul1_error": 1.069989328114636e-09,
          "softmax_error": 6.75017508910969e-07,
          "matmul2_error": 7.010425179032609e-07,
          "demote_error": 6.75017508910969e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 7,
        "token_idx": 1,
        "token_error": 9.221734217135236e-06,
        "entropy_ref": 0.6931290030479431,
        "max_attention_weight_ref": 0.5030145049095154,
        "attention_weight_error": 8.046627044677734e-07,
        "stage_errors": {
          "storage_error": 2.1426044895633822e-05,
          "matmul1_error": 1.2155486943253938e-09,
          "softmax_error": 7.455964805558324e-07,
          "matmul2_error": 6.765087618987309e-07,
          "demote_error": 7.455964805558324e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 6,
        "token_idx": 0,
        "token_error": 8.900438842829317e-06,
        "entropy_ref": -0.0,
        "max_attention_weight_ref": 1.0,
        "attention_weight_error": 0.0,
        "stage_errors": {
          "storage_error": 2.0993662474211305e-05,
          "matmul1_error": 1.0885006576246255e-09,
          "softmax_error": 6.752394256182016e-07,
          "matmul2_error": 7.11707116352045e-07,
          "demote_error": 6.752394256182015e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 3,
        "token_idx": 1,
        "token_error": 8.875394996721298e-06,
        "entropy_ref": 0.6931131482124329,
        "max_attention_weight_ref": 0.50412517786026,
        "attention_weight_error": 3.8743019104003906e-07,
        "stage_errors": {
          "storage_error": 2.249595172543195e-05,
          "matmul1_error": 1.351870000946074e-09,
          "softmax_error": 8.57832856127061e-07,
          "matmul2_error": 6.953005595278228e-07,
          "demote_error": 8.57832856127061e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 2,
        "token_idx": 1,
        "token_error": 8.387782145291567e-06,
        "entropy_ref": 0.69312584400177,
        "max_attention_weight_ref": 0.5032649040222168,
        "attention_weight_error": 2.980232238769531e-07,
        "stage_errors": {
          "storage_error": 1.943670440596179e-05,
          "matmul1_error": 8.250830347775544e-10,
          "softmax_error": 5.108995537739247e-07,
          "matmul2_error": 7.19052059139358e-07,
          "demote_error": 5.108995537739247e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 7,
        "token_idx": 0,
        "token_error": 8.363618690054864e-06,
        "entropy_ref": -0.0,
        "max_attention_weight_ref": 1.0,
        "attention_weight_error": 0.0,
        "stage_errors": {
          "storage_error": 2.1516295873880154e-05,
          "matmul1_error": 1.2302623446214808e-09,
          "softmax_error": 7.546215783804656e-07,
          "matmul2_error": 6.765087618987309e-07,
          "demote_error": 7.546215783804655e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 0,
        "token_idx": 2,
        "token_error": 8.241295290645212e-06,
        "entropy_ref": 1.098592758178711,
        "max_attention_weight_ref": 0.3362031877040863,
        "attention_weight_error": 1.7881393432617188e-07,
        "stage_errors": {
          "storage_error": 2.1939036741969176e-05,
          "matmul1_error": 1.268656495438416e-09,
          "softmax_error": 7.900038326624781e-07,
          "matmul2_error": 6.94191567163216e-07,
          "demote_error": 7.90003832662478e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 5,
        "token_idx": 1,
        "token_error": 7.940121577121317e-06,
        "entropy_ref": 0.6931248307228088,
        "max_attention_weight_ref": 0.5033412575721741,
        "attention_weight_error": 2.9802322387695312e-08,
        "stage_errors": {
          "storage_error": 2.0374867290229304e-05,
          "matmul1_error": 1.0145648693256102e-09,
          "softmax_error": 6.37370249023661e-07,
          "matmul2_error": 6.966343789827079e-07,
          "demote_error": 6.373702490236611e-08
        }
      }
    ],
    "head_analysis": [
      {
        "head_idx": 0,
        "avg_error": 1.7953373117052251e-06,
        "avg_entropy": 3.878162145614624,
        "avg_max_weight": 0.04285376891493797,
        "sparsity": 0.69482421875
      },
      {
        "head_idx": 1,
        "avg_error": 1.7924637631949736e-06,
        "avg_entropy": 3.878162145614624,
        "avg_max_weight": 0.04284127056598663,
        "sparsity": 0.69476318359375
      },
      {
        "head_idx": 2,
        "avg_error": 1.7988282934311428e-06,
        "avg_entropy": 3.8781614303588867,
        "avg_max_weight": 0.042884208261966705,
        "sparsity": 0.695068359375
      },
      {
        "head_idx": 3,
        "avg_error": 1.890092107714736e-06,
        "avg_entropy": 3.878161668777466,
        "avg_max_weight": 0.04287440702319145,
        "sparsity": 0.6949462890625
      },
      {
        "head_idx": 4,
        "avg_error": 1.941912842085003e-06,
        "avg_entropy": 3.878162145614624,
        "avg_max_weight": 0.04283900186419487,
        "sparsity": 0.69476318359375
      },
      {
        "head_idx": 5,
        "avg_error": 1.9336785044288263e-06,
        "avg_entropy": 3.878161668777466,
        "avg_max_weight": 0.04286844655871391,
        "sparsity": 0.6947021484375
      },
      {
        "head_idx": 6,
        "avg_error": 1.955504558281973e-06,
        "avg_entropy": 3.8781611919403076,
        "avg_max_weight": 0.04287569224834442,
        "sparsity": 0.6949462890625
      },
      {
        "head_idx": 7,
        "avg_error": 1.8409044741929392e-06,
        "avg_entropy": 3.8781604766845703,
        "avg_max_weight": 0.04291059821844101,
        "sparsity": 0.69488525390625
      }
    ]
  }
}
{
  "detector": {
    "detected_exceeded": false,
    "actual_err": 4.41819429397583e-05,
    "predicted_bound": 0.00011784001399064437,
    "elapsed_sec": 2.9877734184265137
  },
  "analyzer_report": {
    "component_estimates": {
      "input_storage_error": 4.41819429397583e-05,
      "matmul1_accumulation_error": 4.41819429397583e-05,
      "scaling_error": 4.41819429397583e-05,
      "softmax_numerical_error": 4.41819429397583e-05,
      "matmul2_accumulation_error": 4.41819429397583e-05,
      "output_demote_error": 7.463991641998291e-05
    },
    "component_ratios": {
      "input_storage_error": 0.14949077341938086,
      "matmul1_accumulation_error": 0.14949077341938086,
      "scaling_error": 0.14949077341938086,
      "softmax_numerical_error": 0.14949077341938086,
      "matmul2_accumulation_error": 0.14949077341938086,
      "output_demote_error": 0.2525461329030957
    },
    "primary_source": "storage_error",
    "suggestion": "\u4e3b\u8981\u8bef\u5dee\u6765\u6e90\u4e3a\u8f93\u5165\u5b58\u50a8\u7cbe\u5ea6\u3002\u5efa\u8bae\uff1a\u63d0\u5347Q/K/V\u7684\u5b58\u50a8\u7cbe\u5ea6\uff1b\u8fdb\u884c\u8f93\u5165\u5f52\u4e00\u5316\uff1b\u68c0\u67e5embedding\u5c42\u7684\u8f93\u51fa\u8303\u56f4\u3002 \u68c0\u6d4b\u5230\u5927\u91cf\u5c16\u9510\u7684attention\u6a21\u5f0f\uff08\u4f4e\u71b5\uff09\uff0c\u8fd9\u4f1a\u653e\u5927softmax\u7684\u6570\u503c\u8bef\u5dee\u3002\u8003\u8651\u4f7f\u7528attention dropout\u6216\u6e29\u5ea6\u7f29\u653e\u3002",
    "attention_pattern_stats": {
      "global_avg_entropy": 3.878161668777466,
      "global_sparsity": 0.69482421875,
      "max_attention_weight": 1.0,
      "min_attention_weight": 0.0
    },
    "attention_behavior_stats": {
      "high_entropy_tokens": 0,
      "low_entropy_tokens": 8,
      "total_analyzed": 8
    },
    "top_tokens_summary": [
      {
        "batch_idx": 0,
        "head_idx": 7,
        "token_idx": 1,
        "token_error": 1.0046594979939982e-05,
        "entropy_ref": 0.6930252313613892,
        "max_attention_weight_ref": 0.5078093409538269,
        "attention_weight_error": 7.450580596923828e-07,
        "stage_errors": {
          "storage_error": 2.613590368127916e-05,
          "matmul1_error": 1.9312655206726107e-09,
          "softmax_error": 1.2055039405822755e-06,
          "matmul2_error": 7.000780897215009e-07,
          "demote_error": 1.2055039405822754e-07
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 3,
        "token_idx": 1,
        "token_error": 9.590236004441977e-06,
        "entropy_ref": 0.6930835247039795,
        "max_attention_weight_ref": 0.5056428909301758,
        "attention_weight_error": 1.1324882507324219e-06,
        "stage_errors": {
          "storage_error": 2.3417793272528797e-05,
          "matmul1_error": 1.5202443405279567e-09,
          "softmax_error": 9.762545232661068e-07,
          "matmul2_error": 6.773237146262546e-07,
          "demote_error": 9.762545232661069e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 4,
        "token_idx": 1,
        "token_error": 8.444707418675534e-06,
        "entropy_ref": 0.6931061744689941,
        "max_attention_weight_ref": 0.504525363445282,
        "attention_weight_error": 4.172325134277344e-07,
        "stage_errors": {
          "storage_error": 2.0853102796536405e-05,
          "matmul1_error": 1.066055952095928e-09,
          "softmax_error": 6.667766683676746e-07,
          "matmul2_error": 7.119482688722201e-07,
          "demote_error": 6.667766683676745e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 7,
        "token_idx": 0,
        "token_error": 8.346367394551635e-06,
        "entropy_ref": -0.0,
        "max_attention_weight_ref": 1.0,
        "attention_weight_error": 0.0,
        "stage_errors": {
          "storage_error": 1.971839265024755e-05,
          "matmul1_error": 9.031545900039772e-10,
          "softmax_error": 5.637528374791146e-07,
          "matmul2_error": 7.000780897215009e-07,
          "demote_error": 5.637528374791145e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 6,
        "token_idx": 1,
        "token_error": 8.216051355702803e-06,
        "entropy_ref": 0.6930942535400391,
        "max_attention_weight_ref": 0.5051436424255371,
        "attention_weight_error": 9.238719940185547e-07,
        "stage_errors": {
          "storage_error": 2.2197218640940264e-05,
          "matmul1_error": 1.3052400492877873e-09,
          "softmax_error": 8.265807991847397e-07,
          "matmul2_error": 6.952781859581592e-07,
          "demote_error": 8.265807991847396e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 6,
        "token_idx": 0,
        "token_error": 7.855349394958466e-06,
        "entropy_ref": -0.0,
        "max_attention_weight_ref": 1.0,
        "attention_weight_error": 0.0,
        "stage_errors": {
          "storage_error": 1.9101822545053437e-05,
          "matmul1_error": 8.164511787084746e-10,
          "softmax_error": 5.17041189596057e-07,
          "matmul2_error": 6.952781859581592e-07,
          "demote_error": 5.170411895960569e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 5,
        "token_idx": 0,
        "token_error": 7.707079930696636e-06,
        "entropy_ref": -0.0,
        "max_attention_weight_ref": 1.0,
        "attention_weight_error": 0.0,
        "stage_errors": {
          "storage_error": 2.246505846414948e-05,
          "matmul1_error": 1.326145953037587e-09,
          "softmax_error": 8.231130777858198e-07,
          "matmul2_error": 7.113651463441784e-07,
          "demote_error": 8.231130777858198e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 3,
        "token_idx": 0,
        "token_error": 7.490853022318333e-06,
        "entropy_ref": -0.0,
        "max_attention_weight_ref": 1.0,
        "attention_weight_error": 0.0,
        "stage_errors": {
          "storage_error": 2.293101351824589e-05,
          "matmul1_error": 1.4444419602166838e-09,
          "softmax_error": 9.275765478378162e-07,
          "matmul2_error": 6.773237146262546e-07,
          "demote_error": 9.275765478378161e-08
        }
      }
    ],
    "head_analysis": [
      {
        "head_idx": 0,
        "avg_error": 1.803784357434779e-06,
        "avg_entropy": 3.878161907196045,
        "avg_max_weight": 0.04286309704184532,
        "sparsity": 0.6949462890625
      },
      {
        "head_idx": 1,
        "avg_error": 1.9366482320037903e-06,
        "avg_entropy": 3.878161907196045,
        "avg_max_weight": 0.04286399856209755,
        "sparsity": 0.6947021484375
      },
      {
        "head_idx": 2,
        "avg_error": 1.7832043113230611e-06,
        "avg_entropy": 3.8781614303588867,
        "avg_max_weight": 0.04286562278866768,
        "sparsity": 0.69482421875
      },
      {
        "head_idx": 3,
        "avg_error": 1.917228246384184e-06,
        "avg_entropy": 3.878161668777466,
        "avg_max_weight": 0.042876943945884705,
        "sparsity": 0.69451904296875
      },
      {
        "head_idx": 4,
        "avg_error": 2.0990169105061796e-06,
        "avg_entropy": 3.8781614303588867,
        "avg_max_weight": 0.04286976903676987,
        "sparsity": 0.69512939453125
      },
      {
        "head_idx": 5,
        "avg_error": 1.7387231991961016e-06,
        "avg_entropy": 3.8781609535217285,
        "avg_max_weight": 0.04289596900343895,
        "sparsity": 0.69482421875
      },
      {
        "head_idx": 6,
        "avg_error": 1.982052253879374e-06,
        "avg_entropy": 3.878161668777466,
        "avg_max_weight": 0.04286767542362213,
        "sparsity": 0.694580078125
      },
      {
        "head_idx": 7,
        "avg_error": 1.8031737454293761e-06,
        "avg_entropy": 3.8781604766845703,
        "avg_max_weight": 0.04290827736258507,
        "sparsity": 0.695068359375
      }
    ]
  }
}
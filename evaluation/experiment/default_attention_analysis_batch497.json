{
  "detector": {
    "detected_exceeded": false,
    "actual_err": 4.6893954277038574e-05,
    "predicted_bound": 0.0001194306962133851,
    "elapsed_sec": 2.978022336959839
  },
  "analyzer_report": {
    "component_estimates": {
      "input_storage_error": 4.6893954277038574e-05,
      "matmul1_accumulation_error": 4.6893954277038574e-05,
      "scaling_error": 4.6893954277038574e-05,
      "softmax_numerical_error": 4.6893954277038574e-05,
      "matmul2_accumulation_error": 4.6893954277038574e-05,
      "output_demote_error": 7.484853267669678e-05
    },
    "component_ratios": {
      "input_storage_error": 0.15160420079005685,
      "matmul1_accumulation_error": 0.15160420079005685,
      "scaling_error": 0.15160420079005685,
      "softmax_numerical_error": 0.15160420079005685,
      "matmul2_accumulation_error": 0.15160420079005685,
      "output_demote_error": 0.24197899604971576
    },
    "primary_source": "storage_error",
    "suggestion": "\u4e3b\u8981\u8bef\u5dee\u6765\u6e90\u4e3a\u8f93\u5165\u5b58\u50a8\u7cbe\u5ea6\u3002\u5efa\u8bae\uff1a\u63d0\u5347Q/K/V\u7684\u5b58\u50a8\u7cbe\u5ea6\uff1b\u8fdb\u884c\u8f93\u5165\u5f52\u4e00\u5316\uff1b\u68c0\u67e5embedding\u5c42\u7684\u8f93\u51fa\u8303\u56f4\u3002 \u68c0\u6d4b\u5230\u5927\u91cf\u5c16\u9510\u7684attention\u6a21\u5f0f\uff08\u4f4e\u71b5\uff09\uff0c\u8fd9\u4f1a\u653e\u5927softmax\u7684\u6570\u503c\u8bef\u5dee\u3002\u8003\u8651\u4f7f\u7528attention dropout\u6216\u6e29\u5ea6\u7f29\u653e\u3002",
    "attention_pattern_stats": {
      "global_avg_entropy": 3.878161668777466,
      "global_sparsity": 0.6948471069335938,
      "max_attention_weight": 1.0,
      "min_attention_weight": 0.0
    },
    "attention_behavior_stats": {
      "high_entropy_tokens": 0,
      "low_entropy_tokens": 8,
      "total_analyzed": 8
    },
    "top_tokens_summary": [
      {
        "batch_idx": 0,
        "head_idx": 4,
        "token_idx": 0,
        "token_error": 1.0768650099635124e-05,
        "entropy_ref": -0.0,
        "max_attention_weight_ref": 1.0,
        "attention_weight_error": 0.0,
        "stage_errors": {
          "storage_error": 2.0485346794885118e-05,
          "matmul1_error": 1.0048831025644182e-09,
          "softmax_error": 6.220998329808936e-07,
          "matmul2_error": 7.125626325432677e-07,
          "demote_error": 6.220998329808936e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 7,
        "token_idx": 0,
        "token_error": 8.694289135746658e-06,
        "entropy_ref": -0.0,
        "max_attention_weight_ref": 1.0,
        "attention_weight_error": 0.0,
        "stage_errors": {
          "storage_error": 2.3935112494655186e-05,
          "matmul1_error": 1.5689721710369393e-09,
          "softmax_error": 9.653440429246984e-07,
          "matmul2_error": 7.098799869709183e-07,
          "demote_error": 9.653440429246984e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 1,
        "token_idx": 1,
        "token_error": 8.3855929915444e-06,
        "entropy_ref": 0.6931379437446594,
        "max_attention_weight_ref": 0.5021496415138245,
        "attention_weight_error": 8.940696716308594e-08,
        "stage_errors": {
          "storage_error": 1.974396946025081e-05,
          "matmul1_error": 8.922521789524297e-10,
          "softmax_error": 5.475252692122013e-07,
          "matmul2_error": 7.066793841659092e-07,
          "demote_error": 5.4752526921220125e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 6,
        "token_idx": 0,
        "token_error": 8.176735718734562e-06,
        "entropy_ref": -0.0,
        "max_attention_weight_ref": 1.0,
        "attention_weight_error": 0.0,
        "stage_errors": {
          "storage_error": 2.087680013573845e-05,
          "matmul1_error": 1.055447418744486e-09,
          "softmax_error": 6.640479114139453e-07,
          "matmul2_error": 7.212034688564018e-07,
          "demote_error": 6.640479114139452e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 3,
        "token_idx": 0,
        "token_error": 8.109018381219357e-06,
        "entropy_ref": -0.0,
        "max_attention_weight_ref": 1.0,
        "attention_weight_error": 0.0,
        "stage_errors": {
          "storage_error": 2.3198972485261038e-05,
          "matmul1_error": 1.4717447618803811e-09,
          "softmax_error": 9.599900295143015e-07,
          "matmul2_error": 6.823736839578487e-07,
          "demote_error": 9.599900295143016e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 2,
        "token_idx": 0,
        "token_error": 8.037517545744777e-06,
        "entropy_ref": -0.0,
        "max_attention_weight_ref": 1.0,
        "attention_weight_error": 0.0,
        "stage_errors": {
          "storage_error": 2.198239189965534e-05,
          "matmul1_error": 1.2730983507164914e-09,
          "softmax_error": 7.974296750035138e-07,
          "matmul2_error": 6.952484909561463e-07,
          "demote_error": 7.974296750035138e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 1,
        "token_idx": 0,
        "token_error": 7.949210157676134e-06,
        "entropy_ref": -0.0,
        "max_attention_weight_ref": 1.0,
        "attention_weight_error": 0.0,
        "stage_errors": {
          "storage_error": 2.0111892808927223e-05,
          "matmul1_error": 9.522093038567004e-10,
          "softmax_error": 5.843176040798426e-07,
          "matmul2_error": 7.066793841659092e-07,
          "demote_error": 5.843176040798426e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 0,
        "token_idx": 1,
        "token_error": 7.8824523370713e-06,
        "entropy_ref": 0.6931283473968506,
        "max_attention_weight_ref": 0.5030686259269714,
        "attention_weight_error": 3.5762786865234375e-07,
        "stage_errors": {
          "storage_error": 2.25622557081806e-05,
          "matmul1_error": 1.362567786793221e-09,
          "softmax_error": 8.528688340447844e-07,
          "matmul2_error": 6.972979008423863e-07,
          "demote_error": 8.528688340447843e-08
        }
      }
    ],
    "head_analysis": [
      {
        "head_idx": 0,
        "avg_error": 1.733905378387135e-06,
        "avg_entropy": 3.8781614303588867,
        "avg_max_weight": 0.04288642108440399,
        "sparsity": 0.69488525390625
      },
      {
        "head_idx": 1,
        "avg_error": 1.6849860458023613e-06,
        "avg_entropy": 3.8781614303588867,
        "avg_max_weight": 0.04287857562303543,
        "sparsity": 0.69500732421875
      },
      {
        "head_idx": 2,
        "avg_error": 1.8135916661776719e-06,
        "avg_entropy": 3.878161907196045,
        "avg_max_weight": 0.042876582592725754,
        "sparsity": 0.6947021484375
      },
      {
        "head_idx": 3,
        "avg_error": 1.7965542156161973e-06,
        "avg_entropy": 3.878162384033203,
        "avg_max_weight": 0.0428423173725605,
        "sparsity": 0.69488525390625
      },
      {
        "head_idx": 4,
        "avg_error": 1.9374147086637095e-06,
        "avg_entropy": 3.878161907196045,
        "avg_max_weight": 0.04286335036158562,
        "sparsity": 0.694580078125
      },
      {
        "head_idx": 5,
        "avg_error": 1.6728288301237626e-06,
        "avg_entropy": 3.878162145614624,
        "avg_max_weight": 0.04284563660621643,
        "sparsity": 0.695068359375
      },
      {
        "head_idx": 6,
        "avg_error": 2.062214662146289e-06,
        "avg_entropy": 3.8781614303588867,
        "avg_max_weight": 0.04287564754486084,
        "sparsity": 0.69476318359375
      },
      {
        "head_idx": 7,
        "avg_error": 1.8400421595288208e-06,
        "avg_entropy": 3.878161668777466,
        "avg_max_weight": 0.04287267476320267,
        "sparsity": 0.69488525390625
      }
    ]
  }
}
{
  "detector": {
    "detected_exceeded": false,
    "actual_err": 6.143748760223389e-05,
    "predicted_bound": 0.00010392004187451676,
    "elapsed_sec": 2.934528350830078
  },
  "analyzer_report": {
    "component_estimates": {
      "input_storage_error": 4.9524009227752686e-05,
      "matmul1_accumulation_error": 4.9524009227752686e-05,
      "scaling_error": 4.9524009227752686e-05,
      "softmax_numerical_error": 4.9524009227752686e-05,
      "matmul2_accumulation_error": 4.9524009227752686e-05,
      "output_demote_error": 7.777661085128784e-05
    },
    "component_ratios": {
      "input_storage_error": 0.15219581444337593,
      "matmul1_accumulation_error": 0.15219581444337593,
      "scaling_error": 0.15219581444337593,
      "softmax_numerical_error": 0.15219581444337593,
      "matmul2_accumulation_error": 0.15219581444337593,
      "output_demote_error": 0.2390209277831204
    },
    "primary_source": "storage_error",
    "suggestion": "\u4e3b\u8981\u8bef\u5dee\u6765\u6e90\u4e3a\u8f93\u5165\u5b58\u50a8\u7cbe\u5ea6\u3002\u5efa\u8bae\uff1a\u63d0\u5347Q/K/V\u7684\u5b58\u50a8\u7cbe\u5ea6\uff1b\u8fdb\u884c\u8f93\u5165\u5f52\u4e00\u5316\uff1b\u68c0\u67e5embedding\u5c42\u7684\u8f93\u51fa\u8303\u56f4\u3002",
    "attention_pattern_stats": {
      "global_avg_entropy": 3.878162145614624,
      "global_sparsity": 0.694854736328125,
      "max_attention_weight": 1.0,
      "min_attention_weight": 0.0
    },
    "attention_behavior_stats": {
      "high_entropy_tokens": 0,
      "low_entropy_tokens": 3,
      "total_analyzed": 8
    },
    "top_tokens_summary": [
      {
        "batch_idx": 0,
        "head_idx": 4,
        "token_idx": 0,
        "token_error": 1.0540381481405348e-05,
        "entropy_ref": -0.0,
        "max_attention_weight_ref": 1.0,
        "attention_weight_error": 0.0,
        "stage_errors": {
          "storage_error": 2.1196241050347453e-05,
          "matmul1_error": 1.1212513671561271e-09,
          "softmax_error": 6.898408173583448e-07,
          "matmul2_error": 7.11461370883626e-07,
          "demote_error": 6.898408173583448e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 3,
        "token_idx": 1,
        "token_error": 9.82138044491876e-06,
        "entropy_ref": 0.6931337118148804,
        "max_attention_weight_ref": 0.5025910139083862,
        "attention_weight_error": 2.384185791015625e-07,
        "stage_errors": {
          "storage_error": 1.8671356428967556e-05,
          "matmul1_error": 7.505323910160513e-10,
          "softmax_error": 4.806515789823607e-07,
          "matmul2_error": 6.963966825423995e-07,
          "demote_error": 4.806515789823607e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 7,
        "token_idx": 2,
        "token_error": 9.65901472227415e-06,
        "entropy_ref": 1.0985816717147827,
        "max_attention_weight_ref": 0.3370234966278076,
        "attention_weight_error": 3.2782554626464844e-07,
        "stage_errors": {
          "storage_error": 2.0483083062572405e-05,
          "matmul1_error": 9.945837794382457e-10,
          "softmax_error": 6.421672878786922e-07,
          "matmul2_error": 7.216650374175516e-07,
          "demote_error": 6.421672878786922e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 4,
        "token_idx": 1,
        "token_error": 8.87964415596798e-06,
        "entropy_ref": 0.6931136250495911,
        "max_attention_weight_ref": 0.5040957927703857,
        "attention_weight_error": 6.556510925292969e-07,
        "stage_errors": {
          "storage_error": 2.319440818610019e-05,
          "matmul1_error": 1.4460288486262293e-09,
          "softmax_error": 8.896575309336186e-07,
          "matmul2_error": 7.11461370883626e-07,
          "demote_error": 8.896575309336186e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 4,
        "token_idx": 2,
        "token_error": 8.047500159591436e-06,
        "entropy_ref": 1.098585844039917,
        "max_attention_weight_ref": 0.3367640972137451,
        "attention_weight_error": 5.066394805908203e-07,
        "stage_errors": {
          "storage_error": 2.1555469629674917e-05,
          "matmul1_error": 1.1796395525979348e-09,
          "softmax_error": 7.257636752910913e-07,
          "matmul2_error": 7.11461370883626e-07,
          "demote_error": 7.257636752910912e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 7,
        "token_idx": 3,
        "token_error": 7.902271136117633e-06,
        "entropy_ref": 1.3862775564193726,
        "max_attention_weight_ref": 0.2521103322505951,
        "attention_weight_error": 2.980232238769531e-07,
        "stage_errors": {
          "storage_error": 2.0798932382604107e-05,
          "matmul1_error": 1.0435022803304107e-09,
          "softmax_error": 6.737522198818624e-07,
          "matmul2_error": 7.216650374175516e-07,
          "demote_error": 6.737522198818624e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 4,
        "token_idx": 4,
        "token_error": 7.839990757929627e-06,
        "entropy_ref": 1.6094189882278442,
        "max_attention_weight_ref": 0.20224922895431519,
        "attention_weight_error": 7.748603820800781e-07,
        "stage_errors": {
          "storage_error": 2.034003910011961e-05,
          "matmul1_error": 9.820862752830524e-10,
          "softmax_error": 6.042206223355607e-07,
          "matmul2_error": 7.11461370883626e-07,
          "demote_error": 6.042206223355606e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 7,
        "token_idx": 4,
        "token_error": 7.425356670864858e-06,
        "entropy_ref": 1.6094249486923218,
        "max_attention_weight_ref": 0.20200705528259277,
        "attention_weight_error": 7.003545761108398e-07,
        "stage_errors": {
          "storage_error": 2.178696377086453e-05,
          "matmul1_error": 1.1965278253695877e-09,
          "softmax_error": 7.725553587079049e-07,
          "matmul2_error": 7.216650374175516e-07,
          "demote_error": 7.725553587079048e-08
        }
      }
    ],
    "head_analysis": [
      {
        "head_idx": 0,
        "avg_error": 1.8048779111268232e-06,
        "avg_entropy": 3.878162145614624,
        "avg_max_weight": 0.04284214600920677,
        "sparsity": 0.69500732421875
      },
      {
        "head_idx": 1,
        "avg_error": 1.8351620383327827e-06,
        "avg_entropy": 3.878161907196045,
        "avg_max_weight": 0.042851656675338745,
        "sparsity": 0.69482421875
      },
      {
        "head_idx": 2,
        "avg_error": 1.7876432139019016e-06,
        "avg_entropy": 3.8781614303588867,
        "avg_max_weight": 0.04287559539079666,
        "sparsity": 0.695068359375
      },
      {
        "head_idx": 3,
        "avg_error": 1.752616981320898e-06,
        "avg_entropy": 3.878162384033203,
        "avg_max_weight": 0.042853593826293945,
        "sparsity": 0.69464111328125
      },
      {
        "head_idx": 4,
        "avg_error": 1.8665739389689406e-06,
        "avg_entropy": 3.8781614303588867,
        "avg_max_weight": 0.04289118945598602,
        "sparsity": 0.6947021484375
      },
      {
        "head_idx": 5,
        "avg_error": 1.599854954292823e-06,
        "avg_entropy": 3.878161668777466,
        "avg_max_weight": 0.042851608246564865,
        "sparsity": 0.6951904296875
      },
      {
        "head_idx": 6,
        "avg_error": 1.8443380440658075e-06,
        "avg_entropy": 3.878161907196045,
        "avg_max_weight": 0.04286772385239601,
        "sparsity": 0.69476318359375
      },
      {
        "head_idx": 7,
        "avg_error": 2.008873025260982e-06,
        "avg_entropy": 3.878161907196045,
        "avg_max_weight": 0.04284367710351944,
        "sparsity": 0.69464111328125
      }
    ]
  }
}
{
  "detector": {
    "detected_exceeded": false,
    "actual_err": 3.703683614730835e-05,
    "predicted_bound": 0.00010842404954019003,
    "elapsed_sec": 2.8501787185668945
  },
  "analyzer_report": {
    "component_estimates": {
      "input_storage_error": 3.5062432289123535e-05,
      "matmul1_accumulation_error": 3.5062432289123535e-05,
      "scaling_error": 3.5062432289123535e-05,
      "softmax_numerical_error": 3.5062432289123535e-05,
      "matmul2_accumulation_error": 3.5062432289123535e-05,
      "output_demote_error": 7.402896881103516e-05
    },
    "component_ratios": {
      "input_storage_error": 0.14062033108229247,
      "matmul1_accumulation_error": 0.14062033108229247,
      "scaling_error": 0.14062033108229247,
      "softmax_numerical_error": 0.14062033108229247,
      "matmul2_accumulation_error": 0.14062033108229247,
      "output_demote_error": 0.29689834458853764
    },
    "primary_source": "storage_error",
    "suggestion": "\u4e3b\u8981\u8bef\u5dee\u6765\u6e90\u4e3a\u8f93\u5165\u5b58\u50a8\u7cbe\u5ea6\u3002\u5efa\u8bae\uff1a\u63d0\u5347Q/K/V\u7684\u5b58\u50a8\u7cbe\u5ea6\uff1b\u8fdb\u884c\u8f93\u5165\u5f52\u4e00\u5316\uff1b\u68c0\u67e5embedding\u5c42\u7684\u8f93\u51fa\u8303\u56f4\u3002 \u68c0\u6d4b\u5230\u5927\u91cf\u5c16\u9510\u7684attention\u6a21\u5f0f\uff08\u4f4e\u71b5\uff09\uff0c\u8fd9\u4f1a\u653e\u5927softmax\u7684\u6570\u503c\u8bef\u5dee\u3002\u8003\u8651\u4f7f\u7528attention dropout\u6216\u6e29\u5ea6\u7f29\u653e\u3002",
    "attention_pattern_stats": {
      "global_avg_entropy": 3.878161907196045,
      "global_sparsity": 0.6948318481445312,
      "max_attention_weight": 1.0,
      "min_attention_weight": 0.0
    },
    "attention_behavior_stats": {
      "high_entropy_tokens": 0,
      "low_entropy_tokens": 6,
      "total_analyzed": 8
    },
    "top_tokens_summary": [
      {
        "batch_idx": 0,
        "head_idx": 0,
        "token_idx": 1,
        "token_error": 9.848073204921093e-06,
        "entropy_ref": 0.6931130886077881,
        "max_attention_weight_ref": 0.5041274428367615,
        "attention_weight_error": 1.1026859283447266e-06,
        "stage_errors": {
          "storage_error": 2.3822958155506058e-05,
          "matmul1_error": 1.5660473032561836e-09,
          "softmax_error": 9.582057828083636e-07,
          "matmul2_error": 7.018008545855992e-07,
          "demote_error": 9.582057828083634e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 1,
        "token_idx": 0,
        "token_error": 9.01335442904383e-06,
        "entropy_ref": -0.0,
        "max_attention_weight_ref": 1.0,
        "attention_weight_error": 0.0,
        "stage_errors": {
          "storage_error": 2.295318518008571e-05,
          "matmul1_error": 1.4009004647619801e-09,
          "softmax_error": 8.810384315438569e-07,
          "matmul2_error": 7.115679636626737e-07,
          "demote_error": 8.810384315438568e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 4,
        "token_idx": 0,
        "token_error": 8.585338946431875e-06,
        "entropy_ref": -0.0,
        "max_attention_weight_ref": 1.0,
        "attention_weight_error": 0.0,
        "stage_errors": {
          "storage_error": 2.385108655289514e-05,
          "matmul1_error": 1.5388799921711993e-09,
          "softmax_error": 9.331422916147858e-07,
          "matmul2_error": 7.231436484289589e-07,
          "demote_error": 9.331422916147858e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 4,
        "token_idx": 1,
        "token_error": 8.101635103230365e-06,
        "entropy_ref": 0.6931241750717163,
        "max_attention_weight_ref": 0.5033891797065735,
        "attention_weight_error": 9.238719940185547e-07,
        "stage_errors": {
          "storage_error": 2.225242405984318e-05,
          "matmul1_error": 1.2752385575369436e-09,
          "softmax_error": 7.732760423095897e-07,
          "matmul2_error": 7.231436484289589e-07,
          "demote_error": 7.732760423095897e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 6,
        "token_idx": 1,
        "token_error": 7.67452183936257e-06,
        "entropy_ref": 0.6931122541427612,
        "max_attention_weight_ref": 0.504178524017334,
        "attention_weight_error": 7.748603820800781e-07,
        "stage_errors": {
          "storage_error": 2.004331963689765e-05,
          "matmul1_error": 9.249153773618004e-10,
          "softmax_error": 5.661335308104754e-07,
          "matmul2_error": 7.161802386690397e-07,
          "demote_error": 5.6613353081047536e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 6,
        "token_idx": 0,
        "token_error": 7.534825272159651e-06,
        "entropy_ref": -0.0,
        "max_attention_weight_ref": 1.0,
        "attention_weight_error": 0.0,
        "stage_errors": {
          "storage_error": 2.2686151169182267e-05,
          "matmul1_error": 1.356685514786323e-09,
          "softmax_error": 8.304166840389371e-07,
          "matmul2_error": 7.161802386690397e-07,
          "demote_error": 8.304166840389371e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 0,
        "token_idx": 2,
        "token_error": 7.271601134561934e-06,
        "entropy_ref": 1.0985982418060303,
        "max_attention_weight_ref": 0.3357389569282532,
        "attention_weight_error": 1.7881393432617188e-07,
        "stage_errors": {
          "storage_error": 1.976899829969625e-05,
          "matmul1_error": 9.034868163957653e-10,
          "softmax_error": 5.528097972273827e-07,
          "matmul2_error": 7.018008545855992e-07,
          "demote_error": 5.528097972273827e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 1,
        "token_idx": 2,
        "token_error": 7.2106768129742704e-06,
        "entropy_ref": 1.0985902547836304,
        "max_attention_weight_ref": 0.33639100193977356,
        "attention_weight_error": 8.940696716308594e-07,
        "stage_errors": {
          "storage_error": 1.9935656382585876e-05,
          "matmul1_error": 9.210964807924395e-10,
          "softmax_error": 5.792855517938734e-07,
          "matmul2_error": 7.115679636626737e-07,
          "demote_error": 5.7928555179387333e-08
        }
      }
    ],
    "head_analysis": [
      {
        "head_idx": 0,
        "avg_error": 1.8249427284899866e-06,
        "avg_entropy": 3.8781611919403076,
        "avg_max_weight": 0.042884711176157,
        "sparsity": 0.69476318359375
      },
      {
        "head_idx": 1,
        "avg_error": 2.048608621407766e-06,
        "avg_entropy": 3.8781614303588867,
        "avg_max_weight": 0.04288145527243614,
        "sparsity": 0.69488525390625
      },
      {
        "head_idx": 2,
        "avg_error": 1.774986117197841e-06,
        "avg_entropy": 3.878162145614624,
        "avg_max_weight": 0.04286544770002365,
        "sparsity": 0.6949462890625
      },
      {
        "head_idx": 3,
        "avg_error": 1.8288665160071105e-06,
        "avg_entropy": 3.878161668777466,
        "avg_max_weight": 0.042862050235271454,
        "sparsity": 0.69482421875
      },
      {
        "head_idx": 4,
        "avg_error": 1.790923192857008e-06,
        "avg_entropy": 3.8781611919403076,
        "avg_max_weight": 0.04288325086236,
        "sparsity": 0.69482421875
      },
      {
        "head_idx": 5,
        "avg_error": 1.8981719449584489e-06,
        "avg_entropy": 3.8781614303588867,
        "avg_max_weight": 0.04286923259496689,
        "sparsity": 0.695068359375
      },
      {
        "head_idx": 6,
        "avg_error": 1.9249141587351914e-06,
        "avg_entropy": 3.878161668777466,
        "avg_max_weight": 0.04287964850664139,
        "sparsity": 0.6947021484375
      },
      {
        "head_idx": 7,
        "avg_error": 1.9703470570675563e-06,
        "avg_entropy": 3.878162145614624,
        "avg_max_weight": 0.042852986603975296,
        "sparsity": 0.69464111328125
      }
    ]
  }
}
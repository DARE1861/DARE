{
  "detector": {
    "detected_exceeded": false,
    "actual_err": 5.879998207092285e-05,
    "predicted_bound": 0.00013418154121609406,
    "elapsed_sec": 3.016105890274048
  },
  "analyzer_report": {
    "component_estimates": {
      "input_storage_error": 5.879998207092285e-05,
      "matmul1_accumulation_error": 5.879998207092285e-05,
      "scaling_error": 5.879998207092285e-05,
      "softmax_numerical_error": 5.879998207092285e-05,
      "matmul2_accumulation_error": 5.879998207092285e-05,
      "output_demote_error": 7.309019565582275e-05
    },
    "component_ratios": {
      "input_storage_error": 0.16017860767201136,
      "matmul1_accumulation_error": 0.16017860767201136,
      "scaling_error": 0.16017860767201136,
      "softmax_numerical_error": 0.16017860767201136,
      "matmul2_accumulation_error": 0.16017860767201136,
      "output_demote_error": 0.19910696163994318
    },
    "primary_source": "storage_error",
    "suggestion": "\u4e3b\u8981\u8bef\u5dee\u6765\u6e90\u4e3a\u8f93\u5165\u5b58\u50a8\u7cbe\u5ea6\u3002\u5efa\u8bae\uff1a\u63d0\u5347Q/K/V\u7684\u5b58\u50a8\u7cbe\u5ea6\uff1b\u8fdb\u884c\u8f93\u5165\u5f52\u4e00\u5316\uff1b\u68c0\u67e5embedding\u5c42\u7684\u8f93\u51fa\u8303\u56f4\u3002 \u68c0\u6d4b\u5230\u5927\u91cf\u5c16\u9510\u7684attention\u6a21\u5f0f\uff08\u4f4e\u71b5\uff09\uff0c\u8fd9\u4f1a\u653e\u5927softmax\u7684\u6570\u503c\u8bef\u5dee\u3002\u8003\u8651\u4f7f\u7528attention dropout\u6216\u6e29\u5ea6\u7f29\u653e\u3002",
    "attention_pattern_stats": {
      "global_avg_entropy": 3.878161668777466,
      "global_sparsity": 0.6948089599609375,
      "max_attention_weight": 1.0,
      "min_attention_weight": 0.0
    },
    "attention_behavior_stats": {
      "high_entropy_tokens": 0,
      "low_entropy_tokens": 7,
      "total_analyzed": 8
    },
    "top_tokens_summary": [
      {
        "batch_idx": 0,
        "head_idx": 3,
        "token_idx": 0,
        "token_error": 1.1083996469096746e-05,
        "entropy_ref": -0.0,
        "max_attention_weight_ref": 1.0,
        "attention_weight_error": 0.0,
        "stage_errors": {
          "storage_error": 2.223011460955604e-05,
          "matmul1_error": 1.2999182285492058e-09,
          "softmax_error": 8.300505214720034e-07,
          "matmul2_error": 7.008487045823131e-07,
          "demote_error": 8.300505214720033e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 2,
        "token_idx": 1,
        "token_error": 9.870793292066082e-06,
        "entropy_ref": 0.6931292414665222,
        "max_attention_weight_ref": 0.5029944777488708,
        "attention_weight_error": 6.854534149169922e-07,
        "stage_errors": {
          "storage_error": 2.0732180018967483e-05,
          "matmul1_error": 1.0249637976746732e-09,
          "softmax_error": 6.346061127260328e-07,
          "matmul2_error": 7.248238034662791e-07,
          "demote_error": 6.346061127260328e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 7,
        "token_idx": 1,
        "token_error": 8.689486094226595e-06,
        "entropy_ref": 0.6931167244911194,
        "max_attention_weight_ref": 0.503902018070221,
        "attention_weight_error": 4.470348358154297e-07,
        "stage_errors": {
          "storage_error": 2.2862348032504087e-05,
          "matmul1_error": 1.4067017918702405e-09,
          "softmax_error": 8.625320333521813e-07,
          "matmul2_error": 7.029408607195365e-07,
          "demote_error": 8.625320333521814e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 1,
        "token_idx": 1,
        "token_error": 8.34376442071516e-06,
        "entropy_ref": 0.6931148767471313,
        "max_attention_weight_ref": 0.5040215253829956,
        "attention_weight_error": 6.258487701416016e-07,
        "stage_errors": {
          "storage_error": 2.146956148862955e-05,
          "matmul1_error": 1.197688790503102e-09,
          "softmax_error": 7.494694727938622e-07,
          "matmul2_error": 6.912422122695717e-07,
          "demote_error": 7.494694727938623e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 6,
        "token_idx": 0,
        "token_error": 7.763796020299196e-06,
        "entropy_ref": -0.0,
        "max_attention_weight_ref": 1.0,
        "attention_weight_error": 0.0,
        "stage_errors": {
          "storage_error": 1.8945135252579348e-05,
          "matmul1_error": 7.644340768954726e-10,
          "softmax_error": 4.884939698968083e-07,
          "matmul2_error": 7.144340997911059e-07,
          "demote_error": 4.884939698968083e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 3,
        "token_idx": 1,
        "token_error": 7.728373020654544e-06,
        "entropy_ref": 0.6930618286132812,
        "max_attention_weight_ref": 0.5065338015556335,
        "attention_weight_error": 8.046627044677734e-07,
        "stage_errors": {
          "storage_error": 2.266291949126753e-05,
          "matmul1_error": 1.3676985552387332e-09,
          "softmax_error": 8.733310096431524e-07,
          "matmul2_error": 7.008487045823131e-07,
          "demote_error": 8.733310096431523e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 3,
        "token_idx": 2,
        "token_error": 7.650753104826435e-06,
        "entropy_ref": 1.0985994338989258,
        "max_attention_weight_ref": 0.33566296100616455,
        "attention_weight_error": 5.066394805908203e-07,
        "stage_errors": {
          "storage_error": 2.1088656922074733e-05,
          "matmul1_error": 1.1211578258157415e-09,
          "softmax_error": 7.159047527238727e-07,
          "matmul2_error": 7.008487045823131e-07,
          "demote_error": 7.159047527238726e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 0,
        "token_idx": 1,
        "token_error": 7.277082659129519e-06,
        "entropy_ref": 0.693139910697937,
        "max_attention_weight_ref": 0.501909613609314,
        "attention_weight_error": 2.9802322387695312e-08,
        "stage_errors": {
          "storage_error": 2.0773426513187587e-05,
          "matmul1_error": 1.0633062919149367e-09,
          "softmax_error": 6.619298801524565e-07,
          "matmul2_error": 7.054894922475796e-07,
          "demote_error": 6.619298801524565e-08
        }
      }
    ],
    "head_analysis": [
      {
        "head_idx": 0,
        "avg_error": 1.893137778097298e-06,
        "avg_entropy": 3.878162145614624,
        "avg_max_weight": 0.04284296929836273,
        "sparsity": 0.69476318359375
      },
      {
        "head_idx": 1,
        "avg_error": 1.6505745179529185e-06,
        "avg_entropy": 3.8781614303588867,
        "avg_max_weight": 0.042879559099674225,
        "sparsity": 0.69464111328125
      },
      {
        "head_idx": 2,
        "avg_error": 1.9546234852896305e-06,
        "avg_entropy": 3.878161668777466,
        "avg_max_weight": 0.04287241771817207,
        "sparsity": 0.69500732421875
      },
      {
        "head_idx": 3,
        "avg_error": 1.800308609745116e-06,
        "avg_entropy": 3.878161907196045,
        "avg_max_weight": 0.04286107420921326,
        "sparsity": 0.69488525390625
      },
      {
        "head_idx": 4,
        "avg_error": 1.5917444216029253e-06,
        "avg_entropy": 3.878161907196045,
        "avg_max_weight": 0.04287675395607948,
        "sparsity": 0.6944580078125
      },
      {
        "head_idx": 5,
        "avg_error": 1.777053284968133e-06,
        "avg_entropy": 3.878162145614624,
        "avg_max_weight": 0.042851522564888,
        "sparsity": 0.6949462890625
      },
      {
        "head_idx": 6,
        "avg_error": 1.952645106939599e-06,
        "avg_entropy": 3.8781614303588867,
        "avg_max_weight": 0.04288509115576744,
        "sparsity": 0.6949462890625
      },
      {
        "head_idx": 7,
        "avg_error": 1.9551919194782386e-06,
        "avg_entropy": 3.8781614303588867,
        "avg_max_weight": 0.0428629107773304,
        "sparsity": 0.69482421875
      }
    ]
  }
}
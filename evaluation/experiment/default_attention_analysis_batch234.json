{
  "detector": {
    "detected_exceeded": false,
    "actual_err": 6.015598773956299e-05,
    "predicted_bound": 0.00014470354071818294,
    "elapsed_sec": 3.057337999343872
  },
  "analyzer_report": {
    "component_estimates": {
      "input_storage_error": 6.015598773956299e-05,
      "matmul1_accumulation_error": 6.015598773956299e-05,
      "scaling_error": 6.015598773956299e-05,
      "softmax_numerical_error": 6.015598773956299e-05,
      "matmul2_accumulation_error": 6.015598773956299e-05,
      "output_demote_error": 9.47415828704834e-05
    },
    "component_ratios": {
      "input_storage_error": 0.15209283050145048,
      "matmul1_accumulation_error": 0.15209283050145048,
      "scaling_error": 0.15209283050145048,
      "softmax_numerical_error": 0.15209283050145048,
      "matmul2_accumulation_error": 0.15209283050145048,
      "output_demote_error": 0.23953584749274762
    },
    "primary_source": "storage_error",
    "suggestion": "\u4e3b\u8981\u8bef\u5dee\u6765\u6e90\u4e3a\u8f93\u5165\u5b58\u50a8\u7cbe\u5ea6\u3002\u5efa\u8bae\uff1a\u63d0\u5347Q/K/V\u7684\u5b58\u50a8\u7cbe\u5ea6\uff1b\u8fdb\u884c\u8f93\u5165\u5f52\u4e00\u5316\uff1b\u68c0\u67e5embedding\u5c42\u7684\u8f93\u51fa\u8303\u56f4\u3002 \u68c0\u6d4b\u5230\u5927\u91cf\u5c16\u9510\u7684attention\u6a21\u5f0f\uff08\u4f4e\u71b5\uff09\uff0c\u8fd9\u4f1a\u653e\u5927softmax\u7684\u6570\u503c\u8bef\u5dee\u3002\u8003\u8651\u4f7f\u7528attention dropout\u6216\u6e29\u5ea6\u7f29\u653e\u3002",
    "attention_pattern_stats": {
      "global_avg_entropy": 3.878162145614624,
      "global_sparsity": 0.6948165893554688,
      "max_attention_weight": 1.0,
      "min_attention_weight": 0.0
    },
    "attention_behavior_stats": {
      "high_entropy_tokens": 0,
      "low_entropy_tokens": 7,
      "total_analyzed": 8
    },
    "top_tokens_summary": [
      {
        "batch_idx": 0,
        "head_idx": 2,
        "token_idx": 1,
        "token_error": 1.0023584763985127e-05,
        "entropy_ref": 0.6931191682815552,
        "max_attention_weight_ref": 0.5037462115287781,
        "attention_weight_error": 1.7881393432617188e-07,
        "stage_errors": {
          "storage_error": 2.2497858026326867e-05,
          "matmul1_error": 1.3740159950031204e-09,
          "softmax_error": 8.629343938082457e-07,
          "matmul2_error": 6.831652171968018e-07,
          "demote_error": 8.629343938082457e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 4,
        "token_idx": 1,
        "token_error": 9.892431990010664e-06,
        "entropy_ref": 0.6931321024894714,
        "max_attention_weight_ref": 0.5027428269386292,
        "attention_weight_error": 2.294778823852539e-06,
        "stage_errors": {
          "storage_error": 2.0579872852977132e-05,
          "matmul1_error": 1.034912667102513e-09,
          "softmax_error": 6.447764462791384e-07,
          "matmul2_error": 7.03862497175578e-07,
          "demote_error": 6.447764462791383e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 7,
        "token_idx": 0,
        "token_error": 9.39411620493047e-06,
        "entropy_ref": -0.0,
        "max_attention_weight_ref": 1.0,
        "attention_weight_error": 0.0,
        "stage_errors": {
          "storage_error": 1.9440045434748754e-05,
          "matmul1_error": 8.229103082987329e-10,
          "softmax_error": 5.18564775120467e-07,
          "matmul2_error": 7.241225375764771e-07,
          "demote_error": 5.18564775120467e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 6,
        "token_idx": 0,
        "token_error": 9.329378372058272e-06,
        "entropy_ref": -0.0,
        "max_attention_weight_ref": 1.0,
        "attention_weight_error": 0.0,
        "stage_errors": {
          "storage_error": 2.2362929030350642e-05,
          "matmul1_error": 1.3240104280163184e-09,
          "softmax_error": 8.199272997444496e-07,
          "matmul2_error": 7.027224910416408e-07,
          "demote_error": 8.199272997444496e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 3,
        "token_idx": 1,
        "token_error": 8.772687579039484e-06,
        "entropy_ref": 0.6930861473083496,
        "max_attention_weight_ref": 0.5055258274078369,
        "attention_weight_error": 8.940696716308594e-07,
        "stage_errors": {
          "storage_error": 2.2132408503239276e-05,
          "matmul1_error": 1.3088837858581523e-09,
          "softmax_error": 8.022761903703213e-07,
          "matmul2_error": 6.899531399540137e-07,
          "demote_error": 8.022761903703212e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 7,
        "token_idx": 1,
        "token_error": 8.024551789276302e-06,
        "entropy_ref": 0.6931381225585938,
        "max_attention_weight_ref": 0.5021360516548157,
        "attention_weight_error": 5.662441253662109e-07,
        "stage_errors": {
          "storage_error": 2.2050789993954822e-05,
          "matmul1_error": 1.2372092952683767e-09,
          "softmax_error": 7.796392310410738e-07,
          "matmul2_error": 7.241225375764771e-07,
          "demote_error": 7.796392310410738e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 0,
        "token_idx": 2,
        "token_error": 7.910952263046056e-06,
        "entropy_ref": 1.0985945463180542,
        "max_attention_weight_ref": 0.3361407518386841,
        "attention_weight_error": 8.344650268554688e-07,
        "stage_errors": {
          "storage_error": 2.097500237141503e-05,
          "matmul1_error": 1.1281321647923118e-09,
          "softmax_error": 7.108879799488933e-07,
          "matmul2_error": 6.852799742773641e-07,
          "demote_error": 7.108879799488932e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 2,
        "token_idx": 0,
        "token_error": 7.888293112046085e-06,
        "entropy_ref": -0.0,
        "max_attention_weight_ref": 1.0,
        "attention_weight_error": 0.0,
        "stage_errors": {
          "storage_error": 2.188630287491833e-05,
          "matmul1_error": 1.2766405089996494e-09,
          "softmax_error": 8.017788786673919e-07,
          "matmul2_error": 6.831652171968018e-07,
          "demote_error": 8.017788786673919e-08
        }
      }
    ],
    "head_analysis": [
      {
        "head_idx": 0,
        "avg_error": 1.8899480664913426e-06,
        "avg_entropy": 3.878162145614624,
        "avg_max_weight": 0.042859259992837906,
        "sparsity": 0.69500732421875
      },
      {
        "head_idx": 1,
        "avg_error": 1.7921346397997695e-06,
        "avg_entropy": 3.878161907196045,
        "avg_max_weight": 0.04285634309053421,
        "sparsity": 0.69476318359375
      },
      {
        "head_idx": 2,
        "avg_error": 1.6498099739692407e-06,
        "avg_entropy": 3.878161907196045,
        "avg_max_weight": 0.04286551848053932,
        "sparsity": 0.69464111328125
      },
      {
        "head_idx": 3,
        "avg_error": 1.794611307559535e-06,
        "avg_entropy": 3.8781609535217285,
        "avg_max_weight": 0.04289085045456886,
        "sparsity": 0.69476318359375
      },
      {
        "head_idx": 4,
        "avg_error": 2.2485448880615877e-06,
        "avg_entropy": 3.878162145614624,
        "avg_max_weight": 0.04284267872571945,
        "sparsity": 0.69476318359375
      },
      {
        "head_idx": 5,
        "avg_error": 1.79306471181917e-06,
        "avg_entropy": 3.8781614303588867,
        "avg_max_weight": 0.042861927300691605,
        "sparsity": 0.69500732421875
      },
      {
        "head_idx": 6,
        "avg_error": 1.8829611008186475e-06,
        "avg_entropy": 3.878161907196045,
        "avg_max_weight": 0.0428619347512722,
        "sparsity": 0.69476318359375
      },
      {
        "head_idx": 7,
        "avg_error": 1.8559209138402366e-06,
        "avg_entropy": 3.8781626224517822,
        "avg_max_weight": 0.04283691942691803,
        "sparsity": 0.69482421875
      }
    ]
  }
}
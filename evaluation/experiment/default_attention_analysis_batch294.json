{
  "detector": {
    "detected_exceeded": false,
    "actual_err": 5.042552947998047e-05,
    "predicted_bound": 0.00014831820153631272,
    "elapsed_sec": 2.979560136795044
  },
  "analyzer_report": {
    "component_estimates": {
      "input_storage_error": 5.042552947998047e-05,
      "matmul1_accumulation_error": 5.042552947998047e-05,
      "scaling_error": 5.042552947998047e-05,
      "softmax_numerical_error": 5.042552947998047e-05,
      "matmul2_accumulation_error": 5.042552947998047e-05,
      "output_demote_error": 7.592886686325073e-05
    },
    "component_ratios": {
      "input_storage_error": 0.15370988621652926,
      "matmul1_accumulation_error": 0.15370988621652926,
      "scaling_error": 0.15370988621652926,
      "softmax_numerical_error": 0.15370988621652926,
      "matmul2_accumulation_error": 0.15370988621652926,
      "output_demote_error": 0.2314505689173537
    },
    "primary_source": "storage_error",
    "suggestion": "\u4e3b\u8981\u8bef\u5dee\u6765\u6e90\u4e3a\u8f93\u5165\u5b58\u50a8\u7cbe\u5ea6\u3002\u5efa\u8bae\uff1a\u63d0\u5347Q/K/V\u7684\u5b58\u50a8\u7cbe\u5ea6\uff1b\u8fdb\u884c\u8f93\u5165\u5f52\u4e00\u5316\uff1b\u68c0\u67e5embedding\u5c42\u7684\u8f93\u51fa\u8303\u56f4\u3002 \u68c0\u6d4b\u5230\u5927\u91cf\u5c16\u9510\u7684attention\u6a21\u5f0f\uff08\u4f4e\u71b5\uff09\uff0c\u8fd9\u4f1a\u653e\u5927softmax\u7684\u6570\u503c\u8bef\u5dee\u3002\u8003\u8651\u4f7f\u7528attention dropout\u6216\u6e29\u5ea6\u7f29\u653e\u3002",
    "attention_pattern_stats": {
      "global_avg_entropy": 3.878162145614624,
      "global_sparsity": 0.6948013305664062,
      "max_attention_weight": 1.0,
      "min_attention_weight": 0.0
    },
    "attention_behavior_stats": {
      "high_entropy_tokens": 0,
      "low_entropy_tokens": 8,
      "total_analyzed": 8
    },
    "top_tokens_summary": [
      {
        "batch_idx": 0,
        "head_idx": 3,
        "token_idx": 1,
        "token_error": 1.0004670912167057e-05,
        "entropy_ref": 0.6931335926055908,
        "max_attention_weight_ref": 0.5026094317436218,
        "attention_weight_error": 1.519918441772461e-06,
        "stage_errors": {
          "storage_error": 2.2032785182091175e-05,
          "matmul1_error": 1.2581459468001653e-09,
          "softmax_error": 8.192553650587798e-07,
          "matmul2_error": 7.053248737065587e-07,
          "demote_error": 8.192553650587797e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 3,
        "token_idx": 0,
        "token_error": 9.08205402083695e-06,
        "entropy_ref": -0.0,
        "max_attention_weight_ref": 1.0,
        "attention_weight_error": 0.0,
        "stage_errors": {
          "storage_error": 2.1230043330433546e-05,
          "matmul1_error": 1.1348673635811902e-09,
          "softmax_error": 7.389811798930168e-07,
          "matmul2_error": 7.053248737065587e-07,
          "demote_error": 7.389811798930168e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 6,
        "token_idx": 1,
        "token_error": 8.468217856716365e-06,
        "entropy_ref": 0.6931180357933044,
        "max_attention_weight_ref": 0.5038188099861145,
        "attention_weight_error": 8.940696716308594e-08,
        "stage_errors": {
          "storage_error": 2.1435242615552852e-05,
          "matmul1_error": 1.1576150272393504e-09,
          "softmax_error": 7.346279744524509e-07,
          "matmul2_error": 7.124915555323241e-07,
          "demote_error": 7.346279744524508e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 1,
        "token_idx": 1,
        "token_error": 8.009352313820273e-06,
        "entropy_ref": 0.6931228637695312,
        "max_attention_weight_ref": 0.5034893751144409,
        "attention_weight_error": 7.748603820800781e-07,
        "stage_errors": {
          "storage_error": 1.993215573747875e-05,
          "matmul1_error": 9.65892719722461e-10,
          "softmax_error": 6.126821972429753e-07,
          "matmul2_error": 6.838127774244641e-07,
          "demote_error": 6.126821972429752e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 1,
        "token_idx": 0,
        "token_error": 7.633885616087355e-06,
        "entropy_ref": -0.0,
        "max_attention_weight_ref": 1.0,
        "attention_weight_error": 0.0,
        "stage_errors": {
          "storage_error": 1.8143216038879473e-05,
          "matmul1_error": 6.838665993822477e-10,
          "softmax_error": 4.3378822738304735e-07,
          "matmul2_error": 6.838127774244641e-07,
          "demote_error": 4.337882273830474e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 0,
        "token_idx": 0,
        "token_error": 7.5363932410255075e-06,
        "entropy_ref": -0.0,
        "max_attention_weight_ref": 1.0,
        "attention_weight_error": 0.0,
        "stage_errors": {
          "storage_error": 2.0357493667688686e-05,
          "matmul1_error": 9.781092081673363e-10,
          "softmax_error": 6.062480679247529e-07,
          "matmul2_error": 7.164808266679756e-07,
          "demote_error": 6.062480679247529e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 2,
        "token_idx": 1,
        "token_error": 7.431404810631648e-06,
        "entropy_ref": 0.6931229829788208,
        "max_attention_weight_ref": 0.5034822225570679,
        "attention_weight_error": 9.834766387939453e-07,
        "stage_errors": {
          "storage_error": 2.1051482690381818e-05,
          "matmul1_error": 1.14076419013567e-09,
          "softmax_error": 6.987444066908211e-07,
          "matmul2_error": 6.848935299785808e-07,
          "demote_error": 6.98744406690821e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 7,
        "token_idx": 0,
        "token_error": 6.93577021593228e-06,
        "entropy_ref": -0.0,
        "max_attention_weight_ref": 1.0,
        "attention_weight_error": 0.0,
        "stage_errors": {
          "storage_error": 2.0653699721151497e-05,
          "matmul1_error": 1.0429015823052374e-09,
          "softmax_error": 6.757145456504077e-07,
          "matmul2_error": 7.07560093360371e-07,
          "demote_error": 6.757145456504077e-08
        }
      }
    ],
    "head_analysis": [
      {
        "head_idx": 0,
        "avg_error": 1.9718399926205166e-06,
        "avg_entropy": 3.878162145614624,
        "avg_max_weight": 0.042853035032749176,
        "sparsity": 0.695068359375
      },
      {
        "head_idx": 1,
        "avg_error": 1.7824645510700066e-06,
        "avg_entropy": 3.878162145614624,
        "avg_max_weight": 0.04285155236721039,
        "sparsity": 0.69476318359375
      },
      {
        "head_idx": 2,
        "avg_error": 1.692423211352434e-06,
        "avg_entropy": 3.878161907196045,
        "avg_max_weight": 0.04286686331033707,
        "sparsity": 0.6947021484375
      },
      {
        "head_idx": 3,
        "avg_error": 1.6848748600750696e-06,
        "avg_entropy": 3.878162145614624,
        "avg_max_weight": 0.04284796118736267,
        "sparsity": 0.69476318359375
      },
      {
        "head_idx": 4,
        "avg_error": 1.857201027632982e-06,
        "avg_entropy": 3.878162145614624,
        "avg_max_weight": 0.04285230115056038,
        "sparsity": 0.69464111328125
      },
      {
        "head_idx": 5,
        "avg_error": 1.8963646652991883e-06,
        "avg_entropy": 3.8781611919403076,
        "avg_max_weight": 0.04287337884306908,
        "sparsity": 0.69464111328125
      },
      {
        "head_idx": 6,
        "avg_error": 1.973022563106497e-06,
        "avg_entropy": 3.878162145614624,
        "avg_max_weight": 0.04285523667931557,
        "sparsity": 0.69488525390625
      },
      {
        "head_idx": 7,
        "avg_error": 1.975928171304986e-06,
        "avg_entropy": 3.878162145614624,
        "avg_max_weight": 0.04283755272626877,
        "sparsity": 0.6949462890625
      }
    ]
  }
}
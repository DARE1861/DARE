{
  "detector": {
    "detected_exceeded": false,
    "actual_err": 5.613267421722412e-05,
    "predicted_bound": 0.0001507691136794165,
    "elapsed_sec": 3.03092885017395
  },
  "analyzer_report": {
    "component_estimates": {
      "input_storage_error": 5.613267421722412e-05,
      "matmul1_accumulation_error": 5.613267421722412e-05,
      "scaling_error": 5.613267421722412e-05,
      "softmax_numerical_error": 5.613267421722412e-05,
      "matmul2_accumulation_error": 5.613267421722412e-05,
      "output_demote_error": 8.140504360198975e-05
    },
    "component_ratios": {
      "input_storage_error": 0.15503333607704337,
      "matmul1_accumulation_error": 0.15503333607704337,
      "scaling_error": 0.15503333607704337,
      "softmax_numerical_error": 0.15503333607704337,
      "matmul2_accumulation_error": 0.15503333607704337,
      "output_demote_error": 0.22483331961478312
    },
    "primary_source": "storage_error",
    "suggestion": "\u4e3b\u8981\u8bef\u5dee\u6765\u6e90\u4e3a\u8f93\u5165\u5b58\u50a8\u7cbe\u5ea6\u3002\u5efa\u8bae\uff1a\u63d0\u5347Q/K/V\u7684\u5b58\u50a8\u7cbe\u5ea6\uff1b\u8fdb\u884c\u8f93\u5165\u5f52\u4e00\u5316\uff1b\u68c0\u67e5embedding\u5c42\u7684\u8f93\u51fa\u8303\u56f4\u3002 \u68c0\u6d4b\u5230\u5927\u91cf\u5c16\u9510\u7684attention\u6a21\u5f0f\uff08\u4f4e\u71b5\uff09\uff0c\u8fd9\u4f1a\u653e\u5927softmax\u7684\u6570\u503c\u8bef\u5dee\u3002\u8003\u8651\u4f7f\u7528attention dropout\u6216\u6e29\u5ea6\u7f29\u653e\u3002",
    "attention_pattern_stats": {
      "global_avg_entropy": 3.878161668777466,
      "global_sparsity": 0.6948318481445312,
      "max_attention_weight": 1.0,
      "min_attention_weight": 0.0
    },
    "attention_behavior_stats": {
      "high_entropy_tokens": 0,
      "low_entropy_tokens": 7,
      "total_analyzed": 8
    },
    "top_tokens_summary": [
      {
        "batch_idx": 0,
        "head_idx": 1,
        "token_idx": 1,
        "token_error": 1.1515454389154911e-05,
        "entropy_ref": 0.6931164264678955,
        "max_attention_weight_ref": 0.5039206743240356,
        "attention_weight_error": 8.642673492431641e-07,
        "stage_errors": {
          "storage_error": 2.1350184397306293e-05,
          "matmul1_error": 1.1442800899361999e-09,
          "softmax_error": 7.046335667837412e-07,
          "matmul2_error": 7.126996024453547e-07,
          "demote_error": 7.046335667837411e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 1,
        "token_idx": 0,
        "token_error": 9.561012120684609e-06,
        "entropy_ref": -0.0,
        "max_attention_weight_ref": 1.0,
        "attention_weight_error": 0.0,
        "stage_errors": {
          "storage_error": 2.1455969545058906e-05,
          "matmul1_error": 1.161458925020198e-09,
          "softmax_error": 7.152120815590024e-07,
          "matmul2_error": 7.126996024453547e-07,
          "demote_error": 7.152120815590025e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 4,
        "token_idx": 1,
        "token_error": 9.317074727732688e-06,
        "entropy_ref": 0.6930971145629883,
        "max_attention_weight_ref": 0.5050048828125,
        "attention_weight_error": 1.1920928955078125e-07,
        "stage_errors": {
          "storage_error": 2.1780267616122728e-05,
          "matmul1_error": 1.2473529025652303e-09,
          "softmax_error": 7.655093213543296e-07,
          "matmul2_error": 6.923990895302269e-07,
          "demote_error": 7.655093213543296e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 3,
        "token_idx": 1,
        "token_error": 9.237817721441388e-06,
        "entropy_ref": 0.6931050419807434,
        "max_attention_weight_ref": 0.5045890808105469,
        "attention_weight_error": 2.9802322387695312e-08,
        "stage_errors": {
          "storage_error": 2.3903959117888007e-05,
          "matmul1_error": 1.5500587056510927e-09,
          "softmax_error": 9.70826658885926e-07,
          "matmul2_error": 7.139482931961539e-07,
          "demote_error": 9.70826658885926e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 7,
        "token_idx": 1,
        "token_error": 8.763970981817693e-06,
        "entropy_ref": 0.6931229829788208,
        "max_attention_weight_ref": 0.5034793615341187,
        "attention_weight_error": 2.980232238769531e-07,
        "stage_errors": {
          "storage_error": 2.2653563519270392e-05,
          "matmul1_error": 1.3698154486993002e-09,
          "softmax_error": 8.560053174733185e-07,
          "matmul2_error": 7.021374130999902e-07,
          "demote_error": 8.560053174733184e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 0,
        "token_idx": 0,
        "token_error": 8.000191883184016e-06,
        "entropy_ref": -0.0,
        "max_attention_weight_ref": 1.0,
        "attention_weight_error": 0.0,
        "stage_errors": {
          "storage_error": 2.052002582786372e-05,
          "matmul1_error": 1.043902696404309e-09,
          "softmax_error": 6.535075954161585e-07,
          "matmul2_error": 6.925442448846298e-07,
          "demote_error": 6.535075954161584e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 3,
        "token_idx": 2,
        "token_error": 7.968883437570184e-06,
        "entropy_ref": 1.0985701084136963,
        "max_attention_weight_ref": 0.3373793065547943,
        "attention_weight_error": 6.556510925292969e-07,
        "stage_errors": {
          "storage_error": 2.2557543161383364e-05,
          "matmul1_error": 1.3350848217239113e-09,
          "softmax_error": 8.361850632354618e-07,
          "matmul2_error": 7.139482931961539e-07,
          "demote_error": 8.361850632354617e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 3,
        "token_idx": 0,
        "token_error": 7.884838851168752e-06,
        "entropy_ref": -0.0,
        "max_attention_weight_ref": 1.0,
        "attention_weight_error": 0.0,
        "stage_errors": {
          "storage_error": 2.0204134671075735e-05,
          "matmul1_error": 9.593306863213343e-10,
          "softmax_error": 6.008442142046989e-07,
          "matmul2_error": 7.139482931961539e-07,
          "demote_error": 6.008442142046988e-08
        }
      }
    ],
    "head_analysis": [
      {
        "head_idx": 0,
        "avg_error": 1.9116919247608166e-06,
        "avg_entropy": 3.878162145614624,
        "avg_max_weight": 0.04285780340433121,
        "sparsity": 0.69482421875
      },
      {
        "head_idx": 1,
        "avg_error": 1.8986497707373928e-06,
        "avg_entropy": 3.8781611919403076,
        "avg_max_weight": 0.042867984622716904,
        "sparsity": 0.6947021484375
      },
      {
        "head_idx": 2,
        "avg_error": 1.6911043303480255e-06,
        "avg_entropy": 3.8781609535217285,
        "avg_max_weight": 0.04290873184800148,
        "sparsity": 0.69482421875
      },
      {
        "head_idx": 3,
        "avg_error": 2.019006615228136e-06,
        "avg_entropy": 3.878161668777466,
        "avg_max_weight": 0.042880360037088394,
        "sparsity": 0.69488525390625
      },
      {
        "head_idx": 4,
        "avg_error": 1.7240921579286805e-06,
        "avg_entropy": 3.8781611919403076,
        "avg_max_weight": 0.04289139807224274,
        "sparsity": 0.6949462890625
      },
      {
        "head_idx": 5,
        "avg_error": 1.8510939980842522e-06,
        "avg_entropy": 3.878162145614624,
        "avg_max_weight": 0.04284670576453209,
        "sparsity": 0.69488525390625
      },
      {
        "head_idx": 6,
        "avg_error": 1.7251389863304212e-06,
        "avg_entropy": 3.878162384033203,
        "avg_max_weight": 0.04283313825726509,
        "sparsity": 0.69464111328125
      },
      {
        "head_idx": 7,
        "avg_error": 1.7830810747909709e-06,
        "avg_entropy": 3.878162145614624,
        "avg_max_weight": 0.042841847985982895,
        "sparsity": 0.6949462890625
      }
    ]
  }
}
{
  "detector": {
    "detected_exceeded": false,
    "actual_err": 5.9217214584350586e-05,
    "predicted_bound": 0.000150057629798539,
    "elapsed_sec": 2.917241334915161
  },
  "analyzer_report": {
    "component_estimates": {
      "input_storage_error": 5.9217214584350586e-05,
      "matmul1_accumulation_error": 5.9217214584350586e-05,
      "scaling_error": 5.9217214584350586e-05,
      "softmax_numerical_error": 5.9217214584350586e-05,
      "matmul2_accumulation_error": 5.9217214584350586e-05,
      "output_demote_error": 9.284913539886475e-05
    },
    "component_ratios": {
      "input_storage_error": 0.15225470288494694,
      "matmul1_accumulation_error": 0.15225470288494694,
      "scaling_error": 0.15225470288494694,
      "softmax_numerical_error": 0.15225470288494694,
      "matmul2_accumulation_error": 0.15225470288494694,
      "output_demote_error": 0.23872648557526532
    },
    "primary_source": "storage_error",
    "suggestion": "\u4e3b\u8981\u8bef\u5dee\u6765\u6e90\u4e3a\u8f93\u5165\u5b58\u50a8\u7cbe\u5ea6\u3002\u5efa\u8bae\uff1a\u63d0\u5347Q/K/V\u7684\u5b58\u50a8\u7cbe\u5ea6\uff1b\u8fdb\u884c\u8f93\u5165\u5f52\u4e00\u5316\uff1b\u68c0\u67e5embedding\u5c42\u7684\u8f93\u51fa\u8303\u56f4\u3002 \u68c0\u6d4b\u5230\u5927\u91cf\u5c16\u9510\u7684attention\u6a21\u5f0f\uff08\u4f4e\u71b5\uff09\uff0c\u8fd9\u4f1a\u653e\u5927softmax\u7684\u6570\u503c\u8bef\u5dee\u3002\u8003\u8651\u4f7f\u7528attention dropout\u6216\u6e29\u5ea6\u7f29\u653e\u3002",
    "attention_pattern_stats": {
      "global_avg_entropy": 3.878161668777466,
      "global_sparsity": 0.6950302124023438,
      "max_attention_weight": 1.0,
      "min_attention_weight": 0.0
    },
    "attention_behavior_stats": {
      "high_entropy_tokens": 0,
      "low_entropy_tokens": 7,
      "total_analyzed": 8
    },
    "top_tokens_summary": [
      {
        "batch_idx": 0,
        "head_idx": 3,
        "token_idx": 1,
        "token_error": 9.424888048670255e-06,
        "entropy_ref": 0.6931318044662476,
        "max_attention_weight_ref": 0.5027742981910706,
        "attention_weight_error": 7.450580596923828e-07,
        "stage_errors": {
          "storage_error": 1.9631369923445163e-05,
          "matmul1_error": 8.971285158909991e-10,
          "softmax_error": 5.650676030199975e-07,
          "matmul2_error": 6.964214207982878e-07,
          "demote_error": 5.650676030199975e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 0,
        "token_idx": 1,
        "token_error": 8.827759302221239e-06,
        "entropy_ref": 0.693085789680481,
        "max_attention_weight_ref": 0.5055391192436218,
        "attention_weight_error": 2.384185791015625e-07,
        "stage_errors": {
          "storage_error": 2.303895189470495e-05,
          "matmul1_error": 1.4652120520795467e-09,
          "softmax_error": 8.862341928761453e-07,
          "matmul2_error": 6.869981916679535e-07,
          "demote_error": 8.862341928761452e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 1,
        "token_idx": 1,
        "token_error": 8.72084274305962e-06,
        "entropy_ref": 0.6931053400039673,
        "max_attention_weight_ref": 0.50457364320755,
        "attention_weight_error": 7.748603820800781e-07,
        "stage_errors": {
          "storage_error": 2.0581052467605332e-05,
          "matmul1_error": 1.0646490933652258e-09,
          "softmax_error": 6.63366517983377e-07,
          "matmul2_error": 6.854583261883818e-07,
          "demote_error": 6.63366517983377e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 6,
        "token_idx": 1,
        "token_error": 8.513525244779885e-06,
        "entropy_ref": 0.693135142326355,
        "max_attention_weight_ref": 0.5024506449699402,
        "attention_weight_error": 3.8743019104003906e-07,
        "stage_errors": {
          "storage_error": 1.9456389964034315e-05,
          "matmul1_error": 8.1316583613266e-10,
          "softmax_error": 5.006520950701088e-07,
          "matmul2_error": 7.271792128449306e-07,
          "demote_error": 5.0065209507010876e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 6,
        "token_idx": 0,
        "token_error": 8.198363502742723e-06,
        "entropy_ref": -0.0,
        "max_attention_weight_ref": 1.0,
        "attention_weight_error": 0.0,
        "stage_errors": {
          "storage_error": 2.3484240045945626e-05,
          "matmul1_error": 1.4673746393966824e-09,
          "softmax_error": 9.034371032612399e-07,
          "matmul2_error": 7.271792128449306e-07,
          "demote_error": 9.034371032612399e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 5,
        "token_idx": 2,
        "token_error": 7.977465429576114e-06,
        "entropy_ref": 1.0985965728759766,
        "max_attention_weight_ref": 0.33598098158836365,
        "attention_weight_error": 5.960464477539062e-07,
        "stage_errors": {
          "storage_error": 1.944509631357505e-05,
          "matmul1_error": 8.222598715623795e-10,
          "softmax_error": 5.321235221344978e-07,
          "matmul2_error": 7.294789611478337e-07,
          "demote_error": 5.3212352213449775e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 7,
        "token_idx": 0,
        "token_error": 7.715574611211196e-06,
        "entropy_ref": -0.0,
        "max_attention_weight_ref": 1.0,
        "attention_weight_error": 0.0,
        "stage_errors": {
          "storage_error": 2.0182235857646447e-05,
          "matmul1_error": 9.947094190411395e-10,
          "softmax_error": 6.236499757505954e-07,
          "matmul2_error": 6.896852482896066e-07,
          "demote_error": 6.236499757505954e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 0,
        "token_idx": 0,
        "token_error": 7.6086689659859985e-06,
        "entropy_ref": -0.0,
        "max_attention_weight_ref": 1.0,
        "attention_weight_error": 0.0,
        "stage_errors": {
          "storage_error": 2.1146286144357873e-05,
          "matmul1_error": 1.1522973969851819e-09,
          "softmax_error": 6.969676178414375e-07,
          "matmul2_error": 6.869981916679535e-07,
          "demote_error": 6.969676178414375e-08
        }
      }
    ],
    "head_analysis": [
      {
        "head_idx": 0,
        "avg_error": 1.978627096832497e-06,
        "avg_entropy": 3.8781611919403076,
        "avg_max_weight": 0.04289228841662407,
        "sparsity": 0.695068359375
      },
      {
        "head_idx": 1,
        "avg_error": 1.7950737856153864e-06,
        "avg_entropy": 3.878162145614624,
        "avg_max_weight": 0.042846787720918655,
        "sparsity": 0.69488525390625
      },
      {
        "head_idx": 2,
        "avg_error": 1.8426158021611627e-06,
        "avg_entropy": 3.878162145614624,
        "avg_max_weight": 0.04284973442554474,
        "sparsity": 0.69476318359375
      },
      {
        "head_idx": 3,
        "avg_error": 1.8755081327981316e-06,
        "avg_entropy": 3.878162145614624,
        "avg_max_weight": 0.042850617319345474,
        "sparsity": 0.69512939453125
      },
      {
        "head_idx": 4,
        "avg_error": 1.971669462363934e-06,
        "avg_entropy": 3.878161668777466,
        "avg_max_weight": 0.04286215454339981,
        "sparsity": 0.695068359375
      },
      {
        "head_idx": 5,
        "avg_error": 1.8031944364338415e-06,
        "avg_entropy": 3.878161907196045,
        "avg_max_weight": 0.04284784197807312,
        "sparsity": 0.69500732421875
      },
      {
        "head_idx": 6,
        "avg_error": 1.9098677057627356e-06,
        "avg_entropy": 3.878161668777466,
        "avg_max_weight": 0.04286615923047066,
        "sparsity": 0.69488525390625
      },
      {
        "head_idx": 7,
        "avg_error": 1.7906469338413444e-06,
        "avg_entropy": 3.8781611919403076,
        "avg_max_weight": 0.042886603623628616,
        "sparsity": 0.6954345703125
      }
    ]
  }
}
{
  "detector": {
    "detected_exceeded": false,
    "actual_err": 3.904849290847778e-05,
    "predicted_bound": 9.643082885304467e-05,
    "elapsed_sec": 2.891765594482422
  },
  "analyzer_report": {
    "component_estimates": {
      "input_storage_error": 3.663450479507446e-05,
      "matmul1_accumulation_error": 3.663450479507446e-05,
      "scaling_error": 3.663450479507446e-05,
      "softmax_numerical_error": 3.663450479507446e-05,
      "matmul2_accumulation_error": 3.663450479507446e-05,
      "output_demote_error": 6.893277168273926e-05
    },
    "component_ratios": {
      "input_storage_error": 0.14531430091320152,
      "matmul1_accumulation_error": 0.14531430091320152,
      "scaling_error": 0.14531430091320152,
      "softmax_numerical_error": 0.14531430091320152,
      "matmul2_accumulation_error": 0.14531430091320152,
      "output_demote_error": 0.2734284954339924
    },
    "primary_source": "storage_error",
    "suggestion": "\u4e3b\u8981\u8bef\u5dee\u6765\u6e90\u4e3a\u8f93\u5165\u5b58\u50a8\u7cbe\u5ea6\u3002\u5efa\u8bae\uff1a\u63d0\u5347Q/K/V\u7684\u5b58\u50a8\u7cbe\u5ea6\uff1b\u8fdb\u884c\u8f93\u5165\u5f52\u4e00\u5316\uff1b\u68c0\u67e5embedding\u5c42\u7684\u8f93\u51fa\u8303\u56f4\u3002 \u68c0\u6d4b\u5230\u5927\u91cf\u5c16\u9510\u7684attention\u6a21\u5f0f\uff08\u4f4e\u71b5\uff09\uff0c\u8fd9\u4f1a\u653e\u5927softmax\u7684\u6570\u503c\u8bef\u5dee\u3002\u8003\u8651\u4f7f\u7528attention dropout\u6216\u6e29\u5ea6\u7f29\u653e\u3002",
    "attention_pattern_stats": {
      "global_avg_entropy": 3.878162145614624,
      "global_sparsity": 0.694915771484375,
      "max_attention_weight": 1.0,
      "min_attention_weight": 0.0
    },
    "attention_behavior_stats": {
      "high_entropy_tokens": 0,
      "low_entropy_tokens": 7,
      "total_analyzed": 8
    },
    "top_tokens_summary": [
      {
        "batch_idx": 0,
        "head_idx": 4,
        "token_idx": 1,
        "token_error": 1.0072219083667733e-05,
        "entropy_ref": 0.6931077837944031,
        "max_attention_weight_ref": 0.5044384002685547,
        "attention_weight_error": 1.341104507446289e-06,
        "stage_errors": {
          "storage_error": 2.2144167360238498e-05,
          "matmul1_error": 1.2928645062891897e-09,
          "softmax_error": 8.306698873639107e-07,
          "matmul2_error": 6.959034635656281e-07,
          "demote_error": 8.306698873639106e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 0,
        "token_idx": 1,
        "token_error": 9.527296242595185e-06,
        "entropy_ref": 0.6931333541870117,
        "max_attention_weight_ref": 0.5026305913925171,
        "attention_weight_error": 8.344650268554688e-07,
        "stage_errors": {
          "storage_error": 2.187809559472953e-05,
          "matmul1_error": 1.2683918598635605e-09,
          "softmax_error": 7.864611689001322e-07,
          "matmul2_error": 6.885918992338703e-07,
          "demote_error": 7.864611689001322e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 2,
        "token_idx": 1,
        "token_error": 8.719368452148046e-06,
        "entropy_ref": 0.6931019425392151,
        "max_attention_weight_ref": 0.5047557950019836,
        "attention_weight_error": 5.960464477539062e-07,
        "stage_errors": {
          "storage_error": 2.0883036086161155e-05,
          "matmul1_error": 1.063345722038054e-09,
          "softmax_error": 6.586349627468735e-07,
          "matmul2_error": 7.161674147937447e-07,
          "demote_error": 6.586349627468736e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 2,
        "token_idx": 0,
        "token_error": 8.372684533242136e-06,
        "entropy_ref": -0.0,
        "max_attention_weight_ref": 1.0,
        "attention_weight_error": 0.0,
        "stage_errors": {
          "storage_error": 1.784634241630556e-05,
          "matmul1_error": 5.730809463094725e-10,
          "softmax_error": 3.549655957613141e-07,
          "matmul2_error": 7.161674147937447e-07,
          "demote_error": 3.54965595761314e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 4,
        "token_idx": 0,
        "token_error": 8.366769179701805e-06,
        "entropy_ref": -0.0,
        "max_attention_weight_ref": 1.0,
        "attention_weight_error": 0.0,
        "stage_errors": {
          "storage_error": 2.0575085272867e-05,
          "matmul1_error": 1.0486507013739233e-09,
          "softmax_error": 6.737616786267609e-07,
          "matmul2_error": 6.959034635656281e-07,
          "demote_error": 6.737616786267609e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 4,
        "token_idx": 2,
        "token_error": 7.386400284303818e-06,
        "entropy_ref": 1.0985714197158813,
        "max_attention_weight_ref": 0.3375999927520752,
        "attention_weight_error": 1.2218952178955078e-06,
        "stage_errors": {
          "storage_error": 2.139960406566388e-05,
          "matmul1_error": 1.1769797883182408e-09,
          "softmax_error": 7.562135579064489e-07,
          "matmul2_error": 6.959034635656281e-07,
          "demote_error": 7.562135579064488e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 6,
        "token_idx": 1,
        "token_error": 7.273574738064781e-06,
        "entropy_ref": 0.6930983066558838,
        "max_attention_weight_ref": 0.5049399733543396,
        "attention_weight_error": 1.7881393432617188e-07,
        "stage_errors": {
          "storage_error": 1.9399149095988832e-05,
          "matmul1_error": 8.484074507956913e-10,
          "softmax_error": 5.177662387723103e-07,
          "matmul2_error": 6.979866157053039e-07,
          "demote_error": 5.177662387723103e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 6,
        "token_idx": 0,
        "token_error": 7.252227078424767e-06,
        "entropy_ref": -0.0,
        "max_attention_weight_ref": 1.0,
        "attention_weight_error": 0.0,
        "stage_errors": {
          "storage_error": 2.2835929485154338e-05,
          "matmul1_error": 1.4115554258027602e-09,
          "softmax_error": 8.614442776888609e-07,
          "matmul2_error": 6.979866157053039e-07,
          "demote_error": 8.614442776888609e-08
        }
      }
    ],
    "head_analysis": [
      {
        "head_idx": 0,
        "avg_error": 1.9021202888325206e-06,
        "avg_entropy": 3.878161907196045,
        "avg_max_weight": 0.042859483510255814,
        "sparsity": 0.695068359375
      },
      {
        "head_idx": 1,
        "avg_error": 1.7241477507923264e-06,
        "avg_entropy": 3.878161907196045,
        "avg_max_weight": 0.042857274413108826,
        "sparsity": 0.69482421875
      },
      {
        "head_idx": 2,
        "avg_error": 1.824012656470586e-06,
        "avg_entropy": 3.878161907196045,
        "avg_max_weight": 0.04286714643239975,
        "sparsity": 0.6947021484375
      },
      {
        "head_idx": 3,
        "avg_error": 1.8731776663116761e-06,
        "avg_entropy": 3.8781614303588867,
        "avg_max_weight": 0.042866673320531845,
        "sparsity": 0.695068359375
      },
      {
        "head_idx": 4,
        "avg_error": 1.7766471955837915e-06,
        "avg_entropy": 3.878162145614624,
        "avg_max_weight": 0.04286216199398041,
        "sparsity": 0.69500732421875
      },
      {
        "head_idx": 5,
        "avg_error": 1.7629205331104458e-06,
        "avg_entropy": 3.878162145614624,
        "avg_max_weight": 0.042863208800554276,
        "sparsity": 0.6949462890625
      },
      {
        "head_idx": 6,
        "avg_error": 1.7709315898173372e-06,
        "avg_entropy": 3.878161907196045,
        "avg_max_weight": 0.04286441206932068,
        "sparsity": 0.69488525390625
      },
      {
        "head_idx": 7,
        "avg_error": 1.7888862657855498e-06,
        "avg_entropy": 3.878162145614624,
        "avg_max_weight": 0.042856015264987946,
        "sparsity": 0.69482421875
      }
    ]
  }
}
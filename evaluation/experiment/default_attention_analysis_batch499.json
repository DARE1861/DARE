{
  "detector": {
    "detected_exceeded": false,
    "actual_err": 5.6236982345581055e-05,
    "predicted_bound": 0.0001366430980851874,
    "elapsed_sec": 3.015498161315918
  },
  "analyzer_report": {
    "component_estimates": {
      "input_storage_error": 5.6236982345581055e-05,
      "matmul1_accumulation_error": 5.6236982345581055e-05,
      "scaling_error": 5.6236982345581055e-05,
      "softmax_numerical_error": 5.6236982345581055e-05,
      "matmul2_accumulation_error": 5.6236982345581055e-05,
      "output_demote_error": 8.2358717918396e-05
    },
    "component_ratios": {
      "input_storage_error": 0.15469115055129729,
      "matmul1_accumulation_error": 0.15469115055129729,
      "scaling_error": 0.15469115055129729,
      "softmax_numerical_error": 0.15469115055129729,
      "matmul2_accumulation_error": 0.15469115055129729,
      "output_demote_error": 0.22654424724351355
    },
    "primary_source": "storage_error",
    "suggestion": "\u4e3b\u8981\u8bef\u5dee\u6765\u6e90\u4e3a\u8f93\u5165\u5b58\u50a8\u7cbe\u5ea6\u3002\u5efa\u8bae\uff1a\u63d0\u5347Q/K/V\u7684\u5b58\u50a8\u7cbe\u5ea6\uff1b\u8fdb\u884c\u8f93\u5165\u5f52\u4e00\u5316\uff1b\u68c0\u67e5embedding\u5c42\u7684\u8f93\u51fa\u8303\u56f4\u3002 \u68c0\u6d4b\u5230\u5927\u91cf\u5c16\u9510\u7684attention\u6a21\u5f0f\uff08\u4f4e\u71b5\uff09\uff0c\u8fd9\u4f1a\u653e\u5927softmax\u7684\u6570\u503c\u8bef\u5dee\u3002\u8003\u8651\u4f7f\u7528attention dropout\u6216\u6e29\u5ea6\u7f29\u653e\u3002",
    "attention_pattern_stats": {
      "global_avg_entropy": 3.878161668777466,
      "global_sparsity": 0.6948928833007812,
      "max_attention_weight": 1.0,
      "min_attention_weight": 0.0
    },
    "attention_behavior_stats": {
      "high_entropy_tokens": 0,
      "low_entropy_tokens": 8,
      "total_analyzed": 8
    },
    "top_tokens_summary": [
      {
        "batch_idx": 0,
        "head_idx": 7,
        "token_idx": 0,
        "token_error": 9.47599528444698e-06,
        "entropy_ref": -0.0,
        "max_attention_weight_ref": 1.0,
        "attention_weight_error": 0.0,
        "stage_errors": {
          "storage_error": 2.124024422300863e-05,
          "matmul1_error": 1.149344087287435e-09,
          "softmax_error": 7.111866580089554e-07,
          "matmul2_error": 6.986186235735659e-07,
          "demote_error": 7.111866580089554e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 5,
        "token_idx": 1,
        "token_error": 9.036793926497921e-06,
        "entropy_ref": 0.6931177377700806,
        "max_attention_weight_ref": 0.5038414597511292,
        "attention_weight_error": 1.430511474609375e-06,
        "stage_errors": {
          "storage_error": 2.154470894311089e-05,
          "matmul1_error": 1.2074956113052024e-09,
          "softmax_error": 7.529946742579341e-07,
          "matmul2_error": 6.927823505975539e-07,
          "demote_error": 7.529946742579341e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 1,
        "token_idx": 0,
        "token_error": 8.753282600082457e-06,
        "entropy_ref": -0.0,
        "max_attention_weight_ref": 1.0,
        "attention_weight_error": 0.0,
        "stage_errors": {
          "storage_error": 2.1392369035311276e-05,
          "matmul1_error": 1.1206532206221074e-09,
          "softmax_error": 7.085202014422976e-07,
          "matmul2_error": 7.317056770261843e-07,
          "demote_error": 7.085202014422975e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 2,
        "token_idx": 1,
        "token_error": 8.229933882830665e-06,
        "entropy_ref": 0.6931280493736267,
        "max_attention_weight_ref": 0.5030951499938965,
        "attention_weight_error": 6.854534149169922e-07,
        "stage_errors": {
          "storage_error": 2.1130108962097438e-05,
          "matmul1_error": 1.1314157286511087e-09,
          "softmax_error": 7.138431101338938e-07,
          "matmul2_error": 6.987059805396712e-07,
          "demote_error": 7.138431101338938e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 6,
        "token_idx": 1,
        "token_error": 8.131236427288968e-06,
        "entropy_ref": 0.6931166648864746,
        "max_attention_weight_ref": 0.5039064288139343,
        "attention_weight_error": 8.046627044677734e-07,
        "stage_errors": {
          "storage_error": 1.9011287349712802e-05,
          "matmul1_error": 8.23541415253815e-10,
          "softmax_error": 5.185720510780811e-07,
          "matmul2_error": 6.807114459661534e-07,
          "demote_error": 5.185720510780811e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 4,
        "token_idx": 1,
        "token_error": 8.02808062871918e-06,
        "entropy_ref": 0.6931141018867493,
        "max_attention_weight_ref": 0.5040651559829712,
        "attention_weight_error": 8.940696716308594e-08,
        "stage_errors": {
          "storage_error": 2.2930432351131458e-05,
          "matmul1_error": 1.395775832165088e-09,
          "softmax_error": 8.774492016527803e-07,
          "matmul2_error": 7.125885531422682e-07,
          "demote_error": 8.774492016527802e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 3,
        "token_idx": 1,
        "token_error": 7.619549705850659e-06,
        "entropy_ref": 0.6931205987930298,
        "max_attention_weight_ref": 0.5036485195159912,
        "attention_weight_error": 2.980232238769531e-07,
        "stage_errors": {
          "storage_error": 1.9353755760675995e-05,
          "matmul1_error": 8.690345917082062e-10,
          "softmax_error": 5.410274752648547e-07,
          "matmul2_error": 6.844716608611634e-07,
          "demote_error": 5.410274752648547e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 3,
        "token_idx": 0,
        "token_error": 7.351634849328548e-06,
        "entropy_ref": -0.0,
        "max_attention_weight_ref": 1.0,
        "attention_weight_error": 0.0,
        "stage_errors": {
          "storage_error": 1.9793532828771276e-05,
          "matmul1_error": 9.396745318753339e-10,
          "softmax_error": 5.850051820743829e-07,
          "matmul2_error": 6.844716608611634e-07,
          "demote_error": 5.850051820743829e-08
        }
      }
    ],
    "head_analysis": [
      {
        "head_idx": 0,
        "avg_error": 1.729706809783238e-06,
        "avg_entropy": 3.878161668777466,
        "avg_max_weight": 0.04287015646696091,
        "sparsity": 0.69482421875
      },
      {
        "head_idx": 1,
        "avg_error": 1.8432101569487713e-06,
        "avg_entropy": 3.878161668777466,
        "avg_max_weight": 0.04288054257631302,
        "sparsity": 0.69500732421875
      },
      {
        "head_idx": 2,
        "avg_error": 1.8609716789796948e-06,
        "avg_entropy": 3.878162384033203,
        "avg_max_weight": 0.0428415983915329,
        "sparsity": 0.69464111328125
      },
      {
        "head_idx": 3,
        "avg_error": 1.6662582993376418e-06,
        "avg_entropy": 3.8781614303588867,
        "avg_max_weight": 0.04287159442901611,
        "sparsity": 0.6949462890625
      },
      {
        "head_idx": 4,
        "avg_error": 1.8315527086087968e-06,
        "avg_entropy": 3.878161668777466,
        "avg_max_weight": 0.04286570101976395,
        "sparsity": 0.695068359375
      },
      {
        "head_idx": 5,
        "avg_error": 1.6692920326022431e-06,
        "avg_entropy": 3.878161668777466,
        "avg_max_weight": 0.042859382927417755,
        "sparsity": 0.695068359375
      },
      {
        "head_idx": 6,
        "avg_error": 1.6783540104370331e-06,
        "avg_entropy": 3.878161668777466,
        "avg_max_weight": 0.04286622256040573,
        "sparsity": 0.6949462890625
      },
      {
        "head_idx": 7,
        "avg_error": 1.836158730839088e-06,
        "avg_entropy": 3.8781614303588867,
        "avg_max_weight": 0.04288336634635925,
        "sparsity": 0.69464111328125
      }
    ]
  }
}
{
  "detector": {
    "detected_exceeded": false,
    "actual_err": 4.424154758453369e-05,
    "predicted_bound": 0.00011428769284975715,
    "elapsed_sec": 3.1104838848114014
  },
  "analyzer_report": {
    "component_estimates": {
      "input_storage_error": 4.400312900543213e-05,
      "matmul1_accumulation_error": 4.400312900543213e-05,
      "scaling_error": 4.400312900543213e-05,
      "softmax_numerical_error": 4.400312900543213e-05,
      "matmul2_accumulation_error": 4.400312900543213e-05,
      "output_demote_error": 6.845593452453613e-05
    },
    "component_ratios": {
      "input_storage_error": 0.15253887080944264,
      "matmul1_accumulation_error": 0.15253887080944264,
      "scaling_error": 0.15253887080944264,
      "softmax_numerical_error": 0.15253887080944264,
      "matmul2_accumulation_error": 0.15253887080944264,
      "output_demote_error": 0.23730564595278683
    },
    "primary_source": "storage_error",
    "suggestion": "\u4e3b\u8981\u8bef\u5dee\u6765\u6e90\u4e3a\u8f93\u5165\u5b58\u50a8\u7cbe\u5ea6\u3002\u5efa\u8bae\uff1a\u63d0\u5347Q/K/V\u7684\u5b58\u50a8\u7cbe\u5ea6\uff1b\u8fdb\u884c\u8f93\u5165\u5f52\u4e00\u5316\uff1b\u68c0\u67e5embedding\u5c42\u7684\u8f93\u51fa\u8303\u56f4\u3002 \u68c0\u6d4b\u5230\u5927\u91cf\u5c16\u9510\u7684attention\u6a21\u5f0f\uff08\u4f4e\u71b5\uff09\uff0c\u8fd9\u4f1a\u653e\u5927softmax\u7684\u6570\u503c\u8bef\u5dee\u3002\u8003\u8651\u4f7f\u7528attention dropout\u6216\u6e29\u5ea6\u7f29\u653e\u3002",
    "attention_pattern_stats": {
      "global_avg_entropy": 3.878161668777466,
      "global_sparsity": 0.6949081420898438,
      "max_attention_weight": 1.0,
      "min_attention_weight": 0.0
    },
    "attention_behavior_stats": {
      "high_entropy_tokens": 0,
      "low_entropy_tokens": 6,
      "total_analyzed": 8
    },
    "top_tokens_summary": [
      {
        "batch_idx": 0,
        "head_idx": 2,
        "token_idx": 1,
        "token_error": 1.0600041605357546e-05,
        "entropy_ref": 0.6931430101394653,
        "max_attention_weight_ref": 0.5014439225196838,
        "attention_weight_error": 1.3113021850585938e-06,
        "stage_errors": {
          "storage_error": 2.1301898868841818e-05,
          "matmul1_error": 1.15780248389922e-09,
          "softmax_error": 7.283830200321973e-07,
          "matmul2_error": 6.993176157266135e-07,
          "demote_error": 7.283830200321972e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 6,
        "token_idx": 1,
        "token_error": 7.94628431322053e-06,
        "entropy_ref": 0.693122386932373,
        "max_attention_weight_ref": 0.5035223960876465,
        "attention_weight_error": 6.556510925292969e-07,
        "stage_errors": {
          "storage_error": 2.1389567791629815e-05,
          "matmul1_error": 1.1310998340383926e-09,
          "softmax_error": 7.281021680682898e-07,
          "matmul2_error": 7.243022992042825e-07,
          "demote_error": 7.281021680682898e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 4,
        "token_idx": 1,
        "token_error": 7.914060915936716e-06,
        "entropy_ref": 0.693110466003418,
        "max_attention_weight_ref": 0.5042857527732849,
        "attention_weight_error": 1.430511474609375e-06,
        "stage_errors": {
          "storage_error": 2.2420696950575802e-05,
          "matmul1_error": 1.3086718963496168e-09,
          "softmax_error": 8.249946404248477e-07,
          "matmul2_error": 7.160320365073858e-07,
          "demote_error": 8.249946404248476e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 0,
        "token_idx": 1,
        "token_error": 7.837778866814915e-06,
        "entropy_ref": 0.6931099891662598,
        "max_attention_weight_ref": 0.5043109655380249,
        "attention_weight_error": 1.0728836059570312e-06,
        "stage_errors": {
          "storage_error": 2.02810651899199e-05,
          "matmul1_error": 1.0005930186921433e-09,
          "softmax_error": 6.282480171648785e-07,
          "matmul2_error": 6.959902748349123e-07,
          "demote_error": 6.282480171648786e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 2,
        "token_idx": 2,
        "token_error": 7.833732524886727e-06,
        "entropy_ref": 1.0986050367355347,
        "max_attention_weight_ref": 0.3351219594478607,
        "attention_weight_error": 6.854534149169922e-07,
        "stage_errors": {
          "storage_error": 2.0210286947985878e-05,
          "matmul1_error": 9.842851230242868e-10,
          "softmax_error": 6.192218279466034e-07,
          "matmul2_error": 6.993176157266135e-07,
          "demote_error": 6.192218279466033e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 7,
        "token_idx": 0,
        "token_error": 7.67524034017697e-06,
        "entropy_ref": -0.0,
        "max_attention_weight_ref": 1.0,
        "attention_weight_error": 0.0,
        "stage_errors": {
          "storage_error": 2.2700334284309065e-05,
          "matmul1_error": 1.391984921933043e-09,
          "softmax_error": 8.89849616214633e-07,
          "matmul2_error": 6.888577445351985e-07,
          "demote_error": 8.89849616214633e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 7,
        "token_idx": 1,
        "token_error": 7.5578136602416635e-06,
        "entropy_ref": 0.693135142326355,
        "max_attention_weight_ref": 0.5024548172950745,
        "attention_weight_error": 2.9802322387695312e-08,
        "stage_errors": {
          "storage_error": 2.025404091909877e-05,
          "matmul1_error": 1.0093131291998949e-09,
          "softmax_error": 6.452202796936036e-07,
          "matmul2_error": 6.888577445351985e-07,
          "demote_error": 6.452202796936035e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 5,
        "token_idx": 2,
        "token_error": 7.239925253088586e-06,
        "entropy_ref": 1.0985881090164185,
        "max_attention_weight_ref": 0.3364968001842499,
        "attention_weight_error": 9.834766387939453e-07,
        "stage_errors": {
          "storage_error": 2.033526288869325e-05,
          "matmul1_error": 1.024794099500565e-09,
          "softmax_error": 6.398266123142094e-07,
          "matmul2_error": 6.858527740405408e-07,
          "demote_error": 6.398266123142094e-08
        }
      }
    ],
    "head_analysis": [
      {
        "head_idx": 0,
        "avg_error": 1.6218444898186135e-06,
        "avg_entropy": 3.8781614303588867,
        "avg_max_weight": 0.04288705438375473,
        "sparsity": 0.695068359375
      },
      {
        "head_idx": 1,
        "avg_error": 1.6522509440619615e-06,
        "avg_entropy": 3.8781614303588867,
        "avg_max_weight": 0.04288633540272713,
        "sparsity": 0.69476318359375
      },
      {
        "head_idx": 2,
        "avg_error": 2.0112483980483375e-06,
        "avg_entropy": 3.8781626224517822,
        "avg_max_weight": 0.042830102145671844,
        "sparsity": 0.69476318359375
      },
      {
        "head_idx": 3,
        "avg_error": 1.7738163933245232e-06,
        "avg_entropy": 3.8781614303588867,
        "avg_max_weight": 0.042881522327661514,
        "sparsity": 0.69525146484375
      },
      {
        "head_idx": 4,
        "avg_error": 1.8882899439631728e-06,
        "avg_entropy": 3.8781609535217285,
        "avg_max_weight": 0.04289490357041359,
        "sparsity": 0.695068359375
      },
      {
        "head_idx": 5,
        "avg_error": 1.8264465779793682e-06,
        "avg_entropy": 3.878161907196045,
        "avg_max_weight": 0.04286652058362961,
        "sparsity": 0.69464111328125
      },
      {
        "head_idx": 6,
        "avg_error": 1.9255983261246e-06,
        "avg_entropy": 3.878162384033203,
        "avg_max_weight": 0.042841602116823196,
        "sparsity": 0.69451904296875
      },
      {
        "head_idx": 7,
        "avg_error": 1.6153774140548194e-06,
        "avg_entropy": 3.878162384033203,
        "avg_max_weight": 0.04283450171351433,
        "sparsity": 0.6951904296875
      }
    ]
  }
}
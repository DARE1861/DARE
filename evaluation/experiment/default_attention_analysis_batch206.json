{
  "detector": {
    "detected_exceeded": false,
    "actual_err": 5.799531936645508e-05,
    "predicted_bound": 0.00013180480600567536,
    "elapsed_sec": 3.049834728240967
  },
  "analyzer_report": {
    "component_estimates": {
      "input_storage_error": 5.799531936645508e-05,
      "matmul1_accumulation_error": 5.799531936645508e-05,
      "scaling_error": 5.799531936645508e-05,
      "softmax_numerical_error": 5.799531936645508e-05,
      "matmul2_accumulation_error": 5.799531936645508e-05,
      "output_demote_error": 7.502734661102295e-05
    },
    "component_ratios": {
      "input_storage_error": 0.15888956929985712,
      "matmul1_accumulation_error": 0.15888956929985712,
      "scaling_error": 0.15888956929985712,
      "softmax_numerical_error": 0.15888956929985712,
      "matmul2_accumulation_error": 0.15888956929985712,
      "output_demote_error": 0.20555215350071443
    },
    "primary_source": "storage_error",
    "suggestion": "\u4e3b\u8981\u8bef\u5dee\u6765\u6e90\u4e3a\u8f93\u5165\u5b58\u50a8\u7cbe\u5ea6\u3002\u5efa\u8bae\uff1a\u63d0\u5347Q/K/V\u7684\u5b58\u50a8\u7cbe\u5ea6\uff1b\u8fdb\u884c\u8f93\u5165\u5f52\u4e00\u5316\uff1b\u68c0\u67e5embedding\u5c42\u7684\u8f93\u51fa\u8303\u56f4\u3002 \u68c0\u6d4b\u5230\u5927\u91cf\u5c16\u9510\u7684attention\u6a21\u5f0f\uff08\u4f4e\u71b5\uff09\uff0c\u8fd9\u4f1a\u653e\u5927softmax\u7684\u6570\u503c\u8bef\u5dee\u3002\u8003\u8651\u4f7f\u7528attention dropout\u6216\u6e29\u5ea6\u7f29\u653e\u3002",
    "attention_pattern_stats": {
      "global_avg_entropy": 3.878161907196045,
      "global_sparsity": 0.69488525390625,
      "max_attention_weight": 1.0,
      "min_attention_weight": 0.0
    },
    "attention_behavior_stats": {
      "high_entropy_tokens": 0,
      "low_entropy_tokens": 6,
      "total_analyzed": 8
    },
    "top_tokens_summary": [
      {
        "batch_idx": 0,
        "head_idx": 2,
        "token_idx": 1,
        "token_error": 1.0208121238974854e-05,
        "entropy_ref": 0.6931313872337341,
        "max_attention_weight_ref": 0.5028133392333984,
        "attention_weight_error": 8.940696716308594e-07,
        "stage_errors": {
          "storage_error": 2.0071781818842283e-05,
          "matmul1_error": 9.564900293009067e-10,
          "softmax_error": 5.973219231236726e-07,
          "matmul2_error": 7.021761120995507e-07,
          "demote_error": 5.973219231236727e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 0,
        "token_idx": 1,
        "token_error": 9.02851843420649e-06,
        "entropy_ref": 0.6931304931640625,
        "max_attention_weight_ref": 0.5028931498527527,
        "attention_weight_error": 8.642673492431641e-07,
        "stage_errors": {
          "storage_error": 2.1600395029963693e-05,
          "matmul1_error": 1.168576624612646e-09,
          "softmax_error": 7.340648153331131e-07,
          "matmul2_error": 7.22436288924655e-07,
          "demote_error": 7.34064815333113e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 0,
        "token_idx": 0,
        "token_error": 8.990231435745955e-06,
        "entropy_ref": -0.0,
        "max_attention_weight_ref": 1.0,
        "attention_weight_error": 0.0,
        "stage_errors": {
          "storage_error": 2.020002784774988e-05,
          "matmul1_error": 9.456485778206012e-10,
          "softmax_error": 5.940280971117318e-07,
          "matmul2_error": 7.22436288924655e-07,
          "demote_error": 5.940280971117318e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 2,
        "token_idx": 0,
        "token_error": 8.67795188241871e-06,
        "entropy_ref": -0.0,
        "max_attention_weight_ref": 1.0,
        "attention_weight_error": 0.0,
        "stage_errors": {
          "storage_error": 2.0376018710521748e-05,
          "matmul1_error": 1.0052074029936614e-09,
          "softmax_error": 6.277456122916193e-07,
          "matmul2_error": 7.021761120995507e-07,
          "demote_error": 6.277456122916192e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 0,
        "token_idx": 2,
        "token_error": 7.998045475687832e-06,
        "entropy_ref": 1.0985710620880127,
        "max_attention_weight_ref": 0.33757153153419495,
        "attention_weight_error": 8.940696716308594e-07,
        "stage_errors": {
          "storage_error": 2.3048885395837715e-05,
          "matmul1_error": 1.3991655245545238e-09,
          "softmax_error": 8.789138519205153e-07,
          "matmul2_error": 7.22436288924655e-07,
          "demote_error": 8.789138519205154e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 2,
        "token_idx": 2,
        "token_error": 7.992715836735442e-06,
        "entropy_ref": 1.0985972881317139,
        "max_attention_weight_ref": 0.33589839935302734,
        "attention_weight_error": 5.364418029785156e-07,
        "stage_errors": {
          "storage_error": 2.1169134470255813e-05,
          "matmul1_error": 1.132208821642409e-09,
          "softmax_error": 7.070571882650257e-07,
          "matmul2_error": 7.021761120995507e-07,
          "demote_error": 7.070571882650256e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 3,
        "token_idx": 0,
        "token_error": 7.479047781089321e-06,
        "entropy_ref": -0.0,
        "max_attention_weight_ref": 1.0,
        "attention_weight_error": 0.0,
        "stage_errors": {
          "storage_error": 2.0703139853139874e-05,
          "matmul1_error": 1.0675384560605335e-09,
          "softmax_error": 6.890448275953532e-07,
          "matmul2_error": 6.965679858694785e-07,
          "demote_error": 6.890448275953531e-08
        }
      },
      {
        "batch_idx": 0,
        "head_idx": 4,
        "token_idx": 1,
        "token_error": 7.139388799259905e-06,
        "entropy_ref": 0.6931266784667969,
        "max_attention_weight_ref": 0.5032020807266235,
        "attention_weight_error": 2.086162567138672e-07,
        "stage_errors": {
          "storage_error": 2.1426298189908266e-05,
          "matmul1_error": 1.1392509978348164e-09,
          "softmax_error": 7.123700925149024e-07,
          "matmul2_error": 7.234886652440765e-07,
          "demote_error": 7.123700925149023e-08
        }
      }
    ],
    "head_analysis": [
      {
        "head_idx": 0,
        "avg_error": 1.825153731260798e-06,
        "avg_entropy": 3.878161907196045,
        "avg_max_weight": 0.04285328835248947,
        "sparsity": 0.69488525390625
      },
      {
        "head_idx": 1,
        "avg_error": 1.8129177306036581e-06,
        "avg_entropy": 3.8781611919403076,
        "avg_max_weight": 0.04289112612605095,
        "sparsity": 0.69476318359375
      },
      {
        "head_idx": 2,
        "avg_error": 1.8856354699892108e-06,
        "avg_entropy": 3.8781614303588867,
        "avg_max_weight": 0.0428716279566288,
        "sparsity": 0.69512939453125
      },
      {
        "head_idx": 3,
        "avg_error": 1.9069997279075324e-06,
        "avg_entropy": 3.878161907196045,
        "avg_max_weight": 0.04285375401377678,
        "sparsity": 0.69500732421875
      },
      {
        "head_idx": 4,
        "avg_error": 1.8603318494569976e-06,
        "avg_entropy": 3.878161668777466,
        "avg_max_weight": 0.04286758601665497,
        "sparsity": 0.695068359375
      },
      {
        "head_idx": 5,
        "avg_error": 1.841602056629199e-06,
        "avg_entropy": 3.878161668777466,
        "avg_max_weight": 0.04286587983369827,
        "sparsity": 0.69464111328125
      },
      {
        "head_idx": 6,
        "avg_error": 1.7843381101556588e-06,
        "avg_entropy": 3.8781611919403076,
        "avg_max_weight": 0.04287898913025856,
        "sparsity": 0.69488525390625
      },
      {
        "head_idx": 7,
        "avg_error": 1.835784701142984e-06,
        "avg_entropy": 3.878162145614624,
        "avg_max_weight": 0.0428541861474514,
        "sparsity": 0.6947021484375
      }
    ]
  }
}